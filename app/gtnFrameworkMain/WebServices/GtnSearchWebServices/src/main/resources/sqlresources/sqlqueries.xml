<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">

<properties>

    <entry key="privatePublic">
		<![CDATA[
			Select FVM.VIEW_NAME viewName, PM.PROJECTION_DESCRIPTION description, PM.PROJECTION_NAME projectionName, PM.BRAND_TYPE brandType, PM.MODIFIED_DATE modifiedDate, PM.CREATED_BY createdBy,
                        PM.CREATED_DATE createdDate, PM.PRODUCT_HIERARCHY_LEVEL productLevel, PM.CUSTOMER_HIERARCHY_LEVEL customerLevel, CUST_HD.HIERARCHY_NAME customerHierarchy, PROD_HD.HIERARCHY_NAME productHierarchy,
                        CM.COMPANY_NAME company, CMG.COMPANY_GROUP_NAME customerGroup, IG.ITEM_GROUP_NAME productGroup, PM.PROJECTION_MASTER_SID projectionId, FVM.VIEW_ID viewId, PM.CUSTOMER_HIERARCHY_SID customerHierarchySid,
                        PM.PRODUCT_HIERARCHY_SID productHierarchySid, PM.COMPANY_GROUP_SID companyGroupSid, PM.ITEM_GROUP_SID productGroupSid, PM.COMPANY_MASTER_SID companyMasterSid, PM.FROM_DATE fromDate, PM.TO_DATE toDate, 
                        PM.CUSTOMER_HIERARCHY_INNER_LEVEL customerInnerLevel,PM.PRODUCT_HIERARCHY_INNER_LEVEL productInnerLevel, PM.CUST_RELATIONSHIP_BUILDER_SID custRelationshipBuilderSid, PM.PROD_RELATIONSHIP_BUILDER_SID prodRelationshipBuilderSid,PM.BUSINESS_UNIT AS BUSINESSUNIT, CM1.COMPANY_NAME AS  BUSINESSUNITNAME,             
                        PM.CUSTOMER_HIER_VERSION_NO custHierarchyVersion, PM.PRODUCT_HIER_VERSION_NO prodHierarchyVersion,PM.CUSTOM_VIEW_MASTER_SID CUSTOM_VIEW_MASTER_SID,PM.CUSTOM_VIEW_MASTER_DEDUCTION_SID CUSTOM_VIEW_MASTER_DEDUCTION_SID  
from PROJECTION_MASTER PM 
                        
                        LEFT JOIN FORECASTING_VIEW_MASTER FVM 
                        on FVM.projection_Id  = PM.projection_Master_Sid 

                        LEFT JOIN HIERARCHY_DEFINITION CUST_HD 
                        on CUST_HD.HIERARCHY_DEFINITION_SID =PM.CUSTOMER_HIERARCHY_SID 

                        LEFT JOIN HIERARCHY_DEFINITION PROD_HD 
                        on PROD_HD.HIERARCHY_DEFINITION_SID = PM.PRODUCT_HIERARCHY_SID 

                        LEFT JOIN COMPANY_GROUP CMG 
                        on CMG.COMPANY_GROUP_SID  = PM.COMPANY_GROUP_SID

                        LEFT JOIN ITEM_GROUP IG 
                        on IG.ITEM_GROUP_SID  = PM.ITEM_GROUP_SID

                        LEFT JOIN COMPANY_MASTER CM 
                        on PM.COMPANY_MASTER_SID = CM.COMPANY_MASTER_SID 
                        
                        LEFT JOIN COMPANY_MASTER CM1
                        on PM.BUSINESS_UNIT = CM1.COMPANY_MASTER_SID 

                        WHERE  FVM.view_Type=? AND  FVM.view_Name LIKE ?
                        AND PM.forecasting_Type =?
		]]>
    </entry>
    <entry key="businessUnits">
       
    		<![CDATA[
                    SELECT
                            CM.COMPANY_MASTER_SID,
                            CM.COMPANY_ID,
                            CM.COMPANY_NO,
                            CM.COMPANY_NAME
                    FROM
                            COMPANY_MASTER CM
                    JOIN HELPER_TABLE HT ON
                            HT.HELPER_TABLE_SID = CM.COMPANY_TYPE
                    WHERE
                            HT.LIST_NAME LIKE 'COMPANY_TYPE'
                            AND HT.DESCRIPTION LIKE 'BUSINESS UNIT'
                            AND CM.INBOUND_STATUS <> 'D'
                    ORDER BY COMPANY_NO;
		]]>
      
    </entry>
    <entry key="companies">
      
            <![CDATA[
                SELECT
                        CM.COMPANY_MASTER_SID,
                        CM.COMPANY_ID,
                        CM.COMPANY_NO,
                        CM.COMPANY_NAME
                FROM
                        COMPANY_MASTER CM
                JOIN HELPER_TABLE HT ON
                        HT.HELPER_TABLE_SID = CM.COMPANY_TYPE
                WHERE
                        HT.LIST_NAME LIKE 'COMPANY_TYPE'
                        AND HT.DESCRIPTION LIKE 'GLCOMP'
                        AND CM.INBOUND_STATUS <> 'D'
                ORDER BY COMPANY_NO;
            ]]>
    
    </entry>
    <entry key="dataSelectionDeduction">

            <![CDATA[            
                  SELECT
	distinct LEVEL_NO,
	LEVEL_NAME
        FROM
	HIERARCHY_DEFINITION HD
	JOIN dbo.HIERARCHY_LEVEL_DEFINITION HLD
        ON HLD.HIERARCHY_DEFINITION_SID = HD.HIERARCHY_DEFINITION_SID
        WHERE HD.HIERARCHY_NAME='DeductionHierarchy'
            ]]>

    </entry>
        <entry key="projectionSearch">

            <![CDATA[            
                     SELECT DISTINCT PM.PROJECTION_MASTER_SID projectionId, PM.PROJECTION_NAME projectionName, PM.PROJECTION_DESCRIPTION description , 
                    0 customerHierSid, 0 customerHierarchy, 0 customerHierarchyLevel, HDP.HIERARCHY_DEFINITION_SID prodHierSid, 
                    HDP.HIERARCHY_NAME productHierarchy, PM.PRODUCT_HIERARCHY_LEVEL productHierarchyLevel, PM.CREATED_BY createdBy, PM.CREATED_DATE createdDate, PM.MODIFIED_DATE modifiedBy, PM.COMPANY_MASTER_SID companySid, 
                    PM.COMPANY_GROUP_SID customerGrpSid,  CG.COMPANY_GROUP_NAME customerGroup, PM.ITEM_GROUP_SID prodGrpSid, IG.ITEM_GROUP_NAME productGroup, 0 customerHierarchyInnerLevel, 
                    PM.PRODUCT_HIERARCHY_INNER_LEVEL productHierarchyInnerLevel, 
                    0 custRelationshipBuilderSid, PM.PROD_RELATIONSHIP_BUILDER_SID prodRelationshipBuilderSid,PM.DISCOUNT_TYPE ,
                    CM.COMPANY_NAME company,PM.BUSINESS_UNIT AS BUSINESSUNIT, CM1.COMPANY_NAME AS  BUSINESSUNITNAME ,PROJECTION_CUST_VERSION,PROJECTION_PROD_VERSION,
	PM.CUSTOMER_HIER_VERSION_NO,
	PM.PRODUCT_HIER_VERSION_NO
                    
                    From PROJECTION_MASTER PM
                  
                    JOIN HIERARCHY_DEFINITION HDP
                    ON HDP.HIERARCHY_DEFINITION_SID = PM.PRODUCT_HIERARCHY_SID 

                    LEFT JOIN COMPANY_GROUP CG
                    ON CG.COMPANY_GROUP_SID  = PM.COMPANY_GROUP_SID 

                    LEFT JOIN ITEM_GROUP IG 
                    ON IG.ITEM_GROUP_SID = PM.ITEM_GROUP_SID 
                                        JOIN COMPANY_MASTER CM 
                    on PM.COMPANY_MASTER_SID = CM.COMPANY_MASTER_SID 
                        
                    JOIN COMPANY_MASTER CM1
                     on PM.BUSINESS_UNIT = CM1.COMPANY_MASTER_SID 
                     where PM.projection_Name like ? and PM.projection_description like ?
            ]]>

    </entry>
 
        <entry key="projectionSearchCount">

            <![CDATA[            
                     SELECT COUNT(DISTINCT PM.PROJECTION_MASTER_SID) projectionId
                    
                    From PROJECTION_MASTER PM
                  
                    JOIN HIERARCHY_DEFINITION HDP
                    ON HDP.HIERARCHY_DEFINITION_SID = PM.PRODUCT_HIERARCHY_SID 

                    LEFT JOIN COMPANY_GROUP CG
                    ON CG.COMPANY_GROUP_SID  = PM.COMPANY_GROUP_SID 

                    LEFT JOIN ITEM_GROUP IG 
                    ON IG.ITEM_GROUP_SID = PM.ITEM_GROUP_SID 
                                        JOIN COMPANY_MASTER CM 
                    on PM.COMPANY_MASTER_SID = CM.COMPANY_MASTER_SID 
                        
                    JOIN COMPANY_MASTER CM1
                     on PM.BUSINESS_UNIT = CM1.COMPANY_MASTER_SID 
                     where PM.projection_Name like ? and PM.projection_description like ?
            ]]>

    </entry>
    
		<entry key="CustomerGroup">
			<![CDATA[
					  
         ; WITH CTE_MAIN AS(
	SELECT
		IG.COMPANY_GROUP_SID,
		IG.COMPANY_GROUP_NO,
		IG.COMPANY_GROUP_NAME,
		CM.COMPANY_NAME,
		IG.VERSION_NO,
		IG.COMPANY_GROUP_DESCRIPTION,
		IGD.COMPANY_MASTER_SID
	FROM
		COMPANY_GROUP IG
	INNER JOIN COMPANY_GROUP_DETAILS IGD ON
		IGD.COMPANY_GROUP_SID = IG.COMPANY_GROUP_SID
	INNER JOIN COMPANY_MASTER CM ON
		IGD.COMPANY_MASTER_SID = CM.COMPANY_MASTER_SID
	WHERE
		IG.COMPANY_GROUP_NO LIKE ?
		AND IG.COMPANY_GROUP_NAME LIKE ?
),
COUNT_CTE AS(
	SELECT
		COMPANY_GROUP_SID,
		CNT
	FROM
		(
			SELECT
				Row_number() OVER(
					PARTITION BY COMPANY_GROUP_SID
				ORDER BY
					COMPANY_GROUP_SID
				) RN,
				Count( COMPANY_MASTER_SID ) OVER(
					PARTITION BY COMPANY_GROUP_SID
				) CNT,
				COMPANY_GROUP_SID,
				COMPANY_MASTER_SID
			FROM
				CTE_MAIN
		) A
	WHERE
		RN = 1
),
ITM_GROUP AS(
	SELECT
		CNT,
		COMPANY_GROUP_SID,
		COMPANY_GROUP_NO,
		COMPANY_GROUP_NAME,
		COMPANY_NAME,
		VERSION_NO,
		COMPANY_GROUP_DESCRIPTION
	FROM
		(
			SELECT
				Row_number() OVER(
					PARTITION BY COMPANY_GROUP_SID
				ORDER BY
					COMPANY_GROUP_SID
				) RN,
				Count( COMPANY_MASTER_SID ) OVER(
					PARTITION BY COMPANY_GROUP_SID
				) CNT,
				COMPANY_GROUP_SID,
				COMPANY_GROUP_NO,
				COMPANY_GROUP_NAME,
				COMPANY_NAME,
				VERSION_NO,
				COMPANY_GROUP_DESCRIPTION
			FROM
				CTE_MAIN
		) A
	WHERE
		RN = 1
) SELECT
	DISTINCT 
	IG.COMPANY_GROUP_NO,
	IG.COMPANY_GROUP_NAME,
	'' as SEGMENT_GROUP,
	'' as SEGMENT,
	IG.COMPANY_GROUP_SID,
	IG.VERSION_NO,
	IG.COMPANY_GROUP_DESCRIPTION
FROM
	ITM_GROUP IG
JOIN COUNT_CTE C ON
	IG.COMPANY_GROUP_SID = C.COMPANY_GROUP_SID
	AND C.CNT = IG.CNT
ORDER BY
	IG.COMPANY_GROUP_SID ASC 
			]]>
</entry>

<entry key="ProductGroup">
	<![CDATA[
		   
       
                   ;WITH CTE_MAIN
     AS (SELECT IG.ITEM_GROUP_SID,
                IG.ITEM_GROUP_NO,
                IG.ITEM_GROUP_NAME,
                CM.COMPANY_NAME,
                IG.VERSION_NO,
                IG.ITEM_GROUP_DESCRIPTION,
                IGD.ITEM_MASTER_SID
         FROM   ITEM_GROUP IG,
                COMPANY_MASTER CM,
                ITEM_GROUP_DETAILS IGD
         WHERE  IG.COMPANY_MASTER_SID = CM.COMPANY_MASTER_SID
                AND IGD.ITEM_GROUP_SID = IG.ITEM_GROUP_SID
                AND IG.ITEM_GROUP_NO LIKE ?
                AND IG.ITEM_GROUP_NAME LIKE ?
                
                ),
     COUNT_CTE
     AS (SELECT ITEM_GROUP_SID,
                CNT
         FROM   (SELECT ROW_NUMBER()
                          OVER (
                            PARTITION BY ITEM_GROUP_SID
                            ORDER BY ITEM_GROUP_SID)     RN,
                        COUNT(ITEM_MASTER_SID)
                          OVER (
                            PARTITION BY ITEM_GROUP_SID) CNT,
                        ITEM_GROUP_SID,
                        ITEM_MASTER_SID
                 FROM   CTE_MAIN
                  )A
         WHERE  RN = 1),
     ITM_GROUP
     AS (SELECT CNT,
                ITEM_GROUP_SID,
                ITEM_GROUP_NO,
                ITEM_GROUP_NAME,
                COMPANY_NAME,
                VERSION_NO,
                ITEM_GROUP_DESCRIPTION
         FROM   (SELECT ROW_NUMBER()
                          OVER (
                            PARTITION BY ITEM_GROUP_SID
                            ORDER BY ITEM_GROUP_SID)     RN,
                        COUNT(ITEM_MASTER_SID)
                          OVER (
                            PARTITION BY ITEM_GROUP_SID) CNT,
                        ITEM_GROUP_SID,
                        ITEM_GROUP_NO,
                        ITEM_GROUP_NAME,
                        COMPANY_NAME,
                        VERSION_NO,
                        ITEM_GROUP_DESCRIPTION
                 FROM   CTE_MAIN)A
         WHERE  RN = 1)
SELECT DISTINCT  IG.ITEM_GROUP_NO, IG.ITEM_GROUP_NAME, COMPANY_NAME,'' as SEGMENT_GROUP,'' as SEGMENT,IG.ITEM_GROUP_SID, IG.VERSION_NO, IG.ITEM_GROUP_DESCRIPTION
FROM   ITM_GROUP IG
       JOIN COUNT_CTE C
         ON IG.ITEM_GROUP_SID = C.ITEM_GROUP_SID
            AND C.CNT = IG.CNT
ORDER BY IG.ITEM_GROUP_SID ASC  
			]]>
	
</entry>

</properties>