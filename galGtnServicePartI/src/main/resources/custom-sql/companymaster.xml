<?xml version="1.0" encoding="UTF-8"?>
<custom-sql>
	<sql
		id="com.companymaster.service.persistence.CompanyMasterFinder.findCompanyMaster">

<![CDATA[select DISTINCT cm.companyMasterSid, 
cm.companyId, 
cm.companyNo, 
cm.companyName, 
cm.companyType, 
cm.companyStatus, 
crtq.companyQualifierName, 
crti.companyIdentifierValue, 
cm.recordLockStatus, 
cm.lives, 
cm.companyEndDate, 
cm.companyStatus,
cm.companyGroup, 
cm.financialSystem, 
cm.address1, 
cm.address2, 
cm.city, 
cm.state, 
cm.zipCode, 
cm.country, 
cm.regionCode, 
cm.createdBy, 
cm.createdDate, 
cm.modifiedBy, 
cm.modifiedDate, 
cm.batchId, 
cm.lastUpdatedDate, 
cm.companyStartDate, 
cm.inboundStatus, 
cm.companyCategory, 
cm.orgKey from 
CompanyMaster cm ,CompanyIdentifier crti,CompanyQualifier crtq where 
cm.companyMasterSid=crti.companyMasterSid and crti.companyQualifierSid=crtq.companyQualifierSid ]]>

	</sql>
        
        
<sql
		id="com.companymaster.service.persistence.CompanyMasterFinder.findCompanyMasterWithoutIdentifier">        
<![CDATA[            
select DISTINCT cm.COMPANY_MASTER_SID, 
cm.COMPANY_ID, 
cm.COMPANY_NO, 
cm.COMPANY_NAME, 
cm.COMPANY_TYPE, 
cm.COMPANY_STATUS, 
'' ,
'' ,
cm.RECORD_LOCK_STATUS, 
cm.LIVES, 
cm.COMPANY_END_DATE, 
cm.COMPANY_STATUS,
cm.COMPANY_GROUP, 
cm.FINANCIAL_SYSTEM, 
cm.ADDRESS1, 
cm.ADDRESS2, 
cm.CITY, 
cm.STATE, 
cm.ZIP_CODE, 
cm.COUNTRY, 
cm.REGION_CODE, 
cm.CREATED_BY, 
cm.CREATED_DATE, 
cm.MODIFIED_BY, 
cm.MODIFIED_DATE, 
cm.BATCH_ID, 
cm.LAST_UPDATED_DATE, 
cm.COMPANY_START_DATE, 
cm.INBOUND_STATUS, 
cm.COMPANY_CATEGORY, 
cm.ORGANIZATION_KEY
,udc.UDC1
,udc.UDC2
,udc.UDC3
,udc.UDC4 
,udc.UDC5 
,udc.UDC6,
trade.COMPANY_TRADE_CLASS,
trade.TRADE_CLASS_START_DATE,
trade.TRADE_CLASS_END_DATE,
parent.PARENT_COMPANY_MASTER_SID,
parent.PARENT_START_DATE,
parent.PARENT_END_DATE,
comp.COMPANY_NO as comp
,comp1.COMPANY_NO as priorCompanyNo,
parent.PRIOR_PARENT_START_DATE

from COMPANY_MASTER cm
LEFT join COMPANY_TRADE_CLASS trade
on cm.COMPANY_MASTER_SID=trade.COMPANY_MASTER_SID AND trade.INBOUND_STATUS <> 'D'
left join COMPANY_PARENT_DETAILS parent
on cm.COMPANY_MASTER_SID=parent.COMPANY_MASTER_SID and parent.INBOUND_STATUS <> 'D'
left join  UDCS udc
on cm.COMPANY_MASTER_SID = udc.MASTER_SID
and udc.MASTER_TYPE = 'COMPANY_MASTER'     
left join COMPANY_MASTER  comp on comp.COMPANY_MASTER_SID=parent.parent_company_master_sid 
left join COMPANY_MASTER  comp1 on comp1.COMPANY_MASTER_SID=parent.PRIOR_PARENT_CMPY_MASTER_SID

]]>
        </sql>
        
        
        <sql
id="com.companymaster.service.persistence.CompanyMasterFinder.findCompanyMasterWithIdentifier">        
<![CDATA[             
select DISTINCT cm.COMPANY_MASTER_SID, 
cm.COMPANY_ID, 
cm.COMPANY_NO, 
cm.COMPANY_NAME, 
cm.COMPANY_TYPE, 
cm.COMPANY_STATUS, 
crtq.COMPANY_QUALIFIER_NAME, 
crti.COMPANY_IDENTIFIER_VALUE, 
cm.RECORD_LOCK_STATUS, 
cm.LIVES, 
cm.COMPANY_END_DATE, 
cm.COMPANY_STATUS,
cm.COMPANY_GROUP, 
cm.FINANCIAL_SYSTEM, 
cm.ADDRESS1, 
cm.ADDRESS2, 
cm.CITY, 
cm.STATE, 
cm.ZIP_CODE, 
cm.COUNTRY, 
cm.REGION_CODE, 
cm.CREATED_BY, 
cm.CREATED_DATE, 
cm.MODIFIED_BY, 
cm.MODIFIED_DATE, 
cm.BATCH_ID, 
cm.LAST_UPDATED_DATE, 
cm.COMPANY_START_DATE, 
cm.INBOUND_STATUS, 
cm.COMPANY_CATEGORY, 
cm.ORGANIZATION_KEY
,udc.UDC1
,udc.UDC2
,udc.UDC3
,udc.UDC4 
,udc.UDC5 
,udc.UDC6,
trade.COMPANY_TRADE_CLASS,
trade.TRADE_CLASS_START_DATE,
trade.TRADE_CLASS_END_DATE,
parent.PARENT_COMPANY_MASTER_SID,
parent.PARENT_START_DATE,
parent.PARENT_END_DATE,
comp.COMPANY_NO as comp
,comp1.COMPANY_NO as priorCompanyNo,
parent.PRIOR_PARENT_START_DATE

from 
COMPANY_MASTER cm 
 join COMPANY_IDENTIFIER crti 
on cm.COMPANY_MASTER_SID=crti.COMPANY_MASTER_SID AND crti.INBOUND_STATUS <> 'D'
LEFT join COMPANY_TRADE_CLASS trade 
on cm.COMPANY_MASTER_SID=trade.COMPANY_MASTER_SID AND trade.INBOUND_STATUS <> 'D'
left join COMPANY_PARENT_DETAILS parent
on cm.COMPANY_MASTER_SID=parent.COMPANY_MASTER_SID AND parent.INBOUND_STATUS <> 'D'
 join COMPANY_QUALIFIER crtq
 on crti.COMPANY_QUALIFIER_SID=crtq.COMPANY_QUALIFIER_SID
 left join  UDCS udc
on cm.COMPANY_MASTER_SID = udc.MASTER_SID
and udc.MASTER_TYPE = 'COMPANY_MASTER'
left join COMPANY_MASTER  comp on comp.COMPANY_MASTER_SID=parent.parent_company_master_sid
left join COMPANY_MASTER  comp1 on comp1.COMPANY_MASTER_SID=parent.PRIOR_PARENT_CMPY_MASTER_SID
            
            ]]>
            
        </sql>        
        
        <sql
            id="findCompanyMasterWithIdentifierCount">        
                <![CDATA[
                    SELECT
                        DISTINCT COUNT(cm.COMPANY_MASTER_SID)
                    
                        
                        from 
                            COMPANY_MASTER cm 
                            join COMPANY_IDENTIFIER crti on cm.COMPANY_MASTER_SID=crti.COMPANY_MASTER_SID AND crti.INBOUND_STATUS <> 'D'
                            left join COMPANY_TRADE_CLASS trade on cm.COMPANY_MASTER_SID=trade.COMPANY_MASTER_SID AND trade.INBOUND_STATUS <> 'D'
                            left join COMPANY_PARENT_DETAILS parent on cm.COMPANY_MASTER_SID=parent.COMPANY_MASTER_SID AND parent.INBOUND_STATUS <> 'D'
                            join COMPANY_QUALIFIER crtq on crti.COMPANY_QUALIFIER_SID=crtq.COMPANY_QUALIFIER_SID
                            left join  UDCS udc on cm.COMPANY_MASTER_SID = udc.MASTER_SID and udc.MASTER_TYPE = 'COMPANY_MASTER'
                            left join COMPANY_MASTER  comp on comp.COMPANY_MASTER_SID=parent.parent_company_master_sid
                ]]>            
        </sql>  
        
        
        <sql
            id="findCompanyMasterWithoutIdentifierCount">        
                <![CDATA[            
                    select 
                        DISTINCT COUNT(cm.COMPANY_MASTER_SID)
                    from 
                        COMPANY_MASTER cm
                        LEFT JOIN COMPANY_TRADE_CLASS trade on cm.COMPANY_MASTER_SID=trade.COMPANY_MASTER_SID AND trade.INBOUND_STATUS <> 'D'
                        LEFT JOIN COMPANY_PARENT_DETAILS parent on cm.COMPANY_MASTER_SID=parent.COMPANY_MASTER_SID AND parent.INBOUND_STATUS <> 'D'
                        LEFT JOIN  UDCS udc on cm.COMPANY_MASTER_SID = udc.MASTER_SID and udc.MASTER_TYPE = 'COMPANY_MASTER'     
                        LEFT JOIN COMPANY_MASTER  comp on comp.COMPANY_MASTER_SID=parent.parent_company_master_sid
                ]]>
        </sql>
        <sql
            id="DeductionCalendarItemSelectionSearch">        
                <![CDATA[            
IM.ITEM_MASTER_SID,
IM.item_Id,
IM.item_no,
IM.item_Name,
IM.item_Desc,
IM.item_Type,
IM.item_Status,
IM.RECORD_LOCK_STATUS,
IM.item_Code,
IM.package_Size_Code,
IM.Upps,
IM.item_Start_Date,
IM.item_End_Date,
IM.labeler_Code,
IM.form,
IM.strength,
IM.primary_UOM,
IM.secondary_UOM,
IM.item_Class ,
IM.pediatric_Exclusive_Start_Date,
IM.pediatric_Exclusive_End_Date,
IM.clotting_Factor_Start_Date,
IM.clotting_Factor_End_Date,
BM.BRAND_NAME,
IM.NDC9,
IM.NDC8,
IM.therapeutic_Class,
IM.package_Size_Intro_Date,
CM.COMPANY_ID,
CM.COMPANY_NO,
CM.COMPANY_NAME,
IM.organization_Key,
IM.acquisition_Date,
IM.authorized_Generic,
IM.authorized_Generic_Start_Date,
IM.authorized_Generic_End_Date,
IM.first_Sale_Date,
IM.ITEM_TYPE_INDICATION,
IM.market_Termination_Date,
IM.new_Formulation_Indicator,
IM.new_Formulation,
IM.new_Formulation_Start_Date,
IM.new_Formulation_End_Date,
IM.pediatric_Exclusive_Indicator,
IM.clotting_Factor_Indicator,
IM.shelf_Life,
IM.shelf_Life_Type,
IM.dual_Pricing_Indicator,
IM.item_Family_ID,
IM.acquired_AMP,
IM.acquired_BAMP,
IM.OBRA_BAMP,
IM.DRA,
IM.doses_per_Unit,
IM.discontinuation_Date,
IM.last_Lot_Expiration_Date,
IM.baseline_AMP,
IM.BASE_CPI_PERIOD,
UDCS.UDC1,
UDCS.UDC2,
UDCS.UDC3,
UDCS.UDC4,
UDCS.UDC5,
UDCS.UDC6,
BM.DISPLAY_BRAND,
IM.ITEM_CLASS

FROM ITEM_MASTER IM 
LEFT JOIN COMPANY_MASTER CM ON CM.COMPANY_MASTER_SID=IM.MANUFACTURER_ID 
LEFT join UDCS UDCS ON UDCS.MASTER_SID=IM.ITEM_MASTER_SID AND UDCS.MASTER_TYPE='ITEM_MASTER'  
LEFT join dbo.BRAND_MASTER BM ON BM.BRAND_MASTER_SID=IM.BRAND_MASTER_SID ]]>
        </sql>
        
    <sql id="loadBusinessUnitInWorkflow">
        <![CDATA[
            SELECT distinct COMPANY_MASTER_SID,COMPANY_NO FROM COMPANY_MASTER WHERE COMPANY_ID in (SELECT distinct COMPANY_CODE FROM GL_COST_CENTER_MASTER)
        ]]>
    </sql>
    
    <sql id="loadWorkflowHistory">
        <![CDATA[
            SELECT HWM.MODIFIED_DATE,HWM.MODIFIED_BY,HWM.WORKFLOW_STATUS_ID,HWM.NOTES,HWM.FILE_NAME FROM HIST_WORKFLOW_MASTER HWM WHERE WORKFLOW_MASTER_SID = ? 
        ]]>
    </sql>
                        
</custom-sql>