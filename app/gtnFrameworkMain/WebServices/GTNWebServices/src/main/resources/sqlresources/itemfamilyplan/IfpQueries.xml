<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE xml>

<sql>
	<entity id="getItemAdditionSearchCountQuery">
		<query> 
            <![CDATA[           
        SELECT
        COUNT( IM.ITEM_MASTER_SID )

        FROM
                dbo.ITEM_MASTER IM
        JOIN BRAND_MASTER BM ON
                BM.BRAND_MASTER_SID = IM.BRAND_MASTER_SID
        LEFT JOIN HELPER_TABLE TC ON
                TC.HELPER_TABLE_SID = IM.THERAPEUTIC_CLASS
        LEFT JOIN HELPER_TABLE STR ON
                STR.HELPER_TABLE_SID = IM.STRENGTH
        LEFT JOIN HELPER_TABLE FO ON
                FO.HELPER_TABLE_SID = IM.FORM
        LEFT JOIN HELPER_TABLE STA ON
	STA.HELPER_TABLE_SID = IM.ITEM_STATUS
         LEFT JOIN HELPER_TABLE UOM ON
        UOM.HELPER_TABLE_SID = IM.PRIMARY_UOM
        WHERE
	IM.INBOUND_STATUS != 'D'
	AND BM.BRAND_NAME IS NOT NULL
	AND BM.BRAND_NAME != 'NONE'


	
                    ]]>
		</query>
	</entity>
	<entity id="getItemAdditionSearchResultsQuery">
		<query> 
            <![CDATA[           
                              SELECT
	IM.ITEM_NO,
	IM.ITEM_NAME,
	ISNULL(
		IM.ITEM_DESC,
		''
	) AS ITEM_DESC,
	STA.DESCRIPTION AS ITEM_STATUS,
	FO.DESCRIPTION AS FORM,
	STR.DESCRIPTION AS STRENGTH,
	replace(TC.DESCRIPTION, '-Select One-', '') AS THERAPEUTIC_CLASS,
	BM.BRAND_NAME,
	IM.ITEM_MASTER_SID
        FROM
                dbo.ITEM_MASTER IM
        JOIN BRAND_MASTER BM ON
                BM.BRAND_MASTER_SID = IM.BRAND_MASTER_SID
        LEFT JOIN HELPER_TABLE TC ON
                TC.HELPER_TABLE_SID = IM.THERAPEUTIC_CLASS
        LEFT JOIN HELPER_TABLE STR ON
                STR.HELPER_TABLE_SID = IM.STRENGTH
        LEFT JOIN HELPER_TABLE FO ON
                FO.HELPER_TABLE_SID = IM.FORM
        LEFT JOIN HELPER_TABLE STA ON
	STA.HELPER_TABLE_SID = IM.ITEM_STATUS
         LEFT JOIN HELPER_TABLE UOM ON
        UOM.HELPER_TABLE_SID = IM.PRIMARY_UOM
         WHERE
                 IM.INBOUND_STATUS != 'D'
                 AND BM.BRAND_NAME IS NOT NULL
                 AND BM.BRAND_NAME != 'NONE'
 ]]>
		</query>
	</entity>

	<entity id="getIFPItemAdditionMoveRightQuery">
		<query> 
            <![CDATA[           

 DECLARE @ITEM_MASTER_SID  INT =?,
        @USERS_SID VARCHAR(10) =?,
        @SESSION_ID VARCHAR(10) =?
IF EXISTS(
	SELECT
		1
	FROM
		IMTD_IFP_DETAILS 
	WHERE 
		USERS_SID = @USERS_SID
		AND SESSION_ID = @SESSION_ID
		AND ITEM_MASTER_SID = @ITEM_MASTER_SID
) UPDATE
	IMTD_IFP_DETAILS
SET
	IFP_DETAILS_START_DATE = NULL,
	IFP_DETAILS_END_DATE = NULL,
	IFP_DETAILS_ATTACHED_DATE = GETDATE(),
	IFP_DETAILS_ATTACHED_STATUS = NULL,
	IFP_DETAILS_CREATED_DATE = GETDATE(),
	IFP_DETAILS_CREATED_BY = @USERS_SID,
	IFP_DETAILS_MODIFIED_DATE = GETDATE(),
	IFP_DETAILS_MODIFIED_BY = @USERS_SID,
	OPERATION = 'A'

        
WHERE
	USERS_SID = @USERS_SID
	AND SESSION_ID = @SESSION_ID
	AND ITEM_MASTER_SID = @ITEM_MASTER_SID
	ELSE
	
	INSERT
	INTO
		IMTD_IFP_DETAILS(
			IFP_MODEL_SID,
			ITEM_MASTER_SID,
			ITEM_NO,
			ITEM_NAME,
			ITEM_DESC,
			ITEM_STATUS,
			ITEM_THERAPEUTIC_CLASS,
			ITEM_BRAND,
			ITEM_FORM,
			ITEM_STRENGTH,
			IFP_DETAILS_START_DATE,
			IFP_DETAILS_END_DATE,
			IFP_DETAILS_ATTACHED_STATUS,
			IFP_DETAILS_CREATED_BY,
			IFP_DETAILS_CREATED_DATE,
			IFP_DETAILS_MODIFIED_BY,
			IFP_DETAILS_MODIFIED_DATE,
			IFP_DETAILS_ATTACHED_DATE,
			USERS_SID,
			SESSION_ID,
			IMTD_CREATEDDATE,
			CHECK_BOX,
			"OPERATION"
		)
		SELECT
		0,
		IM.ITEM_MASTER_SID,
		IM.ITEM_NO,
		IM.ITEM_NAME,
		IM.ITEM_DESC,
		IM.ITEM_STATUS,
		IM.THERAPEUTIC_CLASS,
		IM.BRAND_MASTER_SID,
		IM.FORM,
		IM.STRENGTH,
		NULL,
		NULL,
		NULL,
		@USERS_SID,
		GETDATE(),
		@USERS_SID,
		GETDATE(),
		GETDATE(),
		@USERS_SID,
		@SESSION_ID,
		GETDATE(),
		0,
		'A'
		
FROM
	ITEM_MASTER IM
WHERE
	IM.INBOUND_STATUS <> 'D'
	AND IM.ITEM_MASTER_SID = @ITEM_MASTER_SID

 ]]>
		</query>
	</entity>


	<entity id="getIFPItemAdditionRightTableCountQuery">
		<query> 
            <![CDATA[           
      SELECT
	COUNT(DISTINCT IM.ITEM_MASTER_SID)
         FROM
                dbo.IMTD_IFP_DETAILS IM
        JOIN BRAND_MASTER BM ON
                BM.BRAND_MASTER_SID = IM.ITEM_BRAND
        LEFT JOIN HELPER_TABLE TC ON
                TC.HELPER_TABLE_SID = IM.ITEM_THERAPEUTIC_CLASS
        LEFT JOIN HELPER_TABLE STR ON
                STR.HELPER_TABLE_SID = IM.ITEM_STRENGTH
        LEFT JOIN HELPER_TABLE FO ON
                FO.HELPER_TABLE_SID = IM.ITEM_FORM
        LEFT JOIN HELPER_TABLE STA ON
	STA.HELPER_TABLE_SID = IM.ITEM_STATUS
 ]]>
		</query>
	</entity>


	<entity id="getIFPItemAdditionRightTableSearchQuery">
		<query> 
            <![CDATA[           
     SELECT
	IM.ITEM_NO,
	IM.ITEM_NAME,
	ISNULL(
		IM.ITEM_DESC,
		''
	) AS ITEM_DESC,
	STA.DESCRIPTION AS ITEM_STATUS,
	FO.DESCRIPTION AS FORM,
	STR.DESCRIPTION AS STRENGTH,
	replace(TC.DESCRIPTION, '-Select One-', '') AS THERAPEUTIC_CLASS,
	BM.BRAND_NAME,
	IM.ITEM_MASTER_SID
        FROM
                dbo.IMTD_IFP_DETAILS IM
        JOIN BRAND_MASTER BM ON
                BM.BRAND_MASTER_SID = IM.ITEM_BRAND
        LEFT JOIN HELPER_TABLE TC ON
                TC.HELPER_TABLE_SID = IM.ITEM_THERAPEUTIC_CLASS
        LEFT JOIN HELPER_TABLE STR ON
                STR.HELPER_TABLE_SID = IM.ITEM_STRENGTH
        LEFT JOIN HELPER_TABLE FO ON
                FO.HELPER_TABLE_SID = IM.ITEM_FORM
        LEFT JOIN HELPER_TABLE STA ON
	STA.HELPER_TABLE_SID = IM.ITEM_STATUS
 ]]>
		</query>
	</entity>

	<entity id="getIfpItemAdditionMoveLeftQuery">
		<query> 
            <![CDATA[           
            
         DELETE FROM IMTD_IFP_DETAILS WHERE USERS_SID =?  AND SESSION_ID = ? AND ITEM_MASTER_SID=?
 ]]>
		</query>
	</entity>
	<entity id="getIfpItemAdditionMoveAllLeftQuery">
		<query> 
            <![CDATA[           
            
        DELETE IM
     FROM
                dbo.IMTD_IFP_DETAILS IM
        JOIN BRAND_MASTER BM ON
                BM.BRAND_MASTER_SID = IM.ITEM_BRAND
        LEFT JOIN HELPER_TABLE TC ON
                TC.HELPER_TABLE_SID = IM.ITEM_THERAPEUTIC_CLASS
        LEFT JOIN HELPER_TABLE STR ON
                STR.HELPER_TABLE_SID = IM.ITEM_STRENGTH
        LEFT JOIN HELPER_TABLE FO ON
                FO.HELPER_TABLE_SID = IM.ITEM_FORM
        LEFT JOIN HELPER_TABLE STA ON
	STA.HELPER_TABLE_SID = IM.ITEM_STATUS
        WHERE IM.USERS_SID = ?  AND IM.SESSION_ID = ? 
 ]]>
		</query>
	</entity>

	<entity id="getIfpItemsAdditionMoveAllRightQuery">
		<query> 
            <![CDATA[           

DECLARE @USERS_SID VARCHAR(10)=?,
@SESSION_ID VARCHAR(10)=?

 MERGE IMTD_IFP_DETAILS AS T
	USING(
	SELECT
		IM.ITEM_MASTER_SID,
		IM.ITEM_NO,
		IM.ITEM_NAME,
		IM.ITEM_DESC,
		IM.ITEM_STATUS,
		IM.THERAPEUTIC_CLASS,
		IM.BRAND_MASTER_SID,
		IM.FORM,
		IM.STRENGTH

		
FROM
	ITEM_MASTER IM
        JOIN BRAND_MASTER BM ON
                BM.BRAND_MASTER_SID = IM.BRAND_MASTER_SID
        LEFT JOIN HELPER_TABLE TC ON
                TC.HELPER_TABLE_SID = IM.THERAPEUTIC_CLASS
        LEFT JOIN HELPER_TABLE STR ON
                STR.HELPER_TABLE_SID = IM.STRENGTH
        LEFT JOIN HELPER_TABLE FO ON
                FO.HELPER_TABLE_SID = IM.FORM
        LEFT JOIN HELPER_TABLE STA ON
                STA.HELPER_TABLE_SID = IM.ITEM_STATUS
        LEFT JOIN HELPER_TABLE UOM ON
                UOM.HELPER_TABLE_SID = IM.PRIMARY_UOM
WHERE
	IM.INBOUND_STATUS <> 'D'
		[$WHERE_CLAUSE]
) AS S ON
(
	S.ITEM_MASTER_SID = T.ITEM_MASTER_SID 
	AND T.USERS_SID = @USERS_SID
	AND T.SESSION_ID = @SESSION_ID
)
WHEN MATCHED
AND T.OPERATION IN(
	'F',
	'D'
) THEN UPDATE
SET
	IFP_DETAILS_START_DATE = NULL,
	IFP_DETAILS_END_DATE = NULL,
	IFP_DETAILS_ATTACHED_DATE = GETDATE(),
	IFP_DETAILS_ATTACHED_STATUS = NULL,
	IFP_DETAILS_CREATED_DATE = GETDATE(),
	IFP_DETAILS_CREATED_BY = @USERS_SID,
	IFP_DETAILS_MODIFIED_DATE = NULL,
	IFP_DETAILS_MODIFIED_BY = NULL,
	OPERATION = 'A'
	
	WHEN NOT MATCHED BY TARGET THEN INSERT
		(
			IFP_MODEL_SID,
			ITEM_MASTER_SID,
			ITEM_NO,
			ITEM_NAME,
			ITEM_DESC,
			ITEM_STATUS,
			ITEM_THERAPEUTIC_CLASS,
			ITEM_BRAND,
			ITEM_FORM,
			ITEM_STRENGTH,
			IFP_DETAILS_START_DATE,
			IFP_DETAILS_END_DATE,
			IFP_DETAILS_ATTACHED_STATUS,
			IFP_DETAILS_CREATED_BY,
			IFP_DETAILS_CREATED_DATE,
			IFP_DETAILS_MODIFIED_BY,
			IFP_DETAILS_MODIFIED_DATE,
			IFP_DETAILS_ATTACHED_DATE,
			USERS_SID,
			SESSION_ID,
			IMTD_CREATEDDATE,
			CHECK_BOX,
			"OPERATION"
		)
	VALUES(
		0,
		S.ITEM_MASTER_SID,
		S.ITEM_NO,
		S.ITEM_NAME,
		S.ITEM_DESC,
		S.ITEM_STATUS,
		S.THERAPEUTIC_CLASS,
		S.BRAND_MASTER_SID,
		S.FORM,
		S.STRENGTH,
		NULL,
		NULL,
		NULL,
		@USERS_SID,
		GETDATE(),
		@USERS_SID,
		GETDATE(),
		GETDATE(),
		@USERS_SID,
		@SESSION_ID,
		GETDATE(),
		0,
		'A'
	);
;

 ]]>
		</query>
	</entity>

	<entity id="getIfpItemsResultTableCountQuery">
		<query> 
            <![CDATA[           
         	SELECT
		COUNT(*)
	 FROM
                dbo.IMTD_IFP_DETAILS ICD
        JOIN BRAND_MASTER BM ON
                BM.BRAND_MASTER_SID = ICD.ITEM_BRAND
        LEFT JOIN HELPER_TABLE TC ON
                TC.HELPER_TABLE_SID = ICD.ITEM_THERAPEUTIC_CLASS
        LEFT JOIN HELPER_TABLE STR ON
                STR.HELPER_TABLE_SID = ICD.ITEM_STRENGTH
        LEFT JOIN HELPER_TABLE FO ON
                FO.HELPER_TABLE_SID = ICD.ITEM_FORM
        LEFT JOIN HELPER_TABLE STA ON
	STA.HELPER_TABLE_SID = ICD.ITEM_STATUS
	WHERE
		ICD.OPERATION NOT IN(
			'D',
			'F'
		)
		AND ICD.USERS_SID = ?
		AND ICD.SESSION_ID =?
 ]]>
		</query>
	</entity>
	<entity id="getIfpItemsResultTableSearchQuery">
		<query> 
            <![CDATA[   
         		SELECT
	CONVERT(
		BIT,
		CASE
			WHEN ICD.CHECK_BOX IS NULL THEN 0
			ELSE ICD.CHECK_BOX
		END
	) AS CHECK_BOX,
	ICD.ITEM_NO,
	ICD.ITEM_NAME,
	ISNULL(
		ICD.ITEM_DESC,
		''
	) ITEM_DESC,
	ISNULL(
		ICD.IFP_DETAILS_ATTACHED_STATUS,
		0
	) AS TEMP_IFP_STATUS,
	ICD.IFP_DETAILS_START_DATE,
	ICD.IFP_DETAILS_END_DATE,
	STA.DESCRIPTION AS TEMP_ITEM_STATUS,
	FO.DESCRIPTION AS ITEM_FORM,
	STR.DESCRIPTION AS ITEM_STRENGTH,
	TC.DESCRIPTION AS THERAPEUTIC_CLASS,
	ISNULL(
		BM.BRAND_NAME,
		''
	) BRAND_NAME,
	ICD.IFP_DETAILS_ATTACHED_DATE,
	ICD.IFP_DETAILS_MODIFIED_DATE,
	ISNULL(
		ICD.IFP_DETAILS_MODIFIED_BY,
		''
	) AS IFP_DETAILS_MODIFIED_BY,
	ICD.IFP_DETAILS_CREATED_DATE,
	ICD.IFP_DETAILS_CREATED_BY,
	ICD.IMTD_IFP_DETAILS_SID,
	IFPSTATUS.DESCRIPTION as IFPSTATUSVALUE
FROM
	dbo.IMTD_IFP_DETAILS ICD
JOIN BRAND_MASTER BM ON
	BM.BRAND_MASTER_SID = ICD.ITEM_BRAND
LEFT JOIN HELPER_TABLE TC ON
	TC.HELPER_TABLE_SID = ICD.ITEM_THERAPEUTIC_CLASS
	AND TC.LIST_NAME like 'THERAPEUTIC_CLASS'
LEFT JOIN HELPER_TABLE STR ON
	STR.HELPER_TABLE_SID = ICD.ITEM_STRENGTH
LEFT JOIN HELPER_TABLE FO ON
	FO.HELPER_TABLE_SID = ICD.ITEM_FORM
LEFT JOIN HELPER_TABLE STA ON
	STA.HELPER_TABLE_SID = ICD.ITEM_STATUS
LEFT JOIN HELPER_TABLE IFPSTATUS ON
	IFPSTATUS.HELPER_TABLE_SID = IFP_DETAILS_ATTACHED_STATUS
WHERE
	ICD.OPERATION NOT IN(
		'D',
		'F'
	)
		AND ICD.USERS_SID = ?
		AND ICD.SESSION_ID = ?
 ]]>
		</query>
	</entity>
	<entity id="getIfpItemsUpdateColumnQuery">
		<query> 
            <![CDATA[           
         	UPDATE IMTD_IFP_DETAILS SET [$UPDATE_CLAUSE] ='[$UPDATE_CLAUSE_VALUE]'  WHERE USERS_SID = ?  AND SESSION_ID = ?  [$WHERE_CLAUSE]
 ]]>
		</query>
	</entity>


	<entity id="getIfpItemsTabUpdateFieldsQuery">
		<query> 
            <![CDATA[           
        UPDATE IMTD_IFP_DETAILS SET [$UPDATE_CLAUSE] WHERE USERS_SID = ?  AND SESSION_ID = ?  [$SYSTEM_ID_CLAUSE]
 ]]>
		</query>
	</entity>
	<entity id="getIfpDetailsSaveQuery">
		<query> 

            <![CDATA[           

          DECLARE  @IFP_MODEL_SID INT =?,
        @USERS_SID VARCHAR(100) =?,
        @SESSION_ID VARCHAR(100) =?

        UPDATE IMTD_IFP_DETAILS SET IFP_MODEL_SID=@IFP_MODEL_SID WHERE USERS_SID=@USERS_SID AND SESSION_ID=@SESSION_ID
        AND CHECK_BOX=1;

        DELETE IFP FROM DBO.IFP_DETAILS IFP  
        JOIN IMTD_IFP_DETAILS IMTD ON IFP.IFP_MODEL_SID=IMTD.IFP_MODEL_SID AND
       -- IMTD.CHECK_BOX=1 AND 
        IMTD.USERS_SID=@USERS_SID AND IMTD.SESSION_ID=@SESSION_ID;

        DELETE FROM IMTD_IFP_DETAILS WHERE USERS_SID=@USERS_SID AND SESSION_ID=@SESSION_ID AND CHECK_BOX=0;
     
        INSERT
                INTO
		IFP_DETAILS(
			IFP_MODEL_SID,
			ITEM_MASTER_SID,
			START_DATE,
			END_DATE,
			ITEM_IFP_ATTACHED_STATUS,
			ITEM_IFP_ATTACHED_DATE,
                                INBOUND_STATUS,
                                RECORD_LOCK_STATUS,
                                "SOURCE",
                                CREATED_BY,
                                CREATED_DATE,
                                MODIFIED_BY,
                                MODIFIED_DATE
		) SELECT
			IFP_MODEL_SID,
			ITEM_MASTER_SID,
			IFP_DETAILS_START_DATE,
			IFP_DETAILS_END_DATE,
			IFP_DETAILS_ATTACHED_STATUS,
			IFP_DETAILS_ATTACHED_DATE,
                                'A',
                                0,
                                'GTN',
			IFP_DETAILS_CREATED_BY,
			IFP_DETAILS_CREATED_DATE,
			IFP_DETAILS_MODIFIED_BY,
			IFP_DETAILS_MODIFIED_DATE
                        FROM
			IMTD_IFP_DETAILS
                        WHERE
                        CHECK_BOX = 1 AND  
                        USERS_SID = @USERS_SID
			AND SESSION_ID = @SESSION_ID
			AND IFP_MODEL_SID = @IFP_MODEL_SID;
 ]]>
		</query>
	</entity>

	<entity id="getIfpItemsTabEditQuery">
		<query> 
            <![CDATA[   
            
             

DECLARE @USERS_SID VARCHAR(10)=?,
@SESSION_ID VARCHAR(10)=?,
@IFP_MODEL_SID INT=?

       DELETE FROM IMTD_IFP_DETAILS WHERE USERS_SID = @USERS_SID AND SESSION_ID = @SESSION_ID;        
          INSERT
	INTO
		IMTD_IFP_DETAILS(
			IFP_MODEL_SID,
			ITEM_MASTER_SID,
			ITEM_ID,
			ITEM_NO,
			ITEM_NAME,
			ITEM_DESC,
			ITEM_STATUS,
			ITEM_THERAPEUTIC_CLASS,
			ITEM_BRAND,
			ITEM_FORM,
			ITEM_STRENGTH,
			IFP_DETAILS_START_DATE,
			IFP_DETAILS_END_DATE,
			IFP_DETAILS_ATTACHED_STATUS,
			IFP_DETAILS_ATTACHED_DATE,
			IFP_DETAILS_CREATED_BY,
			IFP_DETAILS_CREATED_DATE,
			IFP_DETAILS_MODIFIED_BY,
			IFP_DETAILS_MODIFIED_DATE,
			USERS_SID,
			SESSION_ID,
			IMTD_CREATEDDATE,
			CHECK_BOX,
			"OPERATION"
		)
		

SELECT
	IFP.IFP_MODEL_SID,
	IFP.ITEM_MASTER_SID,
	IM.ITEM_ID,
	IM.ITEM_NO,
	IM.ITEM_NAME,
	IM.ITEM_DESC,
	IM.ITEM_STATUS,
	IM.THERAPEUTIC_CLASS,
	IM.BRAND_MASTER_SID,
	IM.FORM,
	IM.STRENGTH,
	IFP.START_DATE,
	IFP.END_DATE,
	IFP.ITEM_IFP_ATTACHED_STATUS,
	IFP.ITEM_IFP_ATTACHED_DATE,		
	IFP.CREATED_BY,
	IFP.CREATED_DATE,
	IFP.MODIFIED_BY,
	IFP.MODIFIED_DATE,
			@USERS_SID,
			@SESSION_ID,
			GETDATE(),
			1,
	'A'
	
		FROM
                DBO.IFP_DETAILS IFP
        JOIN DBO.ITEM_MASTER IM ON
                IM.ITEM_MASTER_SID = IFP.ITEM_MASTER_SID
		WHERE
                IFP.INBOUND_STATUS <> 'D'
                AND IFP.IFP_MODEL_SID = @IFP_MODEL_SID
			

 ]]>
		</query>
	</entity>
	<entity id="getIfpCompaniesTabDeleteQuery">
		<query> 
            <![CDATA[   
             DELETE FROM IMTD_IFP_DETAILS WHERE  USERS_SID = ?  AND SESSION_ID = ?;
                ]]>
		</query>
	</entity>
	<entity id="getIfpCommonValidationQuery">
		<query> 
            <![CDATA[   
             
                DECLARE @USERS_SID varchar(500)= ? ,
@SESSION_ID varchar(500)= ?  
-- COUNT QUERY
	 
  SELECT 'ITEMS_COUNT' AS COLUMN_ID ,  CONVERT(VARCHAR(50),COUNT(*)) AS ITEM_NO_OR_COUNT,0 AS COUNT  FROM IMTD_IFP_DETAILS
                WHERE   USERS_SID =@USERS_SID
                AND SESSION_ID = @SESSION_ID
        UNION ALL
 -- IFP_DETAILS_START_DATE NULL CHECK QUERY
         select 'IFP_DETAILS_START_DATE',CASE WHEN COUNT(*) =1 THEN min(ITEM_NO) ELSE  CONVERT(VARCHAR(50),COUNT(*))  END  AS ITEM_NO_OR_COUNT,0  AS COUNT from dbo.IMTD_IFP_DETAILS where
             IFP_DETAILS_START_DATE is null and CHECK_BOX=1 and OPERATION Not In ('D','F')  AND USERS_SID =@USERS_SID AND SESSION_ID=@SESSION_ID
     UNION ALL
             SELECT     'IFP_DETAILS_ATTACHED_STATUS' AS COLUMN_ID ,CASE WHEN COUNT(*)  =1 THEN  min(ITEM_NO)   ELSE  CONVERT(VARCHAR(50),COUNT(*))  END AS ITEM_NO_OR_COUNT,0 AS COUNT
                        FROM
                        dbo.IMTD_IFP_DETAILS
                        WHERE
                        (
                                IFP_DETAILS_ATTACHED_STATUS IS NULL
                                OR IFP_DETAILS_ATTACHED_STATUS = ''
                                OR IFP_DETAILS_ATTACHED_STATUS = 0
                        )
                        AND CHECK_BOX = 1
                        AND USERS_SID =@USERS_SID
                        AND SESSION_ID = @SESSION_ID

        UNION ALL
         -- START_DATE_GREATER_END_DATE CHECK QUERY
        select 'START_DATE_GREATER_END_DATE' AS COLUMN_ID ,CASE WHEN COUNT(*) =1 THEN min(ITEM_NO) ELSE  CONVERT(VARCHAR(50),COUNT(*))  END AS ITEM_NO_OR_COUNT ,0 AS COUNT
        from dbo.IMTD_IFP_DETAILS where IFP_DETAILS_START_DATE > IFP_DETAILS_END_DATE
        AND CHECK_BOX = 1
        and OPERATION Not In ('D','F')
        AND USERS_SID =@USERS_SID
        AND SESSION_ID = @SESSION_ID

        UNION ALL
                 -- START_DATE_GREATER_END_DATE CHECK QUERY

        SELECT 'CHECKED_RECORD_COUNT' AS COLUMN_ID,  CONVERT(VARCHAR(50),COUNT(*)) AS ITEM_NO_OR_COUNT,0 AS COUNT FROM IMTD_IFP_DETAILS
        WHERE  CHECK_BOX = 1
        AND USERS_SID =@USERS_SID
        AND SESSION_ID = @SESSION_ID
        
        UNION ALL
             -- START_DATE_EQUALS_END_DATE CHECK QUERY
        select 'START_DATE_EQUALS_END_DATE' AS COLUMN_ID ,CASE WHEN COUNT(*) =1 THEN min(ITEM_NO) ELSE  CONVERT(VARCHAR(50),COUNT(*))  END AS ITEM_NO_OR_COUNT ,0 AS COUNT
        from dbo.IMTD_IFP_DETAILS where IFP_DETAILS_START_DATE = IFP_DETAILS_END_DATE
        AND CHECK_BOX = 1
        and OPERATION Not In ('D','F')
        AND USERS_SID =@USERS_SID
        AND SESSION_ID = @SESSION_ID
                ]]>
		</query>
	</entity>
	<entity id="getIfpIfpIdAndIfpNoValidationQuery">
		<query> 
            <![CDATA[    
             DECLARE @IFP_ID varchar(500)= ? ,
            @IFP_NO varchar(500)= ?

            SELECT CASE WHEN IFP_ID = @IFP_ID AND IFP_NO = @IFP_NO THEN 'IFP_ID, IFP_NO'
                        WHEN  IFP_ID = @IFP_ID THEN 'IFP_ID'
                        WHEN IFP_NO = @IFP_NO THEN 'IFP_NO'
                        ELSE '' END   AS COULMN1
             FROM IFP_MODEL WHERE (IFP_ID =@IFP_ID OR IFP_NO = @IFP_NO)
 ]]>
		</query>
	</entity>

	<entity id="getIfpItemsCheckAllQuery">
		<query> 
            <![CDATA[  
            UPDATE IMTD_IFP_DETAILS SET CHECK_BOX = ? WHERE USERS_SID = ?  AND SESSION_ID = ?    
           
 ]]>
		</query>
	</entity>
</sql>