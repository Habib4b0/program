<?xml version="1.0" encoding="UTF-8"?>
<!--
To change this template, choose Tools | Templates
and open the template in the editor.
-->
<custom-sql>
    

    
    <sql id="ad.cfpFromCD">
		<![CDATA[
                SELECT Distinct CFP_CM.COMPANY_NO, CFP_CM.COMPANY_NAME, ST.DESCRIPTION,CFP_CD.COMPANY_START_DATE, CFP_CD.COMPANY_END_DATE 
                FROM CFP_CONTRACT_DETAILS CFP_CD 
                JOIN COMPANY_MASTER CFP_CM ON CFP_CM.COMPANY_MASTER_SID=CFP_CD.COMPANY_MASTER_SID AND CFP_CD.CFP_CONTRACT_SID=?SID? AND CFP_CD.INBOUND_STATUS <> 'D' 
                LEFT JOIN HELPER_TABLE ST ON ST.HELPER_TABLE_SID=CFP_CM.COMPANY_STATUS;
		]]>
    </sql>
    
    <sql id="ad.ifpFromCD">
		<![CDATA[
                    SELECT IFP_IM.ITEM_NO, IFP_IM.ITEM_NAME,ST.DESCRIPTION as THERAPHY, BND.BRAND_NAME, ST1.DESCRIPTION as STATUS, IFP_CD.ITEM_START_DATE, IFP_CD.ITEM_END_DATE 
                    FROM IFP_CONTRACT_DETAILS IFP_CD 
                    JOIN ITEM_MASTER IFP_IM ON IFP_IM.ITEM_MASTER_SID=IFP_CD.ITEM_MASTER_SID  AND IFP_CD.INBOUND_STATUS <> 'D' 
                        AND IFP_CD.IFP_CONTRACT_SID=?SID?                                                                                
                    JOIN BRAND_MASTER BND ON IFP_IM.BRAND_MASTER_SID=BND.BRAND_MASTER_SID
                    LEFT JOIN HELPER_TABLE ST1 ON ST1.HELPER_TABLE_SID=IFP_IM.ITEM_STATUS
                    LEFT JOIN HELPER_TABLE ST ON ST.HELPER_TABLE_SID=IFP_IM.THERAPEUTIC_CLASS;
		]]>
    </sql>
    
    <sql id="ad.psFromCD">
		<![CDATA[
                    SELECT PS_IM.ITEM_NO, PS_IM.ITEM_NAME, ST.DESCRIPTION As Theraphy,BND.BRAND_NAME,ST1.DESCRIPTION as Status, PS_CD.CONTRACT_PRICE_START_DATE, PS_CD.CONTRACT_PRICE_END_DATE
                    FROM PS_CONTRACT_DETAILS PS_CD 
                    JOIN ITEM_MASTER PS_IM ON PS_IM.ITEM_MASTER_SID=PS_CD.ITEM_MASTER_SID  AND PS_CD.INBOUND_STATUS <> 'D' 
                        AND PS_CD.PS_CONTRACT_SID=?SID?
                    LEFT JOIN BRAND_MASTER BND ON PS_IM.BRAND_MASTER_SID=BND.BRAND_MASTER_SID
                    LEFT JOIN HELPER_TABLE ST ON ST.HELPER_TABLE_SID=PS_IM.THERAPEUTIC_CLASS
                    
                    LEFT JOIN HELPER_TABLE ST1 ON ST1.HELPER_TABLE_SID=PS_IM.ITEM_STATUS;
		]]>
    </sql>
    
    <sql id="ad.rsFromCD">
		<![CDATA[
                    SELECT RS_IM.ITEM_NO, RS_IM.ITEM_NAME, BND.BRAND_NAME,ST.DESCRIPTION As Theraphy, ST1.DESCRIPTION as Status, RS_CD.ITEM_REBATE_START_DATE, RS_CD.ITEM_REBATE_END_DATE 
                        
                    FROM RS_CONTRACT_DETAILS RS_CD 
                    JOIN ITEM_MASTER RS_IM ON RS_IM.ITEM_MASTER_SID=RS_CD.ITEM_MASTER_SID  AND RS_CD.INBOUND_STATUS <> 'D' 
                        AND RS_CD.RS_CONTRACT_SID=?SID?
                    JOIN BRAND_MASTER BND ON RS_IM.BRAND_MASTER_SID=BND.BRAND_MASTER_SID
                    LEFT JOIN HELPER_TABLE ST ON ST.HELPER_TABLE_SID=RS_IM.THERAPEUTIC_CLASS
                    LEFT JOIN HELPER_TABLE ST1 ON ST1.HELPER_TABLE_SID=RS_IM.ITEM_STATUS;
		]]>
    </sql>
    <sql id="ad.cfpSearch">
        <![CDATA[
            select Distinct CFP.CFP_MODEL_SID,CFP.CFP_ID,CFP.CFP_NO,CFP.CFP_NAME,HT.DESCRIPTION AS CFPTYPE,HT1.DESCRIPTION AS CFP_STATUS, CFP.CFP_START_DATE,CFP.CFP_END_DATE from CFP_MODEL CFP
            join HELPER_TABLE HT ON HT.HELPER_TABLE_SID=CFP.CFP_TYPE AND CFP.CFP_ID like '?CFP_ID?' AND CFP.CFP_NO like '?CFP_NO?' AND CFP.CFP_NAME like '?CFP_NAME?' AND CFP.CFP_TYPE like '?CFP_TYPE?' AND CFP.CFP_STATUS like '?CFP_STATUS?'
            join HELPER_TABLE HT1 ON HT1.HELPER_TABLE_SID=CFP.CFP_STATUS where CFP.INBOUND_STATUS !='D'
            ]]>
    </sql>
    <sql id="ad.ifpSearch">
        <![CDATA[
            select Distinct IFP.IFP_MODEL_SID,IFP.IFP_ID,IFP.IFP_NO,IFP.IFP_NAME,HT.DESCRIPTION AS IFPTYPE,HT1.DESCRIPTION AS IFP_STATUS, IFP.IFP_START_DATE,IFP.IFP_END_DATE from IFP_MODEL IFP
            join HELPER_TABLE HT ON HT.HELPER_TABLE_SID=IFP.IFP_TYPE AND IFP.IFP_ID like '?IFP_ID?' AND IFP.IFP_NO like '?IFP_NO?' AND IFP.IFP_NAME like '?IFP_NAME?' AND IFP.IFP_TYPE like '?IFP_TYPE?' AND IFP.IFP_STATUS like '?IFP_STATUS?'
            join HELPER_TABLE HT1 ON HT1.HELPER_TABLE_SID=IFP.IFP_STATUS where IFP.INBOUND_STATUS !='D'
            ]]>
    </sql>
    <sql id="ad.ifpSearchCount">
        <![CDATA[
            select Count(Distinct IFP.IFP_MODEL_SID) from IFP_MODEL IFP where IFP.IFP_ID like '?IFP_ID?' AND IFP.IFP_NO like '?IFP_NO?' AND IFP.IFP_NAME like '?IFP_NAME?' 
            AND IFP.IFP_TYPE like '?IFP_TYPE?' AND IFP.IFP_STATUS like '?IFP_STATUS?' AND IFP.INBOUND_STATUS !='D'           
            ]]>
    </sql>
    <!--    <sql id="ad.tempItemSearch">
        <![CDATA[
            select Distinct IMTD_ITEM_PRICE_REBATE_SID,IFP_MODEL_SID,ITEM_MASTER_SID,ITEM_ID,ITEM_NO,ITEM_NAME,ITEM_TYPE,RS_DETAILS_SID as STATUS,UDC1 as BRAND,ITEM_REBATE_START_DATE,ITEM_REBATE_END_DATE,REBATE_PLAN_SYSTEM_ID,UDC2 as REBATE_PLAN_NAME,FORMULA_ID,FORMULA_NAME,CHECK_RECORD  
            from dbo.IMTD_ITEM_PRICE_REBATE_DETAILS where USERS_SID=?USERS_SID?         AND SESSION_ID='?SESSION_ID?'         AND OPERATION like '?OPERATION?'           
            ]]>
    </sql>-->
    <sql id="ad.tempItemSearch">
        <![CDATA[
            select Distinct IIPRD.IMTD_ITEM_PRICE_REBATE_SID,IIPRD.IFP_MODEL_SID,IIPRD.ITEM_MASTER_SID,IIPRD.ITEM_ID,IIPRD.ITEM_NO,IIPRD.ITEM_NAME,
            HT.DESCRIPTION AS ITEM_TYPE,IIPRD.RS_DETAILS_SID as STATUS,BM.BRAND_NAME as BRAND,IIPRD.ITEM_REBATE_START_DATE,IIPRD.ITEM_REBATE_END_DATE,
            IIPRD.REBATE_PLAN_SYSTEM_ID,IIPRD.UDC2 as REBATE_PLAN_NAME,IIPRD.FORMULA_ID,IIPRD.FORMULA_NAME,IIPRD.CHECK_RECORD  
            from dbo.IMTD_ITEM_PRICE_REBATE_DETAILS IIPRD LEFT JOIN HELPER_TABLE HT on HT.HELPER_TABLE_SID = IIPRD.ITEM_TYPE 
            LEFT JOIN BRAND_MASTER BM on BM.BRAND_MASTER_SID = IIPRD.UDC1
            where USERS_SID=?USERS_SID?         AND SESSION_ID='?SESSION_ID?'         AND OPERATION like '?OPERATION?'           
            ]]>
    </sql>
    <sql id="ad.tempItemSearchCount">
        <![CDATA[
            select count(Distinct IMTD_ITEM_PRICE_REBATE_SID) 
            from dbo.IMTD_ITEM_PRICE_REBATE_DETAILS where USERS_SID=?USERS_SID?         AND SESSION_ID='?SESSION_ID?'         AND OPERATION like '?OPERATION?'           
            ]]>
    </sql>
    <sql id="ad.tempUpdateRecord">
        <![CDATA[
            UPDATE ?TABLE_NAME?
            SET ?SET_COLUMN_NAME?=?SET_VALUE? ?EXTRA_COLUMN?
            WHERE ?COLUMN_NAME1?='?VALUE1?' AND ?COLUMN_NAME2?='?VALUE2?' AND ?COLUMN_NAME3? like '?VALUE3?'
            ]]>
    </sql>
    <sql id="ad.psSearch">
        <![CDATA[
            select distinct PS.PS_MODEL_SID,PS.PS_ID,PS.PS_NO,HT.DESCRIPTION as PS_STATUS,PS.PS_START_DATE,PS.PS_END_DATE,PS.PS_NAME,IFP.IFP_MODEL_SID,
                    IFP.IFP_NAME,HT1.DESCRIPTION as RSTYPE ,HT2.DESCRIPTION as RSCATEGORY ,HT3.DESCRIPTION as Desig from PS_MODEL PS
                    join PS_DETAILS PSD oN PSD.PS_MODEL_SID=PS.PS_MODEL_SID
               AND PS.PS_ID like '?PS_ID?' AND PS.PS_NO like '?PS_NO?' AND PS.PS_NAME like '?PS_NAME?' AND PS.PS_STATUS like '?PS_STATUS?' AND PS.PS_TYPE like '?PS_TYPE?'
            join IFP_MODEL IFP ON IFP.IFP_MODEL_SID=PSD.IFP_MODEL_SID 
                    join HELPER_TABLE HT ON HT.HELPER_TABLE_SID=PS.PS_STATUS
                    join HELPER_TABLE HT1 ON HT1.HELPER_TABLE_SID=PS.PS_TYPE
                    join HELPER_TABLE HT2 ON HT2.HELPER_TABLE_SID=PS.PS_CATEGORY
                    join HELPER_TABLE HT3 ON HT3.HELPER_TABLE_SID=PS.PS_DESIGNATION where PS.INBOUND_STATUS <> 'D'
            ]]>
    </sql>
    <sql id="ad.rsSearch">
        <![CDATA[
            select distinct RS.RS_MODEL_SID,RS.RS_ID,RS.RS_NO,RS.RS_NAME,HT.DESCRIPTION as RS_STATUS,RS.RS_START_DATE,RS.RS_END_DATE ,IFP.IFP_MODEL_SID,IFP.IFP_NAME,RS.REBATE_FREQUENCY,
                    HT1.DESCRIPTION as RARTYPE from RS_MODEL RS
                    join RS_DETAILS RSD oN RSD.RS_MODEL_SID=RS.RS_MODEL_SID 
                    AND RS.RS_ID like '?RS_ID?' AND RS.RS_NO like '?RS_NO?' AND RS.RS_NAME like '?RS_NAME?' AND RS.RS_STATUS like '?RS_STATUS?' AND RS.REBATE_PROGRAM_TYPE like '?RS_TYPE?'
                    join IFP_MODEL IFP ON IFP.IFP_MODEL_SID=RSD.IFP_MODEL_SID 
                    join HELPER_TABLE HT ON HT.HELPER_TABLE_SID=RS.RS_STATUS
                    join HELPER_TABLE HT1 ON HT1.HELPER_TABLE_SID=RS.REBATE_PROGRAM_TYPE
                    where RS.INBOUND_STATUS !='D'
            ]]>
    </sql>
    <sql id="ad.cfpFromResults">
		<![CDATA[
                    SELECT Distinct CFP_CM.COMPANY_NO, CFP_CM.COMPANY_NAME, CFP_CD.COMPANY_START_DATE, CFP_CD.COMPANY_END_DATE, 
                        ST.DESCRIPTION, CFP_CD.TRADE_CLASS, CFP_CD.COMPANY_CFP_ATTACHED_DATE
                    FROM CFP_DETAILS CFP_CD 
                    JOIN COMPANY_MASTER CFP_CM ON CFP_CM.COMPANY_MASTER_SID=CFP_CD.COMPANY_MASTER_SID 
                        AND CFP_CD.CFP_MODEL_SID like '?SID?' AND CFP_CD.INBOUND_STATUS <> 'D'
                    LEFT JOIN HELPER_TABLE ST ON CFP_CD.COMPANY_CFP_ATTACHED_STATUS=ST.HELPER_TABLE_SID
		]]>
    </sql>
    <sql id="ad.ifpFromResults">
		<![CDATA[
                    SELECT Distinct IFP_IM.ITEM_NO, IFP_IM.ITEM_NAME, BND.BRAND_NAME, ST.DESCRIPTION, IFP_IM.ITEM_START_DATE, IFP_IM.ITEM_END_DATE, IFP_CD.ITEM_IFP_ATTACHED_DATE 
                    FROM IFP_DETAILS IFP_CD 
                    JOIN ITEM_MASTER IFP_IM ON IFP_IM.ITEM_MASTER_SID=IFP_CD.ITEM_MASTER_SID  AND IFP_CD.INBOUND_STATUS <> 'D' 
                        AND IFP_CD.IFP_MODEL_SID like '?SID?'
                    JOIN BRAND_MASTER BND ON IFP_IM.BRAND_MASTER_SID=BND.BRAND_MASTER_SID
                    LEFT JOIN HELPER_TABLE ST ON ST.HELPER_TABLE_SID=IFP_CD.ITEM_IFP_ATTACHED_STATUS
		]]>
    </sql>
    <sql id="ad.psFromResults">
		<![CDATA[
                    SELECT Distinct PS_IM.ITEM_NO, PS_IM.ITEM_NAME, BND.BRAND_NAME, ST.DESCRIPTION as Status,PS.PS_START_DATE,PS.PS_END_DATE,PS_TYPE.DESCRIPTION as PSTYPE,PS.PS_NO, PS.PS_NAME,
                    PS_CD.PRICE_PROTECTION_START_DATE,PS_CD.PRICE_PROTECTION_END_DATE, PS_CD.PRICE_TOLERANCE_INTERVAL,FREQ.DESCRIPTION as FREQUENCY, TYP.DESCRIPTION as PTYPE,
                         PS_CD.PRICE_TOLERANCE, PS_CD.ITEM_PS_ATTACHED_DATE 
                    FROM PS_DETAILS PS_CD 
                    JOIN ITEM_MASTER PS_IM ON PS_IM.ITEM_MASTER_SID=PS_CD.ITEM_MASTER_SID  AND PS_CD.INBOUND_STATUS <> 'D' 
                        AND PS_CD.PS_MODEL_SID like '?SID?'
                    JOIN PS_MODEL PS ON PS.PS_MODEL_SID=PS_CD.PS_MODEL_SID
                    LEFT JOIN BRAND_MASTER BND ON PS_IM.BRAND_MASTER_SID=BND.BRAND_MASTER_SID
                    LEFT JOIN HELPER_TABLE ST ON ST.HELPER_TABLE_SID=PS.PS_STATUS
                    LEFT JOIN HELPER_TABLE PS_TYPE ON PS_TYPE.HELPER_TABLE_SID=PS.PS_TYPE
                    LEFT JOIN HELPER_TABLE FREQ ON FREQ.HELPER_TABLE_SID=PS_CD.PRICE_TOLERANCE_FREQUENCY
                    LEFT JOIN HELPER_TABLE TYP ON TYP.HELPER_TABLE_SID=PS_CD.PRICE_TOLERANCE_TYPE
		]]>
    </sql>
    <sql id="ad.rsFromResults">
		<![CDATA[
    SELECT RS_IM.ITEM_NO, RS_IM.ITEM_NAME, BND.BRAND_NAME, ST.DESCRIPTION, RS.RS_START_DATE, RS.RS_END_DATE,RS_CD.FORMULA_ID, 
                        RPM.REBATE_PLAN_ID, RPM.REBATE_PLAN_NAME, RS_CD.REBATE_AMOUNT, RS_CD.BUNDLE_NO, RS_CD.ITEM_RS_ATTACHED_DATE 
                    FROM RS_DETAILS RS_CD 
                    JOIN ITEM_MASTER RS_IM ON RS_IM.ITEM_MASTER_SID=RS_CD.ITEM_MASTER_SID  AND RS_CD.INBOUND_STATUS <> 'D' 
                        AND RS_CD.RS_MODEL_SID like '?SID?'
                    JOIN RS_MODEL RS ON RS.RS_MODEL_SID=RS_CD.RS_MODEL_SID
                    JOIN BRAND_MASTER BND ON RS_IM.BRAND_MASTER_SID=BND.BRAND_MASTER_SID
                    LEFT JOIN HELPER_TABLE ST ON ST.HELPER_TABLE_SID=RS.RS_STATUS
                    LEFT JOIN REBATE_PLAN_MASTER RPM ON RPM.REBATE_PLAN_MASTER_SID=RS_CD.REBATE_PLAN_MASTER_SID
                    ]]>
    </sql>
    <sql id="ad.itemsFromIfp">
		<![CDATA[
    SELECT Distinct IFP_IM.ITEM_MASTER_SID,IFP_IM.ITEM_NO, IFP_IM.ITEM_NAME,ST1.DESCRIPTION, BND.BRAND_NAME,ST.HELPER_TABLE_SID,ST.DESCRIPTION, IFP_IM.ITEM_START_DATE, IFP_IM.ITEM_END_DATE
                    FROM IFP_DETAILS IFP_CD 
                    JOIN ITEM_MASTER IFP_IM ON IFP_IM.ITEM_MASTER_SID=IFP_CD.ITEM_MASTER_SID  AND IFP_CD.INBOUND_STATUS <> 'D' 
                        AND IFP_CD.IFP_MODEL_SID like '?SID?'
                    JOIN BRAND_MASTER BND ON IFP_IM.BRAND_MASTER_SID=BND.BRAND_MASTER_SID
                    JOIN HELPER_TABLE ST1 ON ST1.HELPER_TABLE_SID=IFP_IM.THERAPEUTIC_CLASS
                    LEFT JOIN HELPER_TABLE ST ON ST.HELPER_TABLE_SID=IFP_CD.ITEM_IFP_ATTACHED_STATUS
               ]]>
    </sql>   
    <sql id="ad.tempDataDelete">
		<![CDATA[
                DELETE from ?TABLE_NAME?
            WHERE ?COLUMN_NAME1?='?VALUE1?' AND ?COLUMN_NAME2?='?VALUE2?' AND ?COLUMN_NAME3? like '?VALUE3?'
       ]]>
    </sql>    
    <sql id="ad.tempItemDataInsertFromIFP">
		<![CDATA[
                INSERT into IMTD_ITEM_PRICE_REBATE_DETAILS  (IFP_MODEL_SID,ITEM_MASTER_SID,ITEM_ID,START_DATE,END_DATE,ITEM_NO,ITEM_NAME,ITEM_TYPE,PS_STATUS,PRICE_TYPE,UDC1,CHECK_RECORD,USERS_SID,SESSION_ID,OPERATION) 
			SELECT Distinct IFP_CD.IFP_MODEL_SID,IFP_IM.ITEM_MASTER_SID,IFP_IM.ITEM_ID,IFP_IM.ITEM_START_DATE,IFP_IM.ITEM_END_DATE,IFP_IM.ITEM_NO, IFP_IM.ITEM_NAME,IFP_IM.THERAPEUTIC_CLASS AS THERAPY,IFP_IM.ITEM_STATUS,IFP_IM.ITEM_STATUS AS ITEMSTATUS, BND.BRAND_MASTER_SID,0 as CHECK_RECORD,
            ?USERS_SID? as USERS_SID,
            '?SESSION_ID?' as SESSION_ID,
            '?OPERATION?' as OPERATION
                    FROM ITEM_MASTER IFP_IM 
                    JOIN IFP_DETAILS IFP_CD ON IFP_IM.ITEM_MASTER_SID=IFP_CD.ITEM_MASTER_SID  AND IFP_CD.INBOUND_STATUS !='D' 
                        AND IFP_CD.IFP_MODEL_SID =?IFP_MODEL_SID?
                    JOIN BRAND_MASTER BND ON IFP_IM.BRAND_MASTER_SID=BND.BRAND_MASTER_SID
       ]]>
    </sql>
    <sql id="ad.formulaSearch">
		<![CDATA[
                select FORMULA_DETAILS_MASTER_SID,FORMULA_ID,FORMULA_NO,FORMULA_DESC from FORMULA_DETAILS_MASTER where FORMULA_ID like '?FORMULA_ID?' 
                AND FORMULA_NO like '?FORMULA_NO?' AND FORMULA_DESC like '?FORMULA_DESC?'
       ]]>
    </sql>
    <sql id="ad.formulaSearchCount">
		<![CDATA[
                select count(Distinct FORMULA_DETAILS_MASTER_SID)   from FORMULA_DETAILS_MASTER where FORMULA_ID like '?FORMULA_ID?' 
                AND FORMULA_NO like '?FORMULA_NO?' AND FORMULA_DESC like '?FORMULA_DESC?';
       ]]>
    </sql>
    <sql id="ad.rebateSearch">
		<![CDATA[
                Select REBATE_PLAN_MASTER_SID,REBATE_PLAN_ID,REBATE_PLAN_NO,REBATE_PLAN_NAME,ST.DESCRIPTION,ST1.DESCRIPTION as REBATEPLANTYPE from REBATE_PLAN_MASTER RPM
                JOIN  HELPER_TABLE ST ON ST.HELPER_TABLE_SID=RPM.REBATE_PLAN_STATUS  
                JOIN  HELPER_TABLE ST1 ON ST1.HELPER_TABLE_SID=RPM.REBATE_PLAN_TYPE AND RPM.REBATE_PLAN_ID like '?REBATE_PLAN_ID?'  AND RPM.REBATE_PLAN_NO like '?REBATE_PLAN_NO?'
                AND RPM.REBATE_PLAN_NAME like '?REBATE_PLAN_NAME?' AND RPM.REBATE_PLAN_STATUS like '?REBATE_PLAN_STATUS?' AND RPM.REBATE_PLAN_TYPE like '?REBATE_PLAN_TYPE?'
                ]]>
    </sql>
    <sql id="ad.rebateSearchCount">
		<![CDATA[
                Select count (distinct REBATE_PLAN_MASTER_SID) from REBATE_PLAN_MASTER RPM 
                JOIN  HELPER_TABLE ST ON ST.HELPER_TABLE_SID=RPM.REBATE_PLAN_STATUS  
                JOIN HELPER_TABLE ST1 ON ST1.HELPER_TABLE_SID=RPM.REBATE_PLAN_TYPE AND RPM.REBATE_PLAN_ID like '?REBATE_PLAN_ID?'  AND RPM.REBATE_PLAN_NO like '?REBATE_PLAN_NO?'
                AND RPM.REBATE_PLAN_NAME like '?REBATE_PLAN_NAME?' AND RPM.REBATE_PLAN_STATUS like '?REBATE_PLAN_STATUS?' AND RPM.REBATE_PLAN_TYPE like '?REBATE_PLAN_TYPE?'
                ]]>
    </sql>
    <sql id="ad.insertintoRsDetailsFromTemp">
		<![CDATA[
                    INSERT into RS_DETAILS(RS_MODEL_SID,IFP_MODEL_SID,ITEM_MASTER_SID,ITEM_REBATE_START_DATE,ITEM_REBATE_END_DATE,ITEM_RS_ATTACHED_STATUS,ITEM_RS_ATTACHED_DATE,
                    FORMULA_ID,INBOUND_STATUS,CREATED_BY,CREATED_DATE,MODIFIED_BY,MODIFIED_DATE)
                    Select '?RS_MODEL_SID?' as RSMODELSID,IFP_MODEL_SID,ITEM_MASTER_SID,ITEM_REBATE_START_DATE as ITEMRSSTART_DATE,ITEM_REBATE_END_DATE as ITEMRSEND_DATE,RS_DETAILS_SID,
                    '?ITEM_RS_ATTACHED_DATE?' as ItemAttachDate,FORMULA_ID as FID, 'A' as InboundStatus,'?USERS_SID?' as createdby, '?CREATED_DATE?' as createdDate,'?USERS_SID?' as modifiedBy, 
                    '?MODIFIED_DATE?' as modifiedDate
                    from IMTD_ITEM_PRICE_REBATE_DETAILS where CHECK_RECORD=1 and USERS_SID ='?USERS_SID?' and SESSION_ID='?SESSION_ID?' and OPERATION like '?OPERATION?';
]]>
    </sql>
    <sql id="ad.loadPriceType">
		<![CDATA[
                        Select ITEM_PRICING_QUALIFIER_SID,ITEM_PRICING_QUALIFIER_NAME from Item_Pricing_Qualifier 
                        where ITEM_PRICING_QUALIFIER_NAME <> '' AND ITEM_PRICING_QUALIFIER_NAME <> 'null' order BY ITEM_PRICING_QUALIFIER_NAME;
                ]]>
    </sql>
    <sql id="ad.tempDataInsertForIFP">
		<![CDATA[
                INSERT into IMTD_IFP_DETAILS (ITEM_MASTER_SID,ITEM_NO,ITEM_NAME,ITEM_BRAND,ITEM_STATUS,ITEM_ID,ITEM_THERAPEUTIC_CLASS,
                ITEM_START_DATE,ITEM_END_DATE,CHECK_BOX,USERS_SID,SESSION_ID,OPERATION)
                select Distinct IM.ITEM_MASTER_SID,IM.ITEM_NO,IM.ITEM_NAME,BR.BRAND_NAME,IM.ITEM_STATUS AS ITEMSTATUS,STATUS.DESCRIPTION as STATUS,
                THERAPHY.DESCRIPTION as THERAPHY,IM.ITEM_START_DATE,IM.ITEM_END_DATE,0 as CHECK_BOX,'?USERS_SID?' as USERS_SID,
                '?SESSION_ID?' as SESSION_ID,'?OPERATION?' as OPERATION from ITEM_MASTER IM
                join HELPER_TABLE STATUS on STATUS.HELPER_TABLE_SID=IM.ITEM_STATUS 
                join HELPER_TABLE THERAPHY on THERAPHY.HELPER_TABLE_SID=IM.THERAPEUTIC_CLASS 
                join BRAND_MASTER BR on BR.BRAND_MASTER_SID=IM.BRAND_MASTER_SID
                where IM.INBOUND_STATUS<>'D' AND IM.ITEM_ID like '?ITEM_ID?' AND IM.ITEM_NO like '?ITEM_NO?' AND IM.ITEM_NAME like '?ITEM_NAME?' 
                AND IM.ITEM_STATUS like '?ITEM_STATUS?' AND IM.ITEM_TYPE like '?ITEM_TYPE?' AND IM.BRAND_MASTER_SID like '?BRAND_MASTER_SID?' AND IM.FORM like '?FORM?' 
                AND IM.STRENGTH like '?STRENGTH?'  AND IM.THERAPEUTIC_CLASS like '?THERAPEUTIC_CLASS?';
       ]]>
    </sql>
    <sql id="ad.tempItemSearchForIFP">
        <![CDATA[
            Select ITEM_MASTER_SID,ITEM_NO,ITEM_NAME,ITEM_BRAND,ITEM_STATUS,ITEM_ID as Status,ITEM_THERAPEUTIC_CLASS,ITEM_START_DATE,ITEM_END_DATE,CHECK_BOX,IMTD_IFP_DETAILS_SID 
            from IMTD_IFP_DETAILS where USERS_SID like '?USERS_SID?'     AND SESSION_ID like '?SESSION_ID?' AND OPERATION like '?OPERATION?'          
            ]]>
    </sql>
    <sql id="ad.tempItemSearchCountForIFP">
        <![CDATA[
            Select count (Distinct IMTD_IFP_DETAILS_SID ) 
            from IMTD_IFP_DETAILS where USERS_SID like '?USERS_SID?'     AND SESSION_ID like '?SESSION_ID?' AND OPERATION like '?OPERATION?';
            ]]>
    </sql>
    <sql id="ad.insertintoIFPDetailsFromTemp">
        <![CDATA[
                    INSERT into IFP_DETAILS(IFP_MODEL_SID,ITEM_MASTER_SID,START_DATE,ITEM_IFP_ATTACHED_STATUS,ITEM_IFP_ATTACHED_DATE,
                    INBOUND_STATUS,CREATED_BY,CREATED_DATE,MODIFIED_BY,MODIFIED_DATE)
                    Select '?IFP_MODEL_SID?' as IFPMODELSID,ITEM_MASTER_SID,'?CREATED_DATE?' as STARTDATE,ITEM_STATUS,'?ITEM_IFP_ATTACHED_DATE?','A' as InboundStatus,'?USERS_SID?' as createdby, '?CREATED_DATE?' as createdDate,'?USERS_SID?' as modifiedBy, 
                    '?MODIFIED_DATE?' as modifiedDate
                    from IMTD_IFP_DETAILS where CHECK_BOX=1 AND USERS_SID like '?USERS_SID?' AND SESSION_ID like '?SESSION_ID?' AND OPERATION like '?OPERATION?';
        ]]>
    </sql>
    <sql id="ad.insertintoPsDetailsFromTemp">
		<![CDATA[
                    INSERT into PS_DETAILS(PS_MODEL_SID,IFP_MODEL_SID,ITEM_MASTER_SID,CONTRACT_PRICE_START_DATE,CONTRACT_PRICE_END_DATE,ITEM_PRICING_QUALIFIER_SID,PRICE,
                    ITEM_PS_ATTACHED_STATUS,PRICE_PROTECTION_START_DATE,INBOUND_STATUS,CREATED_BY,CREATED_DATE,MODIFIED_BY,MODIFIED_DATE)
                    Select '?PS_MODEL_SID?' as PSMODELSID,IFP_MODEL_SID,ITEM_MASTER_SID,ITEM_REBATE_START_DATE as START_DATE,ITEM_REBATE_END_DATE as END_DATE,
                    PRICE_TYPE as QUALIFIERID,0 as price,RS_DETAILS_SID,PRICE_PROTECTION_START_DATE,'A' as InboundStatus,'?USERS_SID?' as createdby, '?CREATED_DATE?' as createdDate,'?USERS_SID?' as modifiedBy, 
                    '?MODIFIED_DATE?' as modifiedDate
                    from IMTD_ITEM_PRICE_REBATE_DETAILS where CHECK_RECORD=1 and USERS_SID='?USERS_SID?' and SESSION_ID='?SESSION_ID?' and OPERATION ='?OPERATION?';
    ]]>
    </sql>
    <sql id="ad.tempDataInsertForCFP">
		<![CDATA[
                INSERT into IMTD_CFP_DETAILS (COMPANY_MASTER_SID,COMPANY_NO,COMPANY_NAME,COMPANY_START_DATE,COMPANY_END_DATE,COMPANY_STATUS,COMPANY_ID,CFP_DETAILS_TRADE_CLASS
                 ,CHECK_RECORD,USERS_SID,SESSION_ID,OPERATION)
                 select distinct cm.COMPANY_MASTER_SID,cm.COMPANY_NO,cm.COMPANY_NAME,cm.COMPANY_START_DATE,cm.COMPANY_END_DATE,cm.COMPANY_STATUS,Status.DESCRIPTION,tradeclass.DESCRIPTION  as tradeclassvalue 
                 ,0 as CHECK_RECORD,'?USERS_SID?' as USERS_SID,
                 '?SESSION_ID?' as SESSION_ID,'?OPERATION?' as OPERATION 
                 from  COMPANY_MASTER cm 
                 join HELPER_TABLE Status on Status.HELPER_TABLE_SID=cm.COMPANY_STATUS 
                 join COMPANY_TRADE_CLASS CT on CT.COMPANY_MASTER_SID=cm.COMPANY_MASTER_SID 
                 join HELPER_TABLE tradeclass on tradeclass.HELPER_TABLE_SID=CT.COMPANY_TRADE_CLASS
                 join HELPER_TABLE CATEGORY on CATEGORY.HELPER_TABLE_SID=cm.COMPANY_CATEGORY 
                 where cm.INBOUND_STATUS<>'D'  AND cm.COMPANY_ID like '?COMPANY_ID?' AND cm.COMPANY_NAME like '?COMPANY_NAME?' AND cm.COMPANY_NO like '?COMPANY_NO?'
                 AND cm.COMPANY_STATUS like '?COMPANY_STATUS?' AND cm.COMPANY_TYPE like '?COMPANY_TYPE?' AND cm.COMPANY_CATEGORY like '?COMPANY_CATEGORY?' AND CT.COMPANY_TRADE_CLASS like '?TRADE_CLASS?';
       ]]>
    </sql>
    <sql id="ad.tempCompanySearchForCFP">
        <![CDATA[
            Select COMPANY_MASTER_SID,COMPANY_NO,COMPANY_NAME,COMPANY_START_DATE,COMPANY_END_DATE,COMPANY_ID,CFP_DETAILS_TRADE_CLASS,CHECK_RECORD,IMTD_CFP_DETAILS_SID 
            from IMTD_CFP_DETAILS where USERS_SID like '?USERS_SID?' AND SESSION_ID like '?SESSION_ID?' AND OPERATION like '?OPERATION?'          
            ]]>
    </sql>
    <sql id="ad.tempCompanySearchCountForCFP">
        <![CDATA[
            Select count (Distinct IMTD_CFP_DETAILS_SID ) 
            from IMTD_CFP_DETAILS where USERS_SID like '?USERS_SID?' AND SESSION_ID like '?SESSION_ID?' AND OPERATION like '?OPERATION?';
            ]]>
    </sql>
    <sql id="ad.selectedCompaniesFromSearchTableCount">
        <![CDATA[
            Select count (Distinct IMTD_CFP_DETAILS_SID ) 
            from IMTD_CFP_DETAILS where USERS_SID like '?USERS_SID?' AND SESSION_ID like '?SESSION_ID?' AND OPERATION like '?OPERATION?';
            ]]>
    </sql>
    <sql id="ad.selectedCompaniesFromSearchTable">
        <![CDATA[
            Select COMPANY_MASTER_SID,COMPANY_NO,COMPANY_NAME,COMPANY_STATUS,COMPANY_START_DATE,COMPANY_END_DATE,CHECK_RECORD,IMTD_CFP_DETAILS_SID 
            from IMTD_CFP_DETAILS where USERS_SID like '?USERS_SID?' AND SESSION_ID like '?SESSION_ID?' AND OPERATION like '?OPERATION?'         
            ]]>
    </sql>
    <sql id="ad.selectedItemsFromSearchTableCount">
        <![CDATA[
            Select count (Distinct IMTD_IFP_DETAILS_SID ) 
            from IMTD_IFP_DETAILS where USERS_SID like '?USERS_SID?' AND SESSION_ID like '?SESSION_ID?' AND OPERATION like '?OPERATION?'
            ]]>
    </sql>
    <sql id="ad.selectedItemsFromSearchTable">
        <![CDATA[
            Select ITEM_MASTER_SID,ITEM_NO,ITEM_NAME,ITEM_BRAND,ITEM_STATUS,ITEM_ID as Status,ITEM_THERAPEUTIC_CLASS,ITEM_START_DATE,ITEM_END_DATE,CHECK_BOX,IMTD_IFP_DETAILS_SID 
            from IMTD_IFP_DETAILS where USERS_SID like '?USERS_SID?' AND SESSION_ID like '?SESSION_ID?' AND OPERATION like '?OPERATION?'         
            ]]>
    </sql>
    
    <sql id="ad.updateForSelectedCompanySearchTable">
        <![CDATA[
        Update ?TABLE_NAME? SET OPERATION = '?OPERATION?' where USERS_SID like '?USERS_SID?' AND SESSION_ID like '?SESSION_ID?' AND OPERATION like '?OLD_OPERATION?' AND CHECK_RECORD=1
        ]]>
    </sql>
    <sql id="ad.updateForSelectedItemSearchTable">
        <![CDATA[
        Update ?TABLE_NAME? SET OPERATION = '?OPERATION?' where USERS_SID like '?USERS_SID?' AND SESSION_ID like '?SESSION_ID?' AND OPERATION like '?OLD_OPERATION?' AND CHECK_BOX=1
        ]]>
    </sql>
    <sql id="ad.selectedCompaniesForNewCFP">
        <![CDATA[
        select COMPANY_NO, COMPANY_NAME, COMPANY_STATUS, COMPANY_START_DATE,COMPANY_END_DATE from IMTD_CFP_DETAILS CFP
         where USERS_SID like '?USERS_SID?' AND SESSION_ID like '?SESSION_ID?' AND COMPANY_MASTER_SID in (?COMPANY_MASTER_SIDs?)
        ]]>
    </sql>
    <sql id="ad.selectedItemsForNewIFP">
        <![CDATA[
        select ITEM_NO, ITEM_NAME, ITEM_THERAPEUTIC_CLASS, ITEM_BRAND, ITEM_STATUS, ITEM_START_DATE, ITEM_END_DATE from IMTD_IFP_DETAILS
        where USERS_SID like '?USERS_SID?' AND SESSION_ID like '?SESSION_ID?' AND ITEM_MASTER_SID in (?ITEM_MASTER_SIDs?)
        ]]>
    </sql>
    <sql id="ad.selectedItemsForNewPS_RS">
        <![CDATA[
        select ITEM_NO, ITEM_NAME, ITEM_TYPE , UDC1, PS_STATUS, START_DATE, END_DATE from IMTD_ITEM_PRICE_REBATE_DETAILS
        where USERS_SID like '?USERS_SID?' AND SESSION_ID like '?SESSION_ID?' AND ITEM_MASTER_SID in (?ITEM_MASTER_SIDs?)
        ]]>
    </sql>
    <sql id="ad.insertintoCFPDetailsFromTemp">
        <![CDATA[
                    INSERT into CFP_DETAILS(CFP_MODEL_SID,COMPANY_MASTER_SID,COMPANY_START_DATE,COMPANY_END_DATE,COMPANY_CFP_ATTACHED_STATUS,COMPANY_CFP_ATTACHED_DATE,
                    INBOUND_STATUS,CREATED_BY,CREATED_DATE,MODIFIED_BY,MODIFIED_DATE)
                    Select '?CFP_MODEL_SID?' as CFPMODELSID,COMPANY_MASTER_SID,COMPANY_START_DATE,COMPANY_END_DATE,COMPANY_STATUS,'?COMPANY_CFP_ATTACHED_DATE?','A' as InboundStatus,'?USERS_SID?' as createdby, '?CREATED_DATE?' as createdDate,'?USERS_SID?' as modifiedBy, 
                    '?MODIFIED_DATE?' as modifiedDate
                    from IMTD_CFP_DETAILS where CHECK_RECORD=1 AND USERS_SID like '?USERS_SID?' AND SESSION_ID like '?SESSION_ID?' AND OPERATION like '?OPERATION?';
        ]]>
    </sql>
    <sql id="ad.getBrand">
        <![CDATA[
                    Select BRAND_MASTER_SID,BRAND_NAME FROM BRAND_MASTER where BRAND_NAME <> '';
        ]]>
    </sql>
         
    <sql id="gcm.saveCcp">
		<![CDATA[
                   MERGE PROJECTION_DETAILS AS TARGET
                   USING (SELECT distinct ? PROJECTION_MASTER_SID, CCP1.CCP_DETAILS_SID FROM 
                    (SELECT CCP.CCP_DETAILS_SID
                    FROM RELATIONSHIP_LEVEL_DEFINITION RLD, 
                    CCP_MAP CCP 
                    WHERE RLD.HIERARCHY_NO like '?%' 
                    AND CCP.RELATIONSHIP_LEVEL_SID=RLD.RELATIONSHIP_LEVEL_SID) CCP1, 
                    (SELECT distinct CCPD.CCP_DETAILS_SID 
                    FROM CCP_MAP CCP JOIN RELATIONSHIP_LEVEL_DEFINITION RLD 
                    ON CCP.RELATIONSHIP_LEVEL_SID=RLD.RELATIONSHIP_LEVEL_SID 
                    JOIN PROJECTION_PROD_HIERARCHY PPH 
                    ON PPH.RELATIONSHIP_LEVEL_SID=RLD.RELATIONSHIP_LEVEL_SID AND PPH.PROJECTION_MASTER_SID=?
                    JOIN CCP_DETAILS CCPD ON CCP.CCP_DETAILS_SID=CCPD.CCP_DETAILS_SID) CCP2 
                    WHERE CCP1.CCP_DETAILS_SID=CCP2.CCP_DETAILS_SID) AS SOURCE
                   ON ( TARGET.PROJECTION_MASTER_SID = SOURCE.PROJECTION_MASTER_SID
                   AND TARGET.CCP_DETAILS_SID = SOURCE.CCP_DETAILS_SID)
                   WHEN NOT MATCHED THEN
                   INSERT (PROJECTION_MASTER_SID,CCP_DETAILS_SID)
                   VALUES (SOURCE.PROJECTION_MASTER_SID, SOURCE.CCP_DETAILS_SID); 

                ]]>
    </sql>
    <sql id="rd.insertIntoTempTable">
        <![CDATA[
            INSERT INTO GCM_GLOBAL_DETAILS
                     (SCREEN_NAME,
                      SESSION_ID,
                      USER_ID,
                      CHECK_RECORD,
                                  CONTRACT_MASTER_SID,
                                  CFP_MODEL_SID,
                                  IFP_MODEL_SID,
                                  PS_MODEL_SID,
                                  RS_MODEL_SID)
            VALUES      ('REMOVE_DISCOUNT',
                      '${sessionId}',
                      '${userId}',
                      1,
                                  '${contractSid}',
                                 '${cfpSid}',
                                  '${ifpSid}',
                                  '${psSid}',
                                  '${rsSid}') 
        ]]>
    </sql>
    <sql id="rd.updateTempTable">
        <![CDATA[
            UPDATE GCM_GLOBAL_DETAILS SET CHECK_RECORD = 0
            WHERE SCREEN_NAME = 'REMOVE_DISCOUNT' AND SESSION_ID = '${sessionId}'
            AND USER_ID = '${userId}'
            AND CONTRACT_MASTER_SID = '${contractSid}'
            AND CFP_MODEL_SID = '${cfpSid}'
            AND IFP_MODEL_SID = '${ifpSid}'
            AND PS_MODEL_SID = '${psSid}'
            AND RS_MODEL_SID = '${rsSid}' 
        ]]>
    </sql>
    <sql id="rd.selectedContractCount">
        <![CDATA[
           select count(*) from ( select distinct CM.COMPANY_NAME,CN.CONTRACT_NO,CN.CONTRACT_NAME,HT.DESCRIPTION,CN.START_DATE,CN.END_DATE,CFC.CFP_NAME,IFC.IFP_NAME,PSC.PS_NAME,RSC.RS_NAME,CN.CONTRACT_MASTER_SID,CFC.CFP_MODEL_SID,
            IFC.IFP_MODEL_SID,PSC.PS_MODEL_SID,RSC.RS_CONTRACT_SID,CM.COMPANY_MASTER_SID ,CN.CONTRACT_ID
             from CONTRACT_MASTER CN
             LEFT JOIN dbo.GCM_GLOBAL_DETAILS TEMP on TEMP.CONTRACT_MASTER_SID = CN.CONTRACT_MASTER_SID AND TEMP.CHECK_RECORD = 1 
             LEFT JOIN dbo.RS_CONTRACT RSC ON RSC.RS_CONTRACT_SID = TEMP.RS_MODEL_SID AND RSC.INBOUND_STATUS!='D' 
            LEFT JOIN dbo.IFP_CONTRACT IFC ON IFC.IFP_MODEL_SID = TEMP.IFP_MODEL_SID AND IFC.INBOUND_STATUS!='D'  
             LEFT JOIN dbo.PS_CONTRACT PSC ON PSC.PS_MODEL_SID = TEMP.PS_MODEL_SID AND PSC.INBOUND_STATUS!='D' 
             LEFT JOIN dbo.CFP_CONTRACT CFC ON CFC.CFP_MODEL_SID = TEMP.CFP_MODEL_SID AND CFC.INBOUND_STATUS!='D' 
             LEFT JOIN COMPANY_MASTER CM ON CN.CONT_HOLD_COMPANY_MASTER_SID = CM.COMPANY_MASTER_SID 
            LEFT JOIN HELPER_TABLE HT ON CN.CONTRACT_TYPE = HT.HELPER_TABLE_SID  
             LEFT JOIN HELPER_TABLE HT1
           ON RSC.RS_STATUS = HT1.HELPER_TABLE_SID
           LEFT JOIN HELPER_TABLE HT2
           ON RSC.RS_TYPE = HT2.HELPER_TABLE_SID
           LEFT JOIN DBO.HELPER_TABLE CN_ST 
                ON CN_ST.HELPER_TABLE_SID=CN.CONTRACT_STATUS
                
            WHERE CN.RECORD_LOCK_STATUS='false' AND CN.INBOUND_STATUS!='D' AND TEMP.SCREEN_NAME = 'REMOVE_DISCOUNT' AND TEMP.USER_ID = [$USERID] AND TEMP.SESSION_ID = [$SESSIONID] 
            ?
            @filter@
            GROUP BY CM.COMPANY_NAME,CN.CONTRACT_NO,CN.CONTRACT_NAME,HT.DESCRIPTION,
            CN.START_DATE,CN.END_DATE,
            CFC.CFP_NAME,IFC.IFP_NAME,PSC.PS_NAME,RSC.RS_NAME,
            CN.CONTRACT_MASTER_SID,CFC.CFP_MODEL_SID,
            IFC.IFP_MODEL_SID,PSC.PS_MODEL_SID,
            RSC.RS_CONTRACT_SID,CM.COMPANY_MASTER_SID,CN.CONTRACT_ID ) c
        ]]>
    </sql>
    <sql id="rd.getSelectedContract">
        <![CDATA[
            select distinct CM.COMPANY_NAME,CN.CONTRACT_NO,CN.CONTRACT_NAME,HT.DESCRIPTION,CN.START_DATE,CN.END_DATE,CFC.CFP_NAME,IFC.IFP_NAME,PSC.PS_NAME,RSC.RS_NAME,CN.CONTRACT_MASTER_SID,CFC.CFP_MODEL_SID,
            IFC.IFP_MODEL_SID,PSC.PS_MODEL_SID,RSC.RS_CONTRACT_SID,CM.COMPANY_MASTER_SID ,CN.CONTRACT_ID,CN_ST.DESCRIPTION AS STATUS
             from CONTRACT_MASTER CN
             LEFT JOIN dbo.GCM_GLOBAL_DETAILS TEMP on TEMP.CONTRACT_MASTER_SID = CN.CONTRACT_MASTER_SID AND TEMP.CHECK_RECORD = 1 
             LEFT JOIN dbo.RS_CONTRACT RSC ON RSC.RS_CONTRACT_SID = TEMP.RS_MODEL_SID AND RSC.INBOUND_STATUS!='D' 
            LEFT JOIN dbo.IFP_CONTRACT IFC ON IFC.IFP_MODEL_SID = TEMP.IFP_MODEL_SID AND IFC.INBOUND_STATUS!='D'  
             LEFT JOIN dbo.PS_CONTRACT PSC ON PSC.PS_MODEL_SID = TEMP.PS_MODEL_SID AND PSC.INBOUND_STATUS!='D' 
             LEFT JOIN dbo.CFP_CONTRACT CFC ON CFC.CFP_MODEL_SID = TEMP.CFP_MODEL_SID AND CFC.INBOUND_STATUS!='D' 
             LEFT JOIN COMPANY_MASTER CM ON CN.CONT_HOLD_COMPANY_MASTER_SID = CM.COMPANY_MASTER_SID 
            LEFT JOIN HELPER_TABLE HT ON CN.CONTRACT_TYPE = HT.HELPER_TABLE_SID  
             LEFT JOIN HELPER_TABLE HT1
           ON RSC.RS_STATUS = HT1.HELPER_TABLE_SID
           LEFT JOIN HELPER_TABLE HT2
           ON RSC.RS_TYPE = HT2.HELPER_TABLE_SID
           LEFT JOIN DBO.HELPER_TABLE CN_ST 
                ON CN_ST.HELPER_TABLE_SID=CN.CONTRACT_STATUS
                
            WHERE CN.RECORD_LOCK_STATUS='false' AND CN.INBOUND_STATUS!='D' AND TEMP.SCREEN_NAME = 'REMOVE_DISCOUNT' AND TEMP.USER_ID = [$USERID] AND TEMP.SESSION_ID = [$SESSIONID] 
            ?
            @filter@
            GROUP BY CM.COMPANY_NAME,CN.CONTRACT_NO,CN.CONTRACT_NAME,HT.DESCRIPTION,
            CN.START_DATE,CN.END_DATE,
            CFC.CFP_NAME,IFC.IFP_NAME,PSC.PS_NAME,RSC.RS_NAME,
            CN.CONTRACT_MASTER_SID,CFC.CFP_MODEL_SID,
            IFC.IFP_MODEL_SID,PSC.PS_MODEL_SID,
            RSC.RS_CONTRACT_SID,CM.COMPANY_MASTER_SID,CN.CONTRACT_ID,CN_ST.DESCRIPTION ORDER BY  CN.CONTRACT_MASTER_SID  
        ]]>
    </sql>
    <sql id="rd.cfpFromCDCount">
		<![CDATA[
                SELECT count(*)  
                FROM CFP_CONTRACT_DETAILS CFP_CD 
                JOIN COMPANY_MASTER CFP_CM ON CFP_CM.COMPANY_MASTER_SID=CFP_CD.COMPANY_MASTER_SID AND CFP_CD.CFP_CONTRACT_SID=?SID? AND CFP_CD.INBOUND_STATUS <> 'D' 
                LEFT JOIN HELPER_TABLE ST ON ST.HELPER_TABLE_SID=CFP_CM.COMPANY_STATUS;
		]]>
    </sql>
    
    <sql id="rd.ifpFromCDCount">
		<![CDATA[
                    SELECT count(*) 
                    FROM IFP_CONTRACT_DETAILS IFP_CD 
                    JOIN ITEM_MASTER IFP_IM ON IFP_IM.ITEM_MASTER_SID=IFP_CD.ITEM_MASTER_SID  AND IFP_CD.INBOUND_STATUS <> 'D' 
                        AND IFP_CD.IFP_CONTRACT_SID=?SID?                                                                                
                    JOIN BRAND_MASTER BND ON IFP_IM.BRAND_MASTER_SID=BND.BRAND_MASTER_SID
                    LEFT JOIN HELPER_TABLE ST1 ON ST1.HELPER_TABLE_SID=IFP_IM.ITEM_STATUS
                    LEFT JOIN HELPER_TABLE ST ON ST.HELPER_TABLE_SID=IFP_IM.THERAPEUTIC_CLASS;
		]]>
    </sql>
    
    <sql id="rd.psFromCDCount">
		<![CDATA[
                    SELECT count(*) 
                    FROM PS_CONTRACT_DETAILS PS_CD 
                    JOIN ITEM_MASTER PS_IM ON PS_IM.ITEM_MASTER_SID=PS_CD.ITEM_MASTER_SID  AND PS_CD.INBOUND_STATUS <> 'D' 
                        AND PS_CD.PS_CONTRACT_SID=?SID?
                    LEFT JOIN BRAND_MASTER BND ON PS_IM.BRAND_MASTER_SID=BND.BRAND_MASTER_SID
                    LEFT JOIN HELPER_TABLE ST ON ST.HELPER_TABLE_SID=PS_IM.THERAPEUTIC_CLASS
                    
                    LEFT JOIN HELPER_TABLE ST1 ON ST1.HELPER_TABLE_SID=PS_IM.ITEM_STATUS;
		]]>
    </sql>
    
    <sql id="rd.rsFromCDCount">
		<![CDATA[
                    SELECT count(*) 
                        
                    FROM RS_CONTRACT_DETAILS RS_CD 
                    JOIN ITEM_MASTER RS_IM ON RS_IM.ITEM_MASTER_SID=RS_CD.ITEM_MASTER_SID  AND RS_CD.INBOUND_STATUS <> 'D' 
                        AND RS_CD.RS_CONTRACT_SID=?SID?
                    JOIN BRAND_MASTER BND ON RS_IM.BRAND_MASTER_SID=BND.BRAND_MASTER_SID
                    LEFT JOIN HELPER_TABLE ST ON ST.HELPER_TABLE_SID=RS_IM.THERAPEUTIC_CLASS
                    LEFT JOIN HELPER_TABLE ST1 ON ST1.HELPER_TABLE_SID=RS_IM.ITEM_STATUS;
		]]>
    </sql>
    <sql id="rd.cfpFromCD">
		<![CDATA[
                SELECT Distinct CFP_CM.COMPANY_NO, CFP_CM.COMPANY_NAME, ST.DESCRIPTION,CFP_CD.COMPANY_START_DATE, CFP_CD.COMPANY_END_DATE, CFP_CM.COMPANY_MASTER_SID
                FROM CFP_CONTRACT_DETAILS CFP_CD 
                JOIN COMPANY_MASTER CFP_CM ON CFP_CM.COMPANY_MASTER_SID=CFP_CD.COMPANY_MASTER_SID AND CFP_CD.CFP_CONTRACT_SID=?SID? AND CFP_CD.INBOUND_STATUS <> 'D' 
                LEFT JOIN HELPER_TABLE ST ON ST.HELPER_TABLE_SID=CFP_CM.COMPANY_STATUS 
                ORDER BY CFP_CM.COMPANY_MASTER_SID OFFSET ?start? ROWS FETCH NEXT ?offset? ROWS ONLY;
		]]>
    </sql>
    
    <sql id="rd.ifpFromCD">
		<![CDATA[
                    SELECT IFP_IM.ITEM_NO, IFP_IM.ITEM_NAME,ST.DESCRIPTION as THERAPHY, BND.BRAND_NAME, ST1.DESCRIPTION as STATUS, IFP_CD.ITEM_START_DATE, IFP_CD.ITEM_END_DATE, IFP_IM.ITEM_MASTER_SID 
                    FROM IFP_CONTRACT_DETAILS IFP_CD 
                    JOIN ITEM_MASTER IFP_IM ON IFP_IM.ITEM_MASTER_SID=IFP_CD.ITEM_MASTER_SID  AND IFP_CD.INBOUND_STATUS <> 'D' 
                        AND IFP_CD.IFP_CONTRACT_SID=?SID?                                                                                
                    JOIN BRAND_MASTER BND ON IFP_IM.BRAND_MASTER_SID=BND.BRAND_MASTER_SID
                    LEFT JOIN HELPER_TABLE ST1 ON ST1.HELPER_TABLE_SID=IFP_IM.ITEM_STATUS
                    LEFT JOIN HELPER_TABLE ST ON ST.HELPER_TABLE_SID=IFP_IM.THERAPEUTIC_CLASS
                    ORDER BY IFP_IM.ITEM_MASTER_SID OFFSET ?start? ROWS FETCH NEXT ?offset? ROWS ONLY;
		]]>
    </sql>
    
    <sql id="rd.psFromCD">
		<![CDATA[
                    SELECT PS_IM.ITEM_NO, PS_IM.ITEM_NAME, ST.DESCRIPTION As Theraphy,BND.BRAND_NAME,ST1.DESCRIPTION as Status, PS_CD.CONTRACT_PRICE_START_DATE, PS_CD.CONTRACT_PRICE_END_DATE, PS_IM.ITEM_MASTER_SID
                    FROM PS_CONTRACT_DETAILS PS_CD 
                    JOIN ITEM_MASTER PS_IM ON PS_IM.ITEM_MASTER_SID=PS_CD.ITEM_MASTER_SID  AND PS_CD.INBOUND_STATUS <> 'D' 
                        AND PS_CD.PS_CONTRACT_SID=?SID?
                    LEFT JOIN BRAND_MASTER BND ON PS_IM.BRAND_MASTER_SID=BND.BRAND_MASTER_SID
                    LEFT JOIN HELPER_TABLE ST ON ST.HELPER_TABLE_SID=PS_IM.THERAPEUTIC_CLASS
                    
                    LEFT JOIN HELPER_TABLE ST1 ON ST1.HELPER_TABLE_SID=PS_IM.ITEM_STATUS
                    ORDER BY PS_IM.ITEM_MASTER_SID OFFSET ?start? ROWS FETCH NEXT ?offset? ROWS ONLY;
		]]>
    </sql>
    
    <sql id="rd.rsFromCD">
		<![CDATA[
                    SELECT RS_IM.ITEM_NO, RS_IM.ITEM_NAME, BND.BRAND_NAME,ST.DESCRIPTION As Theraphy, ST1.DESCRIPTION as Status, RS_CD.ITEM_REBATE_START_DATE, RS_CD.ITEM_REBATE_END_DATE, RS_IM.ITEM_MASTER_SID 
                        
                    FROM RS_CONTRACT_DETAILS RS_CD 
                    JOIN ITEM_MASTER RS_IM ON RS_IM.ITEM_MASTER_SID=RS_CD.ITEM_MASTER_SID  AND RS_CD.INBOUND_STATUS <> 'D' 
                        AND RS_CD.RS_CONTRACT_SID=?SID?
                    JOIN BRAND_MASTER BND ON RS_IM.BRAND_MASTER_SID=BND.BRAND_MASTER_SID
                    LEFT JOIN HELPER_TABLE ST ON ST.HELPER_TABLE_SID=RS_IM.THERAPEUTIC_CLASS
                    LEFT JOIN HELPER_TABLE ST1 ON ST1.HELPER_TABLE_SID=RS_IM.ITEM_STATUS
                    ORDER BY RS_IM.ITEM_MASTER_SID OFFSET ?start? ROWS FETCH NEXT ?offset? ROWS ONLY;
		]]>
    </sql>
    <sql id="rebateSub">
        <![CDATA[
             AND RSC.RS_ID LIKE '?'
    AND RSC.RS_NO LIKE '?'
    AND RSC.RS_NAME LIKE '?'
    AND HT1.DESCRIPTION LIKE '?'
    AND HT2.DESCRIPTION LIKE '?'
        ]]>
    </sql>
    <sql id="Load Contract Status">
		<![CDATA[
         SELECT DISTINCT HT.HELPER_TABLE_SID,HT.DESCRIPTION
FROM   CONTRACT_MASTER CONT
       JOIN HELPER_TABLE HT
         ON CONT.CONTRACT_STATUS = HT.HELPER_TABLE_SID
         AND HT.DESCRIPTION like '?' 
ORDER BY HT.HELPER_TABLE_SID OFFSET ? ROWS FETCH NEXT ? ROWS ONLY;  

		]]>
    </sql>
    <sql id="Load Contract Status Count">
		<![CDATA[
         SELECT COUNT( DISTINCT HT.HELPER_TABLE_SID)
FROM   CONTRACT_MASTER CONT
       JOIN HELPER_TABLE HT
         ON CONT.CONTRACT_STATUS = HT.HELPER_TABLE_SID
AND HT.DESCRIPTION like '?' ;


		]]>
    </sql>
    <sql id="getItemForIFPInNewDiscount">
	<![CDATA[
            SELECT ITEM_MASTER_SID FROM IMTD_IFP_DETAILS WHERE USERS_SID = '?' and SESSION_ID = '?' and CHECK_BOX = 1;
	]]>
    </sql>
    <sql id="getItemForPsInNewDiscount">
	<![CDATA[
            SELECT ITEM_MASTER_SID FROM IMTD_ITEM_PRICE_REBATE_DETAILS WHERE USERS_SID = '?' and SESSION_ID = '?' and CHECK_RECORD = 1 and OPERATION = 'PS_IFP_FOR_ADD_DISCOUNT';
	]]>
    </sql>
    <sql id="getItemForRsInNewDiscount">
	<![CDATA[
            SELECT ITEM_MASTER_SID FROM IMTD_ITEM_PRICE_REBATE_DETAILS WHERE USERS_SID = '?' and SESSION_ID = '?' and CHECK_RECORD = 1 and OPERATION = 'RS_IFP_FOR_ADD_DISCOUNT';
	]]>
    </sql>
</custom-sql>