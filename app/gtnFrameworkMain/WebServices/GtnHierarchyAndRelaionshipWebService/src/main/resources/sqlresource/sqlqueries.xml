<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">

<properties>

	<entry key="loadHierarchyAndRelationshipResults">
		<![CDATA[
			SELECT
				HD.HIERARCHY_NAME,
				A.LEVEL_NO AS HIGH_LEVEL,
				B.LEVEL_NO AS LOW_LEVEL,
				HD.CREATED_DATE,
				HD.MODIFIED_DATE,
				A.LEVEL_NAME,
				HD.VERSION_NO AS HIERARCHY_VERSION,
				HD.HIERARCHY_DEFINITION_SID,
				HT.DESCRIPTION AS HIERARCHY_CATEGORY,
				HELPER_TABLE.DESCRIPTION AS HIERARCHY_TYPE,
				HLD.LEVEL_NAME AS LEVEL_VALUE,
				HLD.HIERARCHY_LEVEL_DEFINITION_SID,
				HLD.LEVEL_NO,
				RB.RELATIONSHIP_BUILDER_SID,
				RB.RELATIONSHIP_NAME,
				RB.VERSION_NO
			FROM
				HIERARCHY_LEVEL_DEFINITION A,
				HIERARCHY_LEVEL_DEFINITION B,
				dbo.HIERARCHY_DEFINITION HD
			LEFT JOIN RELATIONSHIP_BUILDER RB ON
				RB.HIERARCHY_DEFINITION_SID = HD.HIERARCHY_DEFINITION_SID
				AND RB.HIERARCHY_VERSION = HD.VERSION_NO
			JOIN dbo.HIERARCHY_LEVEL_DEFINITION HLD ON
				HLD.HIERARCHY_DEFINITION_SID = HD.HIERARCHY_DEFINITION_SID
				AND HLD.VERSION_NO = HD.VERSION_NO
			JOIN dbo.HELPER_TABLE HT ON
				HD.HIERARCHY_CATEGORY = HT.HELPER_TABLE_SID
			JOIN dbo.HELPER_TABLE HELPER_TABLE ON
				HD.HIERARCHY_TYPE = HELPER_TABLE.HELPER_TABLE_SID
			WHERE
				A.HIERARCHY_DEFINITION_SID = B.HIERARCHY_DEFINITION_SID
				AND B.HIERARCHY_DEFINITION_SID = HD.HIERARCHY_DEFINITION_SID
				AND A.LEVEL_NO IN(
					SELECT
						MAX( H.LEVEL_NO )
					FROM
						dbo.HIERARCHY_LEVEL_DEFINITION H
					WHERE
						H.HIERARCHY_DEFINITION_SID = A.HIERARCHY_DEFINITION_SID
				)
				AND B.LEVEL_NO IN(
					SELECT
						MIN( H.LEVEL_NO )
					FROM
						dbo.HIERARCHY_LEVEL_DEFINITION H
					WHERE
						H.HIERARCHY_DEFINITION_SID = HD.HIERARCHY_DEFINITION_SID
				)
			ORDER BY
				HD.HIERARCHY_DEFINITION_SID,
				RB.RELATIONSHIP_BUILDER_SID,
				HLD.LEVEL_NO
		]]>
	</entry>
	<entry key="RelationShipUserDefinedLoading">
        <![CDATA[            
			SELECT
				RELATIONSHIP_LEVEL_DEFINITION.HIERARCHY_NO,
				HIERARCHY_LEVEL_VALUES.LEVEL_VALUES
			from
				dbo.RELATIONSHIP_LEVEL_DEFINITION as RELATIONSHIP_LEVEL_DEFINITION
			JOIN dbo.HIERARCHY_LEVEL_VALUES as HIERARCHY_LEVEL_VALUES on
				HIERARCHY_LEVEL_VALUES.HIERARCHY_LEVEL_DEFINITION_SID = RELATIONSHIP_LEVEL_DEFINITION.HIERARCHY_LEVEL_DEFINITION_SID
				and HIERARCHY_LEVEL_VALUES.HIERARCHY_LEVEL_VALUES_SID = RELATIONSHIP_LEVEL_DEFINITION.RELATIONSHIP_LEVEL_VALUES
			where
				RELATIONSHIP_BUILDER_SID = ?
				and RELATIONSHIP_LEVEL_DEFINITION.VERSION_NO = ? 
         ]]>
	</entry>
	<entry key="getHierarchyLevelVlaues">
        <![CDATA[            
				SELECT
					distinct LEVEL_NO,
					LEVEL_VALUE_REFERENCE,
					"TABLE_NAME",
					FIELD_NAME,
					LEVEL_NAME,
					HLD.HIERARCHY_LEVEL_DEFINITION_SID,
					HLD.HIERARCHY_DEFINITION_SID,
					HT.DESCRIPTION
				from
					HIERARCHY_LEVEL_DEFINITION HLD
				JOIN dbo.HIERARCHY_DEFINITION HD on
					HD.HIERARCHY_DEFINITION_SID = hld.HIERARCHY_DEFINITION_SID
				JOIN dbo.HELPER_TABLE HT on
					HT.HELPER_TABLE_SID = HD.HIERARCHY_CATEGORY
				where
					hld.HIERARCHY_DEFINITION_SID =? and HLD.VERSION_NO =?;
         ]]>
	</entry>
	<entry key="hierarchyByidandVersionNo">
        <![CDATA[            
		select
				*
			from
				(
					SELECT
						HLD.HIERARCHY_LEVEL_DEFINITION_SID,
						HIERARCHY_DEFINITION_SID,
						LEVEL_NAME,
						LEVEL_VALUE_REFERENCE,
						LEVEL_NO,
						TABLE_NAME,
						FIELD_NAME,
						HLD.VERSION_NO,
						CASE
							WHEN HLD.LEVEL_VALUE_REFERENCE = 'User Defined' THEN HLV.HIERARCHY_LEVEL_VALUES_SID
							ELSE 0
						END as LEVELVALUEs,
						ROW_NUMBER() over(
							PARTITION by HLD.LEVEL_NAME
						ORDER by
							HLD.LEVEL_NO ASC
						) as rowNo
					from
						HIERARCHY_LEVEL_DEFINITION HLD
					LEFT JOIN dbo.HIERARCHY_LEVEL_VALUES HLV on
						HLD.HIERARCHY_LEVEL_DEFINITION_SID = HLV.HIERARCHY_LEVEL_DEFINITION_SID
					where
						HLD.HIERARCHY_DEFINITION_SID = ?
						and HLD.VERSION_NO = ?
				) a
			where
				rowNo = 1
			order by
				LEVEL_NO;
         ]]>
	</entry>

</properties>