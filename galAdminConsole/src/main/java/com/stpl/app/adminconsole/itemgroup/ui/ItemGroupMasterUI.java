/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */
package com.stpl.app.adminconsole.itemgroup.ui;

import com.stpl.app.adminconsole.common.dto.SessionDTO;
import com.stpl.app.adminconsole.common.util.CommonUIUtil;
import org.jboss.logging.Logger;

import com.stpl.app.adminconsole.itemgroup.ui.view.ItemGroupSearchMain;
import com.stpl.app.adminconsole.itemgroup.ui.view.ItemGroupView;
import com.stpl.app.adminconsole.util.AbstractNotificationUtils;
import com.stpl.app.adminconsole.util.ConstantsUtils;
import com.stpl.app.adminconsole.util.ErrorCodeUtil;
import com.stpl.app.adminconsole.util.ErrorCodes;
import com.stpl.portal.kernel.exception.PortalException;
import com.stpl.portal.kernel.exception.SystemException;
import com.vaadin.annotations.AutoGenerated;
import com.vaadin.navigator.Navigator;
import com.vaadin.server.VaadinRequest;
import com.vaadin.server.VaadinSession;
import com.vaadin.ui.UI;

/**
 * The Class ItemGroupMasterUI.
 *
 * @author Nandha kumar
 */
public class ItemGroupMasterUI extends UI {

    @AutoGenerated
    private Navigator navigator;

    private static final Logger LOGGER = Logger.getLogger(ItemGroupMasterUI.class);

    SessionDTO sessionDTO = new SessionDTO();

    /*
     * (non-Javadoc)
     * 
     * @see com.vaadin.ui.UI#init(com.vaadin.server.VaadinRequest)
     */
    /**
     * Adds the screen contents and configures all the components
     */
    @Override
    public void init(final VaadinRequest request) {
        LOGGER.info("init method started");
        try {
            CommonUIUtil.beforeUnloadCloseUi(this, sessionDTO);
            setId("ITEM");
            addStyleName("bootstrap");
            addStyleName("bootstrap-bb");
            addStyleName("bootstrap-admin");
            final String userId = request.getRemoteUser();
            final String sessionId = request.getWrappedSession().getId();
            sessionDTO.setSessionId(sessionId);
            sessionDTO.setUserId(userId);
            VaadinSession.getCurrent().setAttribute(ConstantsUtils.FROM_VIEW_PAGE, ConstantsUtils.OPTION_NO);
            VaadinSession.getCurrent().setAttribute(ConstantsUtils.SYS_ID, 0);
            navigator = new Navigator(this, this);
            navigator.addView(ItemGroupSearchMain.NAME, new ItemGroupSearchMain(sessionDTO));
            navigator.addView(ItemGroupView.NAME, new ItemGroupView(sessionDTO));
            navigator.setErrorView(new ItemGroupSearchMain(sessionDTO));
        } catch (SystemException e) {
            final String errorMsg = ErrorCodeUtil.getErrorMessage(e);
            LOGGER.error(e);
            AbstractNotificationUtils.getErrorNotification(ErrorCodeUtil.getEC(ErrorCodes.ERROR_CODE_1001), errorMsg);
        } catch (PortalException e) {
            LOGGER.error(e);
            AbstractNotificationUtils.getErrorNotification(ErrorCodeUtil.getEC(ErrorCodes.ERROR_CODE_1001), ErrorCodeUtil.getEC(ErrorCodes.ERROR_CODE_4011));
        } catch (Exception e) {
            LOGGER.error(e);
            AbstractNotificationUtils.getErrorNotification(ErrorCodeUtil.getEC(ErrorCodes.ERROR_CODE_1001), ErrorCodeUtil.getEC(ErrorCodes.ERROR_CODE_4011));
        }
        LOGGER.info("init method Ended");
    }

    public Navigator getNavigator() {
        return navigator;
    }

    public void setNavigator(final Navigator navigator) {
        this.navigator = navigator;
    }
}
