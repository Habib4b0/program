<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">

<properties>

    <entry key="privatePublic">
		<![CDATA[
                       SELECT FVM.VIEW_NAME viewName,PM.PROJECTION_DESCRIPTION description,
                       'Q' + CAST(CEILING(CAST(month(PM.FROM_DATE) AS decimal(4,2)) / 3) AS char(1))+'-'+ CAST(year(PM.FROM_DATE) AS char(4))fromDate, 
                       'Q' + CAST(CEILING(CAST(month(PM.TO_DATE) AS decimal(4,2)) / 3) AS char(1))+'-'+ CAST(year(PM.TO_DATE) AS char(4)) toDate,
                       CUST_HD.HIERARCHY_NAME customerHierarchy,PM.CUSTOMER_HIERARCHY_LEVEL customerLevel,
                       CMG.COMPANY_GROUP_NAME customerGroup,CM.COMPANY_NAME company,
                       CASE 
                       when PM.BRAND_TYPE=1 then
                       'Contracted'
                       ELSE
                       'All Branded' END
                       brandType,
                       PROD_HD.HIERARCHY_NAME productHierarchy,PM.PRODUCT_HIERARCHY_LEVEL productLevel,IG.ITEM_GROUP_NAME productGroup,
                       format(PM.CREATED_DATE,'MM/dd/yyyy hh:mm:ss' ) createdDate,CAST(PM.MODIFIED_DATE AS DATE) modifiedDate,PM.CREATED_BY createdBy, CM1.COMPANY_NAME AS  BUSINESSUNITNAME,PM.PROJECTION_MASTER_SID projectionId, FVM.VIEW_ID viewId, PM.CUSTOMER_HIERARCHY_SID customerHierarchySid,
                       PM.PRODUCT_HIERARCHY_SID productHierarchySid, PM.COMPANY_GROUP_SID companyGroupSid, PM.ITEM_GROUP_SID productGroupSid, PM.COMPANY_MASTER_SID companyMasterSid,  
                       PM.CUSTOMER_HIERARCHY_INNER_LEVEL customerInnerLevel,PM.PRODUCT_HIERARCHY_INNER_LEVEL productInnerLevel, PM.CUST_RELATIONSHIP_BUILDER_SID custRelationshipBuilderSid, PM.PROD_RELATIONSHIP_BUILDER_SID prodRelationshipBuilderSid,PM.BUSINESS_UNIT AS BUSINESSUNIT,             
                       PM.CUSTOMER_HIER_VERSION_NO custHierarchyVersion, PM.PRODUCT_HIER_VERSION_NO prodHierarchyVersion,PM.CUSTOM_VIEW_MASTER_SID CUSTOM_VIEW_MASTER_SID,PM.CUSTOM_VIEW_MASTER_DEDUCTION_SID CUSTOM_VIEW_MASTER_DEDUCTION_SID,  
                       PM.PROJECTION_NAME projectionName
                       from PROJECTION_MASTER PM 
                        
                        LEFT JOIN FORECASTING_VIEW_MASTER FVM 
                        on FVM.projection_Id  = PM.projection_Master_Sid 

                        LEFT JOIN HIERARCHY_DEFINITION CUST_HD 
                        on CUST_HD.HIERARCHY_DEFINITION_SID =PM.CUSTOMER_HIERARCHY_SID 

                        LEFT JOIN HIERARCHY_DEFINITION PROD_HD 
                        on PROD_HD.HIERARCHY_DEFINITION_SID = PM.PRODUCT_HIERARCHY_SID 

                        LEFT JOIN COMPANY_GROUP CMG 
                        on CMG.COMPANY_GROUP_SID  = PM.COMPANY_GROUP_SID

                        LEFT JOIN ITEM_GROUP IG 
                        on IG.ITEM_GROUP_SID  = PM.ITEM_GROUP_SID

                        LEFT JOIN COMPANY_MASTER CM 
                        on PM.COMPANY_MASTER_SID = CM.COMPANY_MASTER_SID 
                        
                        LEFT JOIN COMPANY_MASTER CM1
                        on PM.BUSINESS_UNIT = CM1.COMPANY_MASTER_SID 

                        WHERE  FVM.view_Type=? AND  FVM.view_Name LIKE ?
                        AND PM.forecasting_Type =?
		]]>
    </entry>
    <entry key="businessUnits">
       
    		<![CDATA[
                    SELECT
                            CM.COMPANY_MASTER_SID,
                            CM.COMPANY_ID,
                            CM.COMPANY_NO,
                            CM.COMPANY_NAME
                    FROM
                            COMPANY_MASTER CM
                    JOIN HELPER_TABLE HT ON
                            HT.HELPER_TABLE_SID = CM.COMPANY_TYPE
                    WHERE
                            HT.LIST_NAME LIKE 'COMPANY_TYPE'
                            AND HT.DESCRIPTION LIKE 'BUSINESS UNIT'
                            AND CM.INBOUND_STATUS <> 'D'
                    ORDER BY COMPANY_NO;
		]]>
      
    </entry>
    <entry key="companies">
      
            <![CDATA[
                SELECT
                        CM.COMPANY_MASTER_SID,
                        CM.COMPANY_ID,
                        CM.COMPANY_NO,
                        CM.COMPANY_NAME
                FROM
                        COMPANY_MASTER CM
                JOIN HELPER_TABLE HT ON
                        HT.HELPER_TABLE_SID = CM.COMPANY_TYPE
                WHERE
                        HT.LIST_NAME LIKE 'COMPANY_TYPE'
                        AND HT.DESCRIPTION LIKE 'GLCOMP'
                        AND CM.INBOUND_STATUS <> 'D'
                ORDER BY COMPANY_NO;
            ]]>
    
    </entry>
    <entry key="dataSelectionDeduction">

            <![CDATA[            
                  SELECT
	distinct LEVEL_NO,
	LEVEL_NAME
        FROM
	HIERARCHY_DEFINITION HD
	JOIN dbo.HIERARCHY_LEVEL_DEFINITION HLD
        ON HLD.HIERARCHY_DEFINITION_SID = HD.HIERARCHY_DEFINITION_SID
        WHERE HD.HIERARCHY_NAME='DeductionHierarchy'
            ]]>

    </entry>
     <entry key="frequency">

            <![CDATA[            
                 SELECT HELPER_TABLE_SID,DESCRIPTION from HELPER_TABLE where LIST_NAME LIKE 'FORECAST_FREQUENCY' AND DESCRIPTION NOT LIKE '%LY%' ORDER BY HELPER_TABLE_SID
            ]]>

    </entry>
    <entry key="saveview">

            <![CDATA[            
                 INSERT
			INTO
				FORECASTING_VIEWS(
					VIEW_NAME,
					VIEW_TYPE,
					CREATED_BY,
					CREATED_DATE,
					MODIFIED_BY,
					MODIFIED_DATE,
					VIEW_DATA,
					
				)
			VALUES(
				?,
				?,
				?,
				getDate(),
				?,
				getDate(),
				?
				
			);
            ]]>

    </entry>
    <entry key="projectionSearch">

            <![CDATA[            
                    SELECT  PM.PROJECTION_NAME projectionName, PM.PROJECTION_DESCRIPTION description , 
                    HDC.HIERARCHY_NAME customerHierarchy, PM.CUSTOMER_HIERARCHY_LEVEL customerHierarchyLevel,  
                    HDP.HIERARCHY_NAME productHierarchy, PM.PRODUCT_HIERARCHY_LEVEL productHierarchyLevel, PM.CREATED_BY createdBy,FORMAT(CONVERT(date,PM.CREATED_DATE),'dd/MM/yyyy') createdDate, FORMAT(CONVERT(date,PM.MODIFIED_DATE),'dd/MM/yyyy') modifiedBy,
                    CM.COMPANY_NAME company,CM1.COMPANY_NAME AS  BUSINESSUNITNAME,
                    PM.CUSTOM_VIEW_MASTER_SID viewSid , PM.PROJECTION_MASTER_SID projectionId,HDC.HIERARCHY_DEFINITION_SID customerHierSid,HDP.HIERARCHY_DEFINITION_SID prodHierSid,
                    PM.COMPANY_MASTER_SID companySid, 
                    PM.COMPANY_GROUP_SID customerGrpSid,  CG.COMPANY_GROUP_NAME customerGroup, PM.ITEM_GROUP_SID prodGrpSid, IG.ITEM_GROUP_NAME productGroup, PM.CUSTOMER_HIERARCHY_INNER_LEVEL customerHierarchyInnerLevel,
                    PM.PRODUCT_HIERARCHY_INNER_LEVEL productHierarchyInnerLevel, PM.CUST_RELATIONSHIP_BUILDER_SID custRelationshipBuilderSid, PM.PROD_RELATIONSHIP_BUILDER_SID prodRelationshipBuilderSid,PM.DISCOUNT_TYPE discountType,
                    PM.BUSINESS_UNIT AS BUSINESSUNIT,PM.from_Date FromDate,PM.TO_DATE ToPeriod,PROJECTION_CUST_VERSION,PROJECTION_PROD_VERSION,	PM.CUSTOMER_HIER_VERSION_NO,PM.PRODUCT_HIER_VERSION_NO,PM.FORECAST_ELIGIBLE_DATE,PROJECTION_DED_VERSION
                    FROM PROJECTION_MASTER PM
                    JOIN HIERARCHY_DEFINITION HDC
                    ON HDC.HIERARCHY_DEFINITION_SID = PM.CUSTOMER_HIERARCHY_SID 
                    JOIN HIERARCHY_DEFINITION HDP
                    ON HDP.HIERARCHY_DEFINITION_SID = PM.PRODUCT_HIERARCHY_SID 
                    JOIN COMPANY_MASTER CM 
                    on PM.COMPANY_MASTER_SID = CM.COMPANY_MASTER_SID   
                    JOIN COMPANY_MASTER CM1
                    on PM.BUSINESS_UNIT = CM1.COMPANY_MASTER_SID 
                    LEFT JOIN COMPANY_GROUP CG
                    ON CG.COMPANY_GROUP_SID  = PM.COMPANY_GROUP_SID 
                    LEFT JOIN ITEM_GROUP IG 
                    ON IG.ITEM_GROUP_SID = PM.ITEM_GROUP_SID
                    where PM.projection_Name like ? and PM.projection_description like ?
            ]]>

    </entry>
 
    <entry key="projectionSearchCount">

            <![CDATA[            
                     SELECT COUNT(DISTINCT PM.PROJECTION_MASTER_SID) projectionId
                    
                    From PROJECTION_MASTER PM
                  
                    JOIN HIERARCHY_DEFINITION HDP
                    ON HDP.HIERARCHY_DEFINITION_SID = PM.PRODUCT_HIERARCHY_SID 

                    LEFT JOIN COMPANY_GROUP CG
                    ON CG.COMPANY_GROUP_SID  = PM.COMPANY_GROUP_SID 

                    LEFT JOIN ITEM_GROUP IG 
                    ON IG.ITEM_GROUP_SID = PM.ITEM_GROUP_SID 
                                        JOIN COMPANY_MASTER CM 
                    on PM.COMPANY_MASTER_SID = CM.COMPANY_MASTER_SID 
                        
                    JOIN COMPANY_MASTER CM1
                     on PM.BUSINESS_UNIT = CM1.COMPANY_MASTER_SID 
                     where PM.projection_Name like ? and PM.projection_description like ?
            ]]>

    </entry>
    



</properties>