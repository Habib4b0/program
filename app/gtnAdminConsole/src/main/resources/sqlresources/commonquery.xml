<?xml version="1.0" encoding="UTF-8"?>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->

<sql>
    <entity id="get-companies">
        <query>
            <![CDATA[
                SELECT
                    CM.COMPANY_MASTER_SID, 
                    CM.COMPANY_ID, 
                    CM.COMPANY_NO, 
                    CM.COMPANY_NAME 
                FROM
                    COMPANY_MASTER CM 
                JOIN HELPER_TABLE HT ON 
                    HT.HELPER_TABLE_SID = CM.COMPANY_TYPE 
                WHERE 
                    HT.LIST_NAME LIKE 'COMPANY_TYPE' 
                    AND HT.DESCRIPTION LIKE 'GLCOMP' 
                    AND CM.INBOUND_STATUS <> 'D' 
                    AND CM.COMPANY_MASTER_SID = @GLCOMP 
                ORDER BY COMPANY_NO;
        ]]>
        </query>
    </entity>
    
    
    <entity id="ex-factory-search-query">
        <query>
            <![CDATA[
                    SELECT FORECAST_NAME,
                           FORECAST_VER,
                           "SOURCE",
                           COUNTRY,
                           FT_MIN_DATE,
                           FT_MAX_DATE,
                           Month(FT_MIN_DATE) AS MIN_MONTH,
                           Year(FT_MIN_DATE)  AS MIN_YEAR,
                           MAX_MONTH,
                           MAX_YEAR,
                           BUSINESS_UNIT,
                           COMPANY_MASTER_SID
                    FROM   (SELECT FM.FORECAST_NAME,
                                   FM.FORECAST_VER,
                                   FM."SOURCE",
                                   FM.COUNTRY,
                                   FM.BUSINESS_UNIT,
                                   CM.COMPANY_MASTER_SID,
                                   Min(CASE
                                         WHEN FORECAST_VER = Floor(FM.FORECAST_VER) THEN Min(Datefromparts(FORECAST_YEAR , FORECAST_MONTH ,1 ))
                                       END)
                                     OVER(
                                       partition BY FORECAST_NAME)                            FT_MIN_DATE,
                                   Max(Datefromparts(fm.FORECAST_YEAR, fm.FORECAST_MONTH, 1)) AS FT_MAX_DATE,
                                   Max(Cast(fm.FORECAST_MONTH AS INT))                        AS MAX_MONTH,
                                   Max(Cast(fm.FORECAST_YEAR AS INT))                         AS MAX_YEAR
                            FROM   FORECASTING_MASTER FM
                                    JOIN ITEM_MASTER IM
                                        ON IM.ITEM_ID = FM.NDC
                                    AND IM.INBOUND_STATUS <> 'D' 
                                    JOIN GL_COST_CENTER_MASTER GLC
                                        ON IM.NDC8 = GLC.NDC8
                                    AND GLC.INBOUND_STATUS <> 'D' 
                                    JOIN COMPANY_MASTER CM
                                        ON CM.COMPANY_ID = GLC.COMPANY_CODE
                                    AND CM.INBOUND_STATUS <> 'D'
                                    AND CM.COMPANY_MASTER_SID = [?COMPANY_MASTER_SID]
                            WHERE  FM.[SOURCE] IN( [?SOURCE] )
                                   AND FM.COUNTRY = '[?COUNTRY]'
                                   AND FM.BUSINESS_UNIT = [?BUSINESS_UNIT]
                                   AND FM.FORECAST_VER LIKE '%'
                                   [?CONDITION]
                            GROUP  BY FM.FORECAST_NAME,
                                      FM.FORECAST_VER,
                                      FM.SOURCE,
                                      FM.COUNTRY,
                                      FM.BUSINESS_UNIT,
                                      CM.COMPANY_MASTER_SID) A
                                      @DATEQUERY
                    ORDER BY [?ORDER_BY_COLUMN] 
                    OFFSET [?START] ROWS FETCH NEXT [?END] ROWS ONLY;
     ]]>
        </query>
    </entity>
    
    <entity id="ex-factory-count-query">
        <query>
            <![CDATA[
                    SELECT COUNT(*)
                    FROM   (SELECT FM.FORECAST_NAME,
                                   FM.FORECAST_VER,
                                   FM."SOURCE",
                                   FM.COUNTRY,
                                   FM.BUSINESS_UNIT,
                                   CM.COMPANY_MASTER_SID,
                                   Min(CASE
                                         WHEN FORECAST_VER = Floor(FM.FORECAST_VER) THEN Min(Datefromparts(FORECAST_YEAR , FORECAST_MONTH ,1 ))
                                       END)
                                     OVER(
                                       partition BY FORECAST_NAME)                            FT_MIN_DATE,
                                   Max(Datefromparts(fm.FORECAST_YEAR, fm.FORECAST_MONTH, 1)) AS FT_MAX_DATE,
                                   Max(Cast(fm.FORECAST_MONTH AS INT))                        AS MAX_MONTH,
                                   Max(Cast(fm.FORECAST_YEAR AS INT))                         AS MAX_YEAR
                            FROM   FORECASTING_MASTER FM
                                    JOIN ITEM_MASTER IM
                                        ON IM.ITEM_ID = FM.NDC
                                    AND IM.INBOUND_STATUS <> 'D' 
                                    JOIN GL_COST_CENTER_MASTER GLC
                                        ON IM.NDC8 = GLC.NDC8
                                    AND GLC.INBOUND_STATUS <> 'D' 
                                    JOIN COMPANY_MASTER CM
                                        ON CM.COMPANY_ID = GLC.COMPANY_CODE
                                    AND CM.INBOUND_STATUS <> 'D'
                                    AND CM.COMPANY_MASTER_SID = [?COMPANY_MASTER_SID]
                            WHERE  FM.[SOURCE] IN( [?SOURCE] )
                                   AND FM.COUNTRY = '[?COUNTRY]'
                                   AND FM.BUSINESS_UNIT = [?BUSINESS_UNIT]
                                   AND FM.FORECAST_VER LIKE '%'
                                   [?CONDITION]
                            GROUP  BY FM.FORECAST_NAME,
                                      FM.FORECAST_VER,
                                      FM.SOURCE,
                                      FM.COUNTRY,
                                      FM.BUSINESS_UNIT,
                                      CM.COMPANY_MASTER_SID) A
                                      @DATEQUERY;  
                                      
     ]]>
        </query>
    </entity>
    
    <entity id="demand-search-query">
        <query>
            <![CDATA[
    
                SELECT FORECAST_NAME,
                   FORECAST_VER,
                   "SOURCE",
                   COUNTRY,
                   FT_MIN_DATE,
                   FT_MAX_DATE,
                   Month(FT_MIN_DATE) AS MIN_MONTH,
                   Year(FT_MIN_DATE)  AS MIN_YEAR,
                   MAX_MONTH,
                   MAX_YEAR,
                   BUSINESS_UNIT,
                   COMPANY_MASTER_SID
                FROM   (SELECT FM.FORECAST_NAME,
                           FM.FORECAST_VER,
                           FM."SOURCE",
                           FM.COUNTRY,
                           FM.BUSINESS_UNIT,
                           CM.COMPANY_MASTER_SID,
                           Min(CASE
                                 WHEN FORECAST_VER = Floor(FM.FORECAST_VER) THEN Min(Datefromparts(FORECAST_YEAR , FORECAST_MONTH ,1 ))
                               END)
                             OVER(
                               partition BY FORECAST_NAME)                            FT_MIN_DATE,
                           Max(Datefromparts(fm.FORECAST_YEAR, fm.FORECAST_MONTH, 1)) AS FT_MAX_DATE,
                           Max(Cast(fm.FORECAST_MONTH AS INT))                        AS MAX_MONTH,
                           Max(Cast(fm.FORECAST_YEAR AS INT))                         AS MAX_YEAR
                    FROM DEMAND_FORECAST FM
                            JOIN ITEM_MASTER IM
                                ON IM.ITEM_MASTER_SID = FM.ITEM_MASTER_SID
                            AND IM.INBOUND_STATUS <> 'D' 
                            JOIN GL_COST_CENTER_MASTER GLC
                                ON IM.NDC8 = GLC.NDC8
                            AND GLC.INBOUND_STATUS <> 'D' 
                            JOIN COMPANY_MASTER CM
                                ON CM.COMPANY_ID = GLC.COMPANY_CODE
                            AND CM.INBOUND_STATUS <> 'D'
                            AND CM.COMPANY_MASTER_SID = [?COMPANY_MASTER_SID]
                    WHERE  FM.COUNTRY = '[?COUNTRY]'
                           AND FM.BUSINESS_UNIT = [?BUSINESS_UNIT]
                           AND FM.FORECAST_VER LIKE '%'
                           [?CONDITION]
                    GROUP  BY FM.FORECAST_NAME,
                              FM.FORECAST_VER,
                              FM.SOURCE,
                              FM.COUNTRY,
                              FM.BUSINESS_UNIT,
                              CM.COMPANY_MASTER_SID
                              ) A
                               @DATEQUERY
                    ORDER BY [?ORDER_BY_COLUMN] 
                        OFFSET [?START] ROWS FETCH NEXT [?END] ROWS ONLY;
            
                 ]]>
        </query>
    </entity>
    
    <entity id="demand-count-query">
        <query>
            <![CDATA[
    
                SELECT COUNT(*)
                FROM   (SELECT FM.FORECAST_NAME,
                           FM.FORECAST_VER,
                           FM."SOURCE",
                           FM.COUNTRY,
                           FM.BUSINESS_UNIT,
                           CM.COMPANY_MASTER_SID,
                           Min(CASE
                                 WHEN FORECAST_VER = Floor(FM.FORECAST_VER) THEN Min(Datefromparts(FORECAST_YEAR , FORECAST_MONTH ,1 ))
                               END)
                             OVER(
                               partition BY FORECAST_NAME)                            FT_MIN_DATE,
                           Max(Datefromparts(fm.FORECAST_YEAR, fm.FORECAST_MONTH, 1)) AS FT_MAX_DATE,
                           Max(Cast(fm.FORECAST_MONTH AS INT))                        AS MAX_MONTH,
                           Max(Cast(fm.FORECAST_YEAR AS INT))                         AS MAX_YEAR
                    FROM DEMAND_FORECAST FM
                            JOIN ITEM_MASTER IM
                                ON IM.ITEM_MASTER_SID = FM.ITEM_MASTER_SID
                            AND IM.INBOUND_STATUS <> 'D' 
                            JOIN GL_COST_CENTER_MASTER GLC
                                ON IM.NDC8 = GLC.NDC8
                            AND GLC.INBOUND_STATUS <> 'D' 
                            JOIN COMPANY_MASTER CM
                                ON CM.COMPANY_ID = GLC.COMPANY_CODE
                            AND CM.INBOUND_STATUS <> 'D'
                            AND CM.COMPANY_MASTER_SID = [?COMPANY_MASTER_SID]
                    WHERE  FM.COUNTRY = '[?COUNTRY]'
                           AND FM.BUSINESS_UNIT = [?BUSINESS_UNIT]
                           AND FM.FORECAST_VER LIKE '%'
                           [?CONDITION]
                    GROUP  BY FM.FORECAST_NAME,
                              FM.FORECAST_VER,
                              FM.SOURCE,
                              FM.COUNTRY,
                              FM.BUSINESS_UNIT,
                              CM.COMPANY_MASTER_SID
                              ) A  
                              @DATEQUERY 
                 ]]>
        </query>
    </entity>
    
    
        
    <entity id="adjusted-demand-search-query">
        <query>
            <![CDATA[
                SELECT FORECAST_NAME,
                     FORECAST_VER,
                     "SOURCE",
                     COUNTRY,
                     FT_MIN_DATE,
                     FT_MAX_DATE,
                     Month(FT_MIN_DATE) AS MIN_MONTH,
                     Year(FT_MIN_DATE)  AS MIN_YEAR,
                     MAX_MONTH,
                     MAX_YEAR,
                     BUSINESS_UNIT,
                     COMPANY_MASTER_SID
                FROM   (SELECT FM.FORECAST_NAME,
                             FM.FORECAST_VER,
                             FM."SOURCE",
                             FM.COUNTRY,
                             FM.BUSINESS_UNIT,
                             CM.COMPANY_MASTER_SID,
                             Min(CASE
                                   WHEN FORECAST_VER = Floor(FM.FORECAST_VER) THEN Min(Datefromparts(YEAR , MONTH ,1 ))
                                 END)
                               OVER(
                                 partition BY FORECAST_NAME)                            FT_MIN_DATE,
                             Max(Datefromparts(fm.YEAR, fm.MONTH, 1)) AS FT_MAX_DATE,
                             Max(Cast(fm.MONTH AS INT))                        AS MAX_MONTH,
                             Max(Cast(fm.YEAR AS INT))                         AS MAX_YEAR
                      FROM ADJUSTED_DEMAND_FORECAST FM
                              JOIN ITEM_MASTER IM
                                  ON IM.ITEM_MASTER_SID = FM.ITEM_MASTER_SID
                              AND IM.INBOUND_STATUS <> 'D'
                              JOIN GL_COST_CENTER_MASTER GLC
                                  ON IM.NDC8 = GLC.NDC8
                              AND GLC.INBOUND_STATUS <> 'D'
                              JOIN COMPANY_MASTER CM
                                  ON CM.COMPANY_ID = GLC.COMPANY_CODE
                              AND CM.INBOUND_STATUS <> 'D'
                              AND CM.COMPANY_MASTER_SID = [?COMPANY_MASTER_SID]
                      WHERE  FM.COUNTRY = '[?COUNTRY]'
                             AND FM.BUSINESS_UNIT = [?BUSINESS_UNIT]
                             AND FM.FORECAST_VER LIKE '%'
                             [?CONDITION]
                      GROUP  BY FM.FORECAST_NAME,
                                FM.FORECAST_VER,
                                FM.SOURCE,
                                FM.COUNTRY,
                                FM.BUSINESS_UNIT,
                                CM.COMPANY_MASTER_SID) A
                                @DATEQUERY
                    ORDER BY [?ORDER_BY_COLUMN] 
                        OFFSET [?START] ROWS FETCH NEXT [?END] ROWS ONLY;
                ]]>
        </query>
    </entity>
    
    
     <entity id="adjusted-demand-count-query">
        <query>
            <![CDATA[
                SELECT COUNT(*)
                FROM   (SELECT FM.FORECAST_NAME,
                             FM.FORECAST_VER,
                             FM."SOURCE",
                             FM.COUNTRY,
                             FM.BUSINESS_UNIT,
                             CM.COMPANY_MASTER_SID,
                             Min(CASE
                                   WHEN FORECAST_VER = Floor(FM.FORECAST_VER) THEN Min(Datefromparts(YEAR , MONTH ,1 ))
                                 END)
                               OVER(
                                 partition BY FORECAST_NAME)                            FT_MIN_DATE,
                             Max(Datefromparts(fm.YEAR, fm.MONTH, 1)) AS FT_MAX_DATE,
                             Max(Cast(fm.MONTH AS INT))                        AS MAX_MONTH,
                             Max(Cast(fm.YEAR AS INT))                         AS MAX_YEAR
                      FROM ADJUSTED_DEMAND_FORECAST FM
                              JOIN ITEM_MASTER IM
                                  ON IM.ITEM_MASTER_SID = FM.ITEM_MASTER_SID
                              AND IM.INBOUND_STATUS <> 'D'
                              JOIN GL_COST_CENTER_MASTER GLC
                                  ON IM.NDC8 = GLC.NDC8
                              AND GLC.INBOUND_STATUS <> 'D'
                              JOIN COMPANY_MASTER CM
                                  ON CM.COMPANY_ID = GLC.COMPANY_CODE
                              AND CM.INBOUND_STATUS <> 'D'
                              AND CM.COMPANY_MASTER_SID = [?COMPANY_MASTER_SID]
                      WHERE  FM.COUNTRY = '[?COUNTRY]'
                             AND FM.BUSINESS_UNIT = [?BUSINESS_UNIT]
                             AND FM.FORECAST_VER LIKE '%'
                             [?CONDITION]
                      GROUP  BY FM.FORECAST_NAME,
                                FM.FORECAST_VER,
                                FM.SOURCE,
                                FM.COUNTRY,
                                FM.BUSINESS_UNIT,
                                CM.COMPANY_MASTER_SID) A
                                @DATEQUERY;
                ]]>
        </query>
    </entity>
    
    <entity id="customer-gts-search-query">
        <query>
            <![CDATA[
             SELECT FORECAST_NAME,
             FORECAST_VER,
             "SOURCE",
             COUNTRY,
             FT_MIN_DATE,
             FT_MAX_DATE,
             Month(FT_MIN_DATE) AS MIN_MONTH,
             Year(FT_MIN_DATE)  AS MIN_YEAR,
             MAX_MONTH,
             MAX_YEAR,
             BUSINESS_UNIT,
             COMPANY_MASTER_SID
          FROM   (SELECT FM.FORECAST_NAME,
                     FM.FORECAST_VER,
                     FM."SOURCE",
                     FM.COUNTRY,
                     FM.BUSINESS_UNIT,
                     CM.COMPANY_MASTER_SID,
                     Min(CASE
                           WHEN FORECAST_VER = Floor(FM.FORECAST_VER) THEN Min(Datefromparts(FORECAST_YEAR , FORECAST_MONTH ,1 ))
                         END)
                       OVER(
                         partition BY FORECAST_NAME)                            FT_MIN_DATE,
                     Max(Datefromparts(fm.FORECAST_YEAR, fm.FORECAST_MONTH, 1)) AS FT_MAX_DATE,
                     Max(Cast(fm.FORECAST_MONTH AS INT))                        AS MAX_MONTH,
                     Max(Cast(fm.FORECAST_YEAR AS INT))                         AS MAX_YEAR
              FROM CUSTOMER_GTS_FORECAST FM
                      JOIN ITEM_MASTER IM
                          ON IM.ITEM_MASTER_SID = FM.ITEM_MASTER_SID
                      AND IM.INBOUND_STATUS <> 'D'
                      JOIN GL_COST_CENTER_MASTER GLC
                          ON IM.NDC8 = GLC.NDC8
                      AND GLC.INBOUND_STATUS <> 'D'
                      JOIN COMPANY_MASTER CM
                          ON CM.COMPANY_ID = GLC.COMPANY_CODE
                      AND CM.INBOUND_STATUS <> 'D'
                      AND CM.COMPANY_MASTER_SID = [?COMPANY_MASTER_SID]
              WHERE  FM.COUNTRY = '[?COUNTRY]'
                     AND FM.BUSINESS_UNIT = [?BUSINESS_UNIT]
                     AND FM.FORECAST_VER LIKE '%'
                     [?CONDITION]
              GROUP  BY FM.FORECAST_NAME,
                        FM.FORECAST_VER,
                        FM.SOURCE,
                        FM.COUNTRY,
                        FM.BUSINESS_UNIT,
                        CM.COMPANY_MASTER_SID
                        ) A
                          @DATEQUERY
                    ORDER BY [?ORDER_BY_COLUMN] 
                        OFFSET [?START] ROWS FETCH NEXT [?END] ROWS ONLY;
                  
                                  ]]>
        </query>
    </entity>
    
    <entity id="customer-gts-count-query">
        <query>
            <![CDATA[
             SELECT COUNT(*)
          FROM   (SELECT FM.FORECAST_NAME,
                     FM.FORECAST_VER,
                     FM."SOURCE",
                     FM.COUNTRY,
                     FM.BUSINESS_UNIT,
                     CM.COMPANY_MASTER_SID,
                     Min(CASE
                           WHEN FORECAST_VER = Floor(FM.FORECAST_VER) THEN Min(Datefromparts(FORECAST_YEAR , FORECAST_MONTH ,1 ))
                         END)
                       OVER(
                         partition BY FORECAST_NAME)                            FT_MIN_DATE,
                     Max(Datefromparts(fm.FORECAST_YEAR, fm.FORECAST_MONTH, 1)) AS FT_MAX_DATE,
                     Max(Cast(fm.FORECAST_MONTH AS INT))                        AS MAX_MONTH,
                     Max(Cast(fm.FORECAST_YEAR AS INT))                         AS MAX_YEAR
              FROM CUSTOMER_GTS_FORECAST FM
                      JOIN ITEM_MASTER IM
                          ON IM.ITEM_MASTER_SID = FM.ITEM_MASTER_SID
                      AND IM.INBOUND_STATUS <> 'D'
                      JOIN GL_COST_CENTER_MASTER GLC
                          ON IM.NDC8 = GLC.NDC8
                      AND GLC.INBOUND_STATUS <> 'D'
                      JOIN COMPANY_MASTER CM
                          ON CM.COMPANY_ID = GLC.COMPANY_CODE
                      AND CM.INBOUND_STATUS <> 'D'
                      AND CM.COMPANY_MASTER_SID = [?COMPANY_MASTER_SID]
              WHERE  FM.COUNTRY = '[?COUNTRY]'
                     AND FM.BUSINESS_UNIT = [?BUSINESS_UNIT]
                     AND FM.FORECAST_VER LIKE '%'
                     [?CONDITION]
              GROUP  BY FM.FORECAST_NAME,
                        FM.FORECAST_VER,
                        FM.SOURCE,
                        FM.COUNTRY,
                        FM.BUSINESS_UNIT,
                        CM.COMPANY_MASTER_SID
                        ) A
                          @DATEQUERY;  ]]>
        </query>
    </entity>
    
        <entity id="inventory-with-det-search-query">
        <query>
            <![CDATA[    
             SELECT FORECAST_NAME,
             FORECAST_VER,
             "SOURCE",
             COUNTRY,
             FT_MIN_DATE,
             FT_MAX_DATE,
             Month(FT_MIN_DATE) AS MIN_MONTH,
             Year(FT_MIN_DATE)  AS MIN_YEAR,
             MAX_MONTH,
             MAX_YEAR,
             BUSINESS_UNIT,
             COMPANY_MASTER_SID
          FROM   (SELECT FM.FORECAST_NAME,
                     FM.FORECAST_VER,
                     FM."SOURCE",
                     FM.COUNTRY,
                     FM.BUSINESS_UNIT,
                     CM.COMPANY_MASTER_SID,
                     Min(CASE
                           WHEN FORECAST_VER = Floor(FM.FORECAST_VER) THEN Min(Datefromparts(YEAR , MONTH ,1 ))
                         END)
                       OVER(
                         partition BY FORECAST_NAME)                            FT_MIN_DATE,
                     Max(Datefromparts(fm.YEAR, fm.MONTH, 1)) AS FT_MAX_DATE,
                     Max(Cast(fm.MONTH AS INT))                        AS MAX_MONTH,
                     Max(Cast(fm.YEAR AS INT))                         AS MAX_YEAR
              FROM INVENTORY_WD_PROJ_DT FM
                      JOIN ITEM_MASTER IM
                          ON IM.ITEM_MASTER_SID = FM.ITEM_MASTER_SID
                      AND IM.INBOUND_STATUS <> 'D'
                      JOIN GL_COST_CENTER_MASTER GLC
                          ON IM.NDC8 = GLC.NDC8
                      AND GLC.INBOUND_STATUS <> 'D'
                      JOIN COMPANY_MASTER CM
                          ON CM.COMPANY_ID = GLC.COMPANY_CODE
                      AND CM.INBOUND_STATUS <> 'D'
                      AND CM.COMPANY_MASTER_SID = [?COMPANY_MASTER_SID]
              WHERE  FM.COUNTRY = '[?COUNTRY]'
                     AND FM.BUSINESS_UNIT = [?BUSINESS_UNIT]
                     AND FM.FORECAST_VER LIKE '%'
                     [?CONDITION]
              GROUP  BY FM.FORECAST_NAME,
                        FM.FORECAST_VER,
                        FM.SOURCE,
                        FM.COUNTRY,
                        FM.BUSINESS_UNIT,
                        CM.COMPANY_MASTER_SID
                        ) A
                          @DATEQUERY
                    ORDER BY [?ORDER_BY_COLUMN] 
                        OFFSET [?START] ROWS FETCH NEXT [?END] ROWS ONLY;
                  ]]>
        </query>
    </entity>
    
      <entity id="inventory-with-det-count-query">
        <query>
            <![CDATA[    
             SELECT COUNT(*)
          FROM   (SELECT FM.FORECAST_NAME,
                     FM.FORECAST_VER,
                     FM."SOURCE",
                     FM.COUNTRY,
                     FM.BUSINESS_UNIT,
                     CM.COMPANY_MASTER_SID,
                     Min(CASE
                           WHEN FORECAST_VER = Floor(FM.FORECAST_VER) THEN Min(Datefromparts(YEAR , MONTH ,1 ))
                         END)
                       OVER(
                         partition BY FORECAST_NAME)                            FT_MIN_DATE,
                     Max(Datefromparts(fm.YEAR, fm.MONTH, 1)) AS FT_MAX_DATE,
                     Max(Cast(fm.MONTH AS INT))                        AS MAX_MONTH,
                     Max(Cast(fm.YEAR AS INT))                         AS MAX_YEAR
              FROM INVENTORY_WD_PROJ_DT FM
                      JOIN ITEM_MASTER IM
                          ON IM.ITEM_MASTER_SID = FM.ITEM_MASTER_SID
                      AND IM.INBOUND_STATUS <> 'D'
                      JOIN GL_COST_CENTER_MASTER GLC
                          ON IM.NDC8 = GLC.NDC8
                      AND GLC.INBOUND_STATUS <> 'D'
                      JOIN COMPANY_MASTER CM
                          ON CM.COMPANY_ID = GLC.COMPANY_CODE
                      AND CM.INBOUND_STATUS <> 'D'
                      AND CM.COMPANY_MASTER_SID = [?COMPANY_MASTER_SID]
              WHERE  FM.COUNTRY = '[?COUNTRY]'
                     AND FM.BUSINESS_UNIT = [?BUSINESS_UNIT]
                     AND FM.FORECAST_VER LIKE '%'
                     [?CONDITION]
              GROUP  BY FM.FORECAST_NAME,
                        FM.FORECAST_VER,
                        FM.SOURCE,
                        FM.COUNTRY,
                        FM.BUSINESS_UNIT,
                        CM.COMPANY_MASTER_SID
                        ) A
                          @DATEQUERY;
                  ]]>
        </query>
    </entity>
    
    <entity id="inventory-withdrawl-summary-search-query">
        <query>
            <![CDATA[    
             SELECT FORECAST_NAME,
             FORECAST_VER,
             "SOURCE",
             COUNTRY,
             FT_MIN_DATE,
             FT_MAX_DATE,
             Month(FT_MIN_DATE) AS MIN_MONTH,
             Year(FT_MIN_DATE)  AS MIN_YEAR,
             MAX_MONTH,
             MAX_YEAR,
             BUSINESS_UNIT,
             COMPANY_MASTER_SID
          FROM   (SELECT FM.FORECAST_NAME,
                     FM.FORECAST_VER,
                     FM."SOURCE",
                     FM.COUNTRY,
                     FM.BUSINESS_UNIT,
                     CM.COMPANY_MASTER_SID,
                     Min(CASE
                           WHEN FORECAST_VER = Floor(FM.FORECAST_VER) THEN Min(Datefromparts(YEAR , MONTH ,1 ))
                         END)
                       OVER(
                         partition BY FORECAST_NAME)                            FT_MIN_DATE,
                     Max(Datefromparts(fm.YEAR, fm.MONTH, 1)) AS FT_MAX_DATE,
                     Max(Cast(fm.MONTH AS INT))                        AS MAX_MONTH,
                     Max(Cast(fm.YEAR AS INT))                         AS MAX_YEAR
              FROM INVENTORY_WD_PROJ_MAS FM
                      JOIN ITEM_MASTER IM
                          ON IM.ITEM_MASTER_SID = FM.ITEM_MASTER_SID
                      AND IM.INBOUND_STATUS <> 'D'
                      JOIN GL_COST_CENTER_MASTER GLC
                          ON IM.NDC8 = GLC.NDC8
                      AND GLC.INBOUND_STATUS <> 'D'
                      JOIN COMPANY_MASTER CM
                          ON CM.COMPANY_ID = GLC.COMPANY_CODE
                      AND CM.INBOUND_STATUS <> 'D'
                      AND CM.COMPANY_MASTER_SID = [?COMPANY_MASTER_SID]
              WHERE  FM.COUNTRY = '[?COUNTRY]'
                     AND FM.BUSINESS_UNIT = [?BUSINESS_UNIT]
                     AND FM.FORECAST_VER LIKE '%'
                     [?CONDITION]
              GROUP  BY FM.FORECAST_NAME,
                        FM.FORECAST_VER,
                        FM.SOURCE,
                        FM.COUNTRY,
                        FM.BUSINESS_UNIT,
                        CM.COMPANY_MASTER_SID
                        ) A
                          @DATEQUERY
                    ORDER BY [?ORDER_BY_COLUMN] 
                        OFFSET [?START] ROWS FETCH NEXT [?END] ROWS ONLY;
                  ]]>
        </query>
    </entity>
    
      <entity id="inventory-withdrawl-summary-count-query">
        <query>
            <![CDATA[    
             SELECT COUNT(*)
          FROM   (SELECT FM.FORECAST_NAME,
                     FM.FORECAST_VER,
                     FM."SOURCE",
                     FM.COUNTRY,
                     FM.BUSINESS_UNIT,
                     CM.COMPANY_MASTER_SID,
                     Min(CASE
                           WHEN FORECAST_VER = Floor(FM.FORECAST_VER) THEN Min(Datefromparts(YEAR , MONTH ,1 ))
                         END)
                       OVER(
                         partition BY FORECAST_NAME)                            FT_MIN_DATE,
                     Max(Datefromparts(fm.YEAR, fm.MONTH, 1)) AS FT_MAX_DATE,
                     Max(Cast(fm.MONTH AS INT))                        AS MAX_MONTH,
                     Max(Cast(fm.YEAR AS INT))                         AS MAX_YEAR
              FROM INVENTORY_WD_PROJ_MAS FM
                      JOIN ITEM_MASTER IM
                          ON IM.ITEM_MASTER_SID = FM.ITEM_MASTER_SID
                      AND IM.INBOUND_STATUS <> 'D'
                      JOIN GL_COST_CENTER_MASTER GLC
                          ON IM.NDC8 = GLC.NDC8
                      AND GLC.INBOUND_STATUS <> 'D'
                      JOIN COMPANY_MASTER CM
                          ON CM.COMPANY_ID = GLC.COMPANY_CODE
                      AND CM.INBOUND_STATUS <> 'D'
                      AND CM.COMPANY_MASTER_SID = [?COMPANY_MASTER_SID]
              WHERE  FM.COUNTRY = '[?COUNTRY]'
                     AND FM.BUSINESS_UNIT = [?BUSINESS_UNIT]
                     AND FM.FORECAST_VER LIKE '%'
                     [?CONDITION]
              GROUP  BY FM.FORECAST_NAME,
                        FM.FORECAST_VER,
                        FM.SOURCE,
                        FM.COUNTRY,
                        FM.BUSINESS_UNIT,
                        CM.COMPANY_MASTER_SID
                        ) A
                          @DATEQUERY;
                  ]]>
        </query>
    </entity>
    
    <entity id="balanceSummaryReport">
            <query>
                <![CDATA[    
                  SELECT
                    HT.HELPER_TABLE_SID,        
                    HT.DESCRIPTION
                FROM
                    HELPER_TABLE HT
                    where HT.LIST_NAME = 'Balance_Summary_Report_Type'
                      ]]>
            </query>
        </entity> 

    <entity id="getHierarchyCatBySid">
        <query> 
            <![CDATA[
                SELECT
                         DISTINCT he.DESCRIPTION
                 from
                         dbo.HIERARCHY_DEFINITION hld join dbo.HELPER_TABLE he on
                         he.HELPER_TABLE_SID = hld.HIERARCHY_CATEGORY
                 WHERE
                         hld.HIERARCHY_DEFINITION_SID = ?HIERDEFSID
            ]]>
        </query>
     </entity>
     
     <entity id="getRBItemId">
		<query> 
        <![CDATA[
          SELECT
					DISTINCT IM.ITEM_MASTER_SID
				FROM
					ITEM_MASTER IM
					JOIN BRAND_MASTER B1 ON
					B1.BRAND_MASTER_SID = IM.BRAND_MASTER_SID
					JOIN GL_COST_CENTER_MASTER GLC ON
					GLC.NDC8 = IM.NDC8
					JOIN COMPANY_MASTER CM ON
					CM.COMPANY_ID = GLC.COMPANY_CODE
					WHERE
					IM.ITEM_NAME IS NOT NULL
					?;
]]>
		</query>
	</entity>

	<entity id="getDeductionData">
		<query> 
        <![CDATA[
         SELECT DISTINCT
	  RS.RS_CATEGORY as RS_CATEGORY,
      RS.RS_TYPE as RS_TYPE,
      RS.REBATE_PROGRAM_TYPE as REBATE_PROGRAM_TYPE,
      
        isnull(CASE WHEN (U.UDC1)=0 THEN ( SELECT HELPER_TABLE_SID                                 FROM   helper_table
                                WHERE  DESCRIPTION = 'UDC1'
                                       AND LIST_NAME = 'RS_UDC1')  END ,( SELECT HELPER_TABLE_SID
                                FROM   helper_table
                                WHERE  DESCRIPTION = 'UDC1'
                                       AND LIST_NAME = 'RS_UDC1') )
									    AS UDC1,
      
          isnull(CASE WHEN (U.udc2)=0 THEN ( SELECT HELPER_TABLE_SID
                                FROM   helper_table
                                WHERE  DESCRIPTION = 'udc2'
                                       AND LIST_NAME = 'RS_UDC2')  END ,( SELECT HELPER_TABLE_SID
                                FROM   helper_table
                                WHERE  DESCRIPTION = 'udc2'
                                       AND LIST_NAME = 'RS_UDC2') )
									    AS udc2,


										      isnull(CASE WHEN (U.UDC3)=0 THEN ( SELECT HELPER_TABLE_SID
                                FROM   helper_table
                                WHERE  DESCRIPTION = 'UDC3'
                                       AND LIST_NAME = 'RS_UDC3')  END ,( SELECT HELPER_TABLE_SID
                                FROM   helper_table
                                WHERE  DESCRIPTION = 'UDC3'
                                       AND LIST_NAME = 'RS_UDC3') )
									    AS UDC3,


										      isnull(CASE WHEN (U.UDC4)=0 THEN ( SELECT HELPER_TABLE_SID
                                FROM   helper_table
                                WHERE  DESCRIPTION = 'UDC4'
                                       AND LIST_NAME = 'RS_UDC4')  END ,( SELECT HELPER_TABLE_SID
                                FROM  helper_table
                                WHERE  DESCRIPTION = 'UDC4'
                                       AND LIST_NAME = 'RS_UDC4') )
									    AS UDC4,


										      isnull(CASE WHEN (U.UDC5)=0 THEN ( SELECT HELPER_TABLE_SID
                                FROM   helper_table
                                WHERE  DESCRIPTION = 'UDC5'
                                       AND LIST_NAME = 'RS_UDC5')  END ,( SELECT HELPER_TABLE_SID
                                FROM  helper_table
                                WHERE  DESCRIPTION = 'UDC5'
                                       AND LIST_NAME = 'RS_UDC5') )
									    AS UDC5,


										      isnull(CASE WHEN (U.UDC6)=0 THEN ( SELECT HELPER_TABLE_SID
                                FROM   helper_table
                                WHERE  DESCRIPTION = 'UDC6'
                                       AND LIST_NAME = 'RS_UDC6')  END ,( SELECT HELPER_TABLE_SID
                                FROM   helper_table
                                WHERE  DESCRIPTION = 'UDC6'
                                       AND LIST_NAME = 'RS_UDC6') )
									    AS UDC6,
            RS.RS_CONTRACT_SID as RS_ID
	FROM
	RS_contract_details A join RS_CONTRACT RS on
	RS.RS_CONTRACT_SID = a.RS_CONTRACT_SID
	and RS.INBOUND_STATUS <> 'D'and a.INBOUND_STATUS <> 'D' left
JOIN UDCS U ON
	U.MASTER_SID = A.RS_CONTRACT_SID
where
	A.item_master_sid in (?)
	order by  
    RS_CATEGORY,RS_TYPE,REBATE_PROGRAM_TYPE, UDC1,UDC2,UDC3,UDC4,UDC5,UDC6,RS_ID ASC;
]]>
		</query>
	</entity>


	<entity id="getHierarchyDefSid">
		<query> 
        <![CDATA[
      select
	LEVEL_NO,
	HIERARCHY_LEVEL_DEFINITION_SID,
	LEVEL_NAME
from
	dbo.HIERARCHY_LEVEL_DEFINITION
WHERE
	HIERARCHY_DEFINITION_SID = (select HIERARCHY_DEFINITION_SID from dbo.RELATIONSHIP_BUILDER where RELATIONSHIP_BUILDER_SID = ?)
]]>
		</query>
	</entity>

	<entity id="getHierarchyDefSidRB">
		<query> 
        <![CDATA[
     select
	HIERARCHY_DEFINITION_SID
from
	dbo.HIERARCHY_DEFINITION
where
	HIERARCHY_NAME like '%Deduction%'
ORDER By
	CREATED_DATE DESC;
]]>
		</query>
	</entity>

	<entity id="getProductRelationId">
		<query> 
        <![CDATA[
   select
	RELATIONSHIP_BUILDER_SID
from
	dbo.RELATIONSHIP_BUILDER
where
	deduction_relation = ?;
]]>
		</query>
	</entity>


	<entity id="getProductRelationIdRLD">
		<query> 
        <![CDATA[
select
      *
 from
      (
              select
                      LEVEL_NAME,LEVEL_NO,RELATIONSHIP_LEVEL_VALUES,PARENT_NODE,
                      dense_rank() 
                      OVER(                  
                      order by
                              LEVEL_NO desc
                      ) rn
              from
                      dbo.RELATIONSHIP_LEVEL_DEFINITION
              where
                      RELATIONSHIP_BUILDER_SID = ?
      ) A
 where
     a.rn =1
]]>
		</query>
	</entity>
        
        <entity id="getHierarchyCatBySidForDed">
        <query> 
            <![CDATA[
                SELECT
                         DISTINCT he.DESCRIPTION
                 from
                         dbo.HIERARCHY_DEFINITION hld join dbo.HELPER_TABLE he on
                         he.HELPER_TABLE_SID = hld.HIERARCHY_CATEGORY
                 WHERE
                         hld.HIERARCHY_DEFINITION_SID = ?
            ]]>
        </query>
     </entity>
     <entity id="tabPermission">
        <query>
            <![CDATA[				
                select distinct spm.PROPERTY_NAME,bmm.ACCESS_MODULE from USERGROUP_BUSINESSROLE as ubm,BUSINESSROLE_MODULE as bmm, 
                MODULE_PROPERTIES as spm where 
                ubm.BUSINESSROLE_MASTER_SID=bmm.BUSINESSROLE_MASTER_SID and bmm.SUBMODULE_PROPERTY_ID=spm.MODULE_PROPERTY_SID and 
                (spm.PROPERTY_NAME is not null or spm.PROPERTY_NAME != '') 
                and spm.CATEGORY_NAME='Tab'
            ]]>
        </query>
    </entity>
    <entity id="fieldPermissionForTransaction">
        <query>
	    <![CDATA[				
                select distinct spm.PROPERTY_NAME,bmm.ADD_FLAG,bmm.EDIT_FLAG,bmm.VIEW_FLAG,spm.TAB_NAME from USERGROUP_BUSINESSROLE as ubm, 
		BUSINESSROLE_MODULE as bmm, 
                MODULE_PROPERTIES as spm where 
                ubm.BUSINESSROLE_MASTER_SID=bmm.BUSINESSROLE_MASTER_SID and bmm.SUBMODULE_PROPERTY_ID=spm.MODULE_PROPERTY_SID and 
                (spm.PROPERTY_NAME is not null or spm.PROPERTY_NAME != '') 
                and spm.CATEGORY_NAME NOT IN ('Button','Tab')
            ]]>
        </query>
    </entity>
    <entity id="fieldPermission">
        <query>
            <![CDATA[				
                select distinct spm.PROPERTY_NAME,bmm.ADD_FLAG,bmm.EDIT_FLAG,bmm.VIEW_FLAG from USERGROUP_BUSINESSROLE as ubm, 
                BUSINESSROLE_MODULE as bmm, 
                MODULE_PROPERTIES as spm where 
                ubm.BUSINESSROLE_MASTER_SID=bmm.BUSINESSROLE_MASTER_SID and bmm.SUBMODULE_PROPERTY_ID=spm.MODULE_PROPERTY_SID and 
                (spm.PROPERTY_NAME is not null or spm.PROPERTY_NAME != '') 
                and spm.CATEGORY_NAME NOT IN ('Button','Tab')
            ]]>
        </query>
    </entity>
    <entity id="functionPermission">
        <query>
            <![CDATA[		
		select distinct spm.PROPERTY_NAME,bmm.ACCESS_MODULE from USERGROUP_BUSINESSROLE as ubm, 
		BUSINESSROLE_MODULE as bmm, 
                MODULE_PROPERTIES as spm where 
                ubm.BUSINESSROLE_MASTER_SID=bmm.BUSINESSROLE_MASTER_SID and bmm.SUBMODULE_PROPERTY_ID=spm.MODULE_PROPERTY_SID and 
                (spm.PROPERTY_NAME is not null or spm.PROPERTY_NAME != '') 
                and spm.CATEGORY_NAME='Button'
            ]]>
        </query>
    </entity>
    
    <entity id="getDetailsResults">
        <query>
            <![CDATA[
                SELECT DISTINCT IM.ITEM_NO,IM.ITEM_NAME,FM.FORECAST_YEAR,FM.FORECAST_MONTH,FM.FORECAST_DATE,
                FM.PRICE,FM.UNITS,FM.DOLLARS,FM.RECORD_LOCK_STATUS,FM.FORECAST_MASTER_SID 
                FROM FORECASTING_MASTER FM,ITEM_MASTER IM WHERE FM.NDC=IM.ITEM_ID 
                AND FORECAST_NAME=  
            ]]>
        </query>
    </entity>
    <entity id="getHierarchyDefinitionOutboundAllMaxLevel">
        <query>
            <![CDATA[
                SELECT Max(NO_OF_LEVELS) FROM HIERARCHY_DEFINITION
            ]]> 
        </query>
    </entity>
    <entity id="getHierarchyDefinitionOutboundMaxLevel">
        <query>
            <![CDATA[
                DECLARE @HIERARCHY_DEFINITION_SID VARCHAR(4000)='?HIERARCHY_DEFINITION_SID'
                SELECT Max(NO_OF_LEVELS)
                FROM   (SELECT TOKEN AS HIERARCHY_DEFINITION_SID,
                           NO_OF_LEVELS
                    FROM   [dbo].[Udf_splitstring] (@HIERARCHY_DEFINITION_SID, ',')F
                           INNER JOIN HIERARCHY_DEFINITION H
                                   ON F.TOKEN = H.HIERARCHY_DEFINITION_SID)A  
            ]]>
        </query>
    </entity>
    <entity id="getHierarchyDefinitionOutbound">
        <query>
        <![CDATA[

        DECLARE @HIERARCHY_DEFINITION_SID VARCHAR(4000)='?HIERARCHY_DEFINITION_SID';

        WITH HIERARCHY
             AS (SELECT TOKEN AS HIERARCHY_DEFINITION_SID
                 FROM   [dbo].[Udf_splitstring] (@HIERARCHY_DEFINITION_SID, ','))
        SELECT C.HIERARCHY_DEFINITION_SID,
               H.HIERARCHY_NAME,
               HT.DESCRIPTION  AS HIERARCHY_TYPE,
               HTC.DESCRIPTION AS HIERARCHY_CATEGORY,
               H.NO_OF_LEVELS,
               H.VERSION_NO    AS VERSION,
               HL.LEVEL_NAME,
               HL.LEVEL_NO,
               HL.LEVEL_VALUE_REFERENCE,
               HL.TABLE_NAME,
               HL.FIELD_NAME,
               HL.INCLUSION_RULE_TYPE,
               HL.INCLUSION_RULE,
               HL.INCLUSION_CONDITION,
               HL.EXCLUSION_RULE_TYPE,
               HL.EXCLUSION_RULE,
               HL.EXCLUSION_CONDITION
        FROM   HIERARCHY_DEFINITION H
               INNER JOIN HIERARCHY C
                       ON H.HIERARCHY_DEFINITION_SID = C.HIERARCHY_DEFINITION_SID
               INNER JOIN HIERARCHY_LEVEL_DEFINITION HL
                       ON H.HIERARCHY_DEFINITION_SID = HL.HIERARCHY_DEFINITION_SID
               LEFT JOIN HELPER_TABLE HT
                      ON HT.HELPER_TABLE_SID = H.HIERARCHY_TYPE
                         AND HT.LIST_NAME = 'RELATIONSHIP_TYPE'
               LEFT JOIN HELPER_TABLE HTC
                      ON HTC.HELPER_TABLE_SID = H.HIERARCHY_CATEGORY
                         AND HTC.LIST_NAME = 'HIERARCHY_CATEGORY' 


        ]]>
        </query>
    </entity>
    <entity id="getHierarchyDefinitionOuboundCheckAllResults">
        <query>
        <![CDATA[
        WITH HIERARCHY
             AS ( SELECT HIERARCHY_DEFINITION_SID from HIERARCHY_DEFINITION HD
        WHERE HD.HIERARCHY_TYPE= ?CONDITIONS )
        SELECT C.HIERARCHY_DEFINITION_SID,
               H.HIERARCHY_NAME,
               HT.DESCRIPTION  AS HIERARCHY_TYPE,
               HTC.DESCRIPTION AS HIERARCHY_CATEGORY,
               H.NO_OF_LEVELS,
               H.VERSION_NO    AS VERSION,
               HL.LEVEL_NAME,
               HL.LEVEL_NO,
               HL.LEVEL_VALUE_REFERENCE,
               HL.TABLE_NAME,
               HL.FIELD_NAME,
               HL.INCLUSION_RULE_TYPE,
               HL.INCLUSION_RULE,
               HL.INCLUSION_CONDITION,
               HL.EXCLUSION_RULE_TYPE,
               HL.EXCLUSION_RULE,
               HL.EXCLUSION_CONDITION
        FROM   HIERARCHY_DEFINITION H
               INNER JOIN HIERARCHY C
                       ON H.HIERARCHY_DEFINITION_SID = C.HIERARCHY_DEFINITION_SID
               INNER JOIN HIERARCHY_LEVEL_DEFINITION HL
                       ON H.HIERARCHY_DEFINITION_SID = HL.HIERARCHY_DEFINITION_SID
               LEFT JOIN HELPER_TABLE HT
                      ON HT.HELPER_TABLE_SID = H.HIERARCHY_TYPE
                         AND HT.LIST_NAME = 'RELATIONSHIP_TYPE'
               LEFT JOIN HELPER_TABLE HTC
                      ON HTC.HELPER_TABLE_SID = H.HIERARCHY_CATEGORY
                         AND HTC.LIST_NAME = 'HIERARCHY_CATEGORY' 


             ]]> 
        </query>
    </entity>
    <entity id="getRelationshipBuilderOutbound">
        <query>
        <![CDATA[
    
    DECLARE @RELATIONSHIP_BUILDER_SID VARCHAR(4000)='?RELATIONSHIP_BUILDER_SID';

WITH RELATION
     AS (SELECT TOKEN AS RELATIONSHIP_BUILDER_SID
         FROM   [dbo].[Udf_splitstring] (@RELATIONSHIP_BUILDER_SID, ',')),
     LINKED
     AS (SELECT *
         FROM   (SELECT Row_number()
                          OVER (
                            PARTITION BY RC.RELATIONSHIP_BUILDER_SID, HLV.LEVEL_VALUES
                            ORDER BY RC.RELATIONSHIP_BUILDER_SID) RN,
                        RC.RELATIONSHIP_BUILDER_SID,
                        HLV.LEVEL_VALUES                          AS RELATIONSHIP_TREE,
                        R.RELATIONSHIP_NAME,
                        R.RELATIONSHIP_DESCRIPTION,
                        H.DESCRIPTION                             AS RELATIONSHIP_TYPE,
                        HD.HIERARCHY_NAME,
                        HLD.LEVEL_NAME                            AS HIERARCHY_LEVEL_NAME,
                        HD.VERSION_NO                             AS HIERARCHY_VERSION_NO,
                        R.START_DATE,
                        R.BUILD_TYPE,
                        RLD.HIERARCHY_NO,
                        RLD.LEVEL_NO,
                        RLD.PARENT_NODE
                 FROM   RELATIONSHIP_BUILDER R
                        INNER JOIN HIERARCHY_DEFINITION HD
                                ON R.HIERARCHY_DEFINITION_SID = HD.HIERARCHY_DEFINITION_SID
                        INNER JOIN HIERARCHY_LEVEL_DEFINITION HLD
                                ON HD.HIERARCHY_DEFINITION_SID = HLD.HIERARCHY_DEFINITION_SID
                        INNER JOIN HIERARCHY_LEVEL_VALUES HLV
                                ON HLV.HIERARCHY_LEVEL_DEFINITION_SID = HLD.HIERARCHY_LEVEL_DEFINITION_SID
                        INNER JOIN RELATIONSHIP_LEVEL_DEFINITION RLD
                                ON R.RELATIONSHIP_BUILDER_SID = RLD.RELATIONSHIP_BUILDER_SID
                                   AND RLD.HIERARCHY_LEVEL_DEFINITION_SID = HLD.HIERARCHY_LEVEL_DEFINITION_SID
                        INNER JOIN RELATION RC
                                ON RC.RELATIONSHIP_BUILDER_SID = R.RELATIONSHIP_BUILDER_SID
                        LEFT JOIN HELPER_TABLE H
                               ON H.HELPER_TABLE_SID = R.RELATIONSHIP_TYPE
                                  AND LIST_NAME = 'RELATIONSHIP_TYPE')A
         WHERE  RN = 1),
     DEFINED
     AS (SELECT NULL                          AS RN,
                RC.RELATIONSHIP_BUILDER_SID,
                RLD.RELATIONSHIP_LEVEL_VALUES AS RELATIONSHIP_TREE,
                R.RELATIONSHIP_NAME,
                R.RELATIONSHIP_DESCRIPTION,
                H.DESCRIPTION                 AS RELATIONSHIP_TYPE,
                HD.HIERARCHY_NAME,
                RLD.LEVEL_NAME                AS HIERARCHY_LEVEL_NAME,
                HD.VERSION_NO                 AS HIERARCHY_VERSION_NO,
                R.START_DATE,
                R.BUILD_TYPE,
                RLD.HIERARCHY_NO,
                RLD.LEVEL_NO,
                RLD.PARENT_NODE
         FROM   RELATIONSHIP_BUILDER R
                INNER JOIN HIERARCHY_DEFINITION HD
                        ON R.HIERARCHY_DEFINITION_SID = HD.HIERARCHY_DEFINITION_SID
                LEFT JOIN HELPER_TABLE H
                       ON H.HELPER_TABLE_SID = R.RELATIONSHIP_TYPE
                          AND LIST_NAME = 'RELATIONSHIP_TYPE'
                INNER JOIN RELATIONSHIP_LEVEL_DEFINITION RLD
                        ON R.RELATIONSHIP_BUILDER_SID = RLD.RELATIONSHIP_BUILDER_SID
                INNER JOIN RELATION RC
                        ON RC.RELATIONSHIP_BUILDER_SID = R.RELATIONSHIP_BUILDER_SID
         WHERE  RLD.LEVEL_NAME NOT IN ( 'SEGMENT', 'SEGMENT GROUP' )),
     LIN_DEF
     AS (SELECT HIERARCHY_PARENT=Row_number()
                                   OVER (
                                     PARTITION BY A.RELATIONSHIP_BUILDER_SID, Len(HIERARCHY_NO)
                                     ORDER BY A.RELATIONSHIP_BUILDER_SID),
                *
         FROM   (SELECT RELATIONSHIP_BUILDER_SID,
                        RELATIONSHIP_TREE,
                        RELATIONSHIP_NAME,
                        RELATIONSHIP_DESCRIPTION,
                        RELATIONSHIP_TYPE,
                        HIERARCHY_NAME,
                        HIERARCHY_LEVEL_NAME,
                        HIERARCHY_VERSION_NO,
                        START_DATE,
                        BUILD_TYPE,
                        HIERARCHY_NO,
                        LEVEL_NO,
                        PARENT_NODE
                 FROM   LINKED
                 UNION ALL
                 SELECT RELATIONSHIP_BUILDER_SID,
                        RELATIONSHIP_TREE,
                        RELATIONSHIP_NAME,
                        RELATIONSHIP_DESCRIPTION,
                        RELATIONSHIP_TYPE,
                        HIERARCHY_NAME,
                        HIERARCHY_LEVEL_NAME,
                        HIERARCHY_VERSION_NO,
                        START_DATE,
                        BUILD_TYPE,
                        HIERARCHY_NO,
                        LEVEL_NO,
                        PARENT_NODE
                 FROM   DEFINED)A)
SELECT *
FROM   LIN_DEF
ORDER  BY RELATIONSHIP_BUILDER_SID,
          HIERARCHY_PARENT,
          HIERARCHY_NO 


     ]]>
     </query>
    </entity> 
    <entity id="getRelationshipOuboundCheckAllResults">
        <query>
        <![CDATA[
    WITH  LINKED
     AS (SELECT *
         FROM   (SELECT Row_number()
                          OVER (
                            PARTITION BY R.RELATIONSHIP_BUILDER_SID, HLV.LEVEL_VALUES
                            ORDER BY R.RELATIONSHIP_BUILDER_SID) RN,
                        R.RELATIONSHIP_BUILDER_SID,
                        HLV.LEVEL_VALUES                          AS RELATIONSHIP_TREE,
                        R.RELATIONSHIP_NAME,
                        R.RELATIONSHIP_DESCRIPTION,
                        H.DESCRIPTION                             AS RELATIONSHIP_TYPE,
                        HD.HIERARCHY_NAME,
                        HLD.LEVEL_NAME                            AS HIERARCHY_LEVEL_NAME,
                        HD.VERSION_NO                             AS HIERARCHY_VERSION_NO,
                        R.START_DATE,
                        R.BUILD_TYPE,
                        RLD.HIERARCHY_NO,
                        RLD.LEVEL_NO,
                        RLD.PARENT_NODE
                 FROM   dbo.RELATIONSHIP_BUILDER R
                        INNER JOIN HIERARCHY_DEFINITION HD
                                ON R.HIERARCHY_DEFINITION_SID = HD.HIERARCHY_DEFINITION_SID
                        INNER JOIN HIERARCHY_LEVEL_DEFINITION HLD
                                ON HD.HIERARCHY_DEFINITION_SID = HLD.HIERARCHY_DEFINITION_SID
                        INNER JOIN HIERARCHY_LEVEL_VALUES HLV
                                ON HLV.HIERARCHY_LEVEL_DEFINITION_SID = HLD.HIERARCHY_LEVEL_DEFINITION_SID
                        INNER JOIN RELATIONSHIP_LEVEL_DEFINITION RLD
                                ON R.RELATIONSHIP_BUILDER_SID = RLD.RELATIONSHIP_BUILDER_SID
                                   AND RLD.HIERARCHY_LEVEL_DEFINITION_SID = HLD.HIERARCHY_LEVEL_DEFINITION_SID
                       
                        LEFT JOIN HELPER_TABLE H
                               ON H.HELPER_TABLE_SID = R.RELATIONSHIP_TYPE
                                  AND LIST_NAME = 'RELATIONSHIP_TYPE'
                                  ?LWHEREQUERY
                                  
)A
         WHERE  RN = 1),
     DEFINED
     AS (SELECT NULL                          AS RN,
                R.RELATIONSHIP_BUILDER_SID,
                RLD.RELATIONSHIP_LEVEL_VALUES AS RELATIONSHIP_TREE,
                R.RELATIONSHIP_NAME,
                R.RELATIONSHIP_DESCRIPTION,
                H.DESCRIPTION                 AS RELATIONSHIP_TYPE,
                HD.HIERARCHY_NAME,
                RLD.LEVEL_NAME                AS HIERARCHY_LEVEL_NAME,
                HD.VERSION_NO                 AS HIERARCHY_VERSION_NO,
                R.START_DATE,
                R.BUILD_TYPE,
                RLD.HIERARCHY_NO,
                RLD.LEVEL_NO,
                RLD.PARENT_NODE
         FROM   RELATIONSHIP_BUILDER R
                INNER JOIN HIERARCHY_DEFINITION HD
                        ON R.HIERARCHY_DEFINITION_SID = HD.HIERARCHY_DEFINITION_SID
                LEFT JOIN HELPER_TABLE H
                       ON H.HELPER_TABLE_SID = R.RELATIONSHIP_TYPE
                          AND LIST_NAME = 'RELATIONSHIP_TYPE'
                INNER JOIN RELATIONSHIP_LEVEL_DEFINITION RLD
                        ON R.RELATIONSHIP_BUILDER_SID = RLD.RELATIONSHIP_BUILDER_SID
               
         WHERE  RLD.LEVEL_NAME NOT IN ( 'SEGMENT', 'SEGMENT GROUP' )
         ?ANDQUERY
),
     LIN_DEF
     AS (SELECT HIERARCHY_PARENT=Row_number()
                                   OVER (
                                     PARTITION BY A.RELATIONSHIP_BUILDER_SID, Len(HIERARCHY_NO)
                                     ORDER BY A.RELATIONSHIP_BUILDER_SID),
                *
         FROM   (SELECT RELATIONSHIP_BUILDER_SID,
                        RELATIONSHIP_TREE,
                        RELATIONSHIP_NAME,
                        RELATIONSHIP_DESCRIPTION,
                        RELATIONSHIP_TYPE,
                        HIERARCHY_NAME,
                        HIERARCHY_LEVEL_NAME,
                        HIERARCHY_VERSION_NO,
                        START_DATE,
                        BUILD_TYPE,
                        HIERARCHY_NO,
                        LEVEL_NO,
                        PARENT_NODE
                 FROM   LINKED
                 UNION ALL
                 SELECT RELATIONSHIP_BUILDER_SID,
                        RELATIONSHIP_TREE,
                        RELATIONSHIP_NAME,
                        RELATIONSHIP_DESCRIPTION,
                        RELATIONSHIP_TYPE,
                        HIERARCHY_NAME,
                        HIERARCHY_LEVEL_NAME,
                        HIERARCHY_VERSION_NO,
                        START_DATE,
                        BUILD_TYPE,
                        HIERARCHY_NO,
                        LEVEL_NO,
                        PARENT_NODE
                 FROM   DEFINED)A)
SELECT *
FROM   LIN_DEF
ORDER  BY RELATIONSHIP_BUILDER_SID,
          HIERARCHY_PARENT,
          HIERARCHY_NO 


      ]]> 
        </query>
    </entity> 
    <entity id="getDetailsResults">
        <query>
        <![CDATA[
                SELECT DISTINCT IM.ITEM_NO,IM.ITEM_NAME,FM.FORECAST_YEAR,FM.FORECAST_MONTH,FM.FORECAST_DATE,
                FM.PRICE,FM.UNITS,FM.DOLLARS,FM.RECORD_LOCK_STATUS,FM.FORECAST_MASTER_SID 
                FROM FORECASTING_MASTER FM,ITEM_MASTER IM WHERE FM.NDC=IM.ITEM_ID 
                AND FORECAST_NAME= 
        ]]>
        </query>
    </entity>
    <entity id="getDetailsResultsExcel">
        <query>
            <![CDATA[
                   SELECT DISTINCT FM.FORECAST_YEAR,FM.FORECAST_MONTH,IM.ITEM_NO,QUOTENAME(IM.ITEM_NAME, CHAR(34)),
                  CONVERT(VARCHAR(10),FM.FORECAST_DATE,101)  AS FORECAST_DATE,
                  FM.PRICE,FM.UNITS,FM.DOLLARS 
                  FROM FORECASTING_MASTER FM,ITEM_MASTER IM WHERE FM.NDC=IM.ITEM_ID 
                  AND FORECAST_NAME=   
            ]]>
        </query>
    </entity>
    <entity id="getHierarchyDefinitionCount">
        <query>
            <![CDATA[

            SELECT  COUNT(HD.HIERARCHY_DEFINITION_SID) FROM HIERARCHY_DEFINITION HD
            WHERE HD.HIERARCHY_TYPE=    

            ]]>
        </query>
    </entity>

    <entity id="getHierarchyDefinitionResults">
        <query>
        <![CDATA[

        SELECT  HD.HIERARCHY_DEFINITION_SID,HD.HIERARCHY_NAME, HD.HIERARCHY_TYPE, HD.HIERARCHY_CATEGORY, HD.NO_OF_LEVELS, HD.CREATED_BY, HD.CREATED_DATE, HD.MODIFIED_BY, HD.MODIFIED_DATE, HD.VERSION_NO FROM HIERARCHY_DEFINITION HD
        WHERE HD.HIERARCHY_TYPE=      

        ]]>
        </query>
    </entity>
    <entity id="getCffOuboundSearchResults">
        <query>
        <![CDATA[
               ;WITH CFF
    AS (SELECT cm.CFF_MASTER_SID,
            cff_name,
            cff_type= ht.description,
            rn = Row_number()OVER(partition BY cm.cff_master_sid ORDER BY approval_sequence DESC),
            approval_status= h.DESCRIPTION,
            APPROVED_DATE,
            APPROVED_BY,
            ACTIVE_FROM_DATE,
            ACTIVE_TO_DATE,
            cm.inbound_status,
            CM.CREATED_DATE
            FROM   cff_master cm
                INNER JOIN CFF_APPROVAL_DETAILS cad
                           ON cm.CFF_MASTER_SID = cad.CFF_MASTER_SID
                INNER JOIN helper_table ht
                           ON cm.CFF_TYPE = ht.helper_table_sid
                INNER JOIN HELPER_TABLE h
                           ON h.HELPER_TABLE_SID = cad.APPROVAL_STATUS
          
),
                Pagination
        AS (SELECT CFF_MASTER_SID,
            cff_name,
            cff_type,
            approval_status,
            APPROVED_DATE,
            APPROVED_BY,
            ACTIVE_FROM_DATE,
            ACTIVE_TO_DATE,
            inbound_status,
            CREATED_DATE,
            pag=Row_number()OVER(ORDER BY CFF_MASTER_SID)
            FROM   CFF
            WHERE  rn = 1)
    SELECT CFF_MASTER_SID
    FROM   Pagination where inbound_status <> 'D'
        ]]> 
        </query>
    </entity>
    <entity id="getRelationshipOuboundScheduleResults">
        <query>
        <![CDATA[
    WITH  LINKED
     AS (SELECT *
         FROM   (SELECT Row_number()
                          OVER (
                            PARTITION BY R.RELATIONSHIP_BUILDER_SID, HLV.LEVEL_VALUES
                            ORDER BY R.RELATIONSHIP_BUILDER_SID) RN,
                        R.RELATIONSHIP_BUILDER_SID,
                        HLV.LEVEL_VALUES                          AS RELATIONSHIP_TREE,
                        R.RELATIONSHIP_NAME,
                        R.RELATIONSHIP_DESCRIPTION,
                        H.DESCRIPTION                             AS RELATIONSHIP_TYPE,
                        HD.HIERARCHY_NAME,
                        HLD.LEVEL_NAME                            AS HIERARCHY_LEVEL_NAME,
                        HD.VERSION_NO                             AS HIERARCHY_VERSION_NO,
                        R.START_DATE,
                        R.BUILD_TYPE,
                        RLD.HIERARCHY_NO,
                        RLD.LEVEL_NO,
                        RLD.PARENT_NODE
                 FROM   dbo.RELATIONSHIP_BUILDER R
                        INNER JOIN HIERARCHY_DEFINITION HD
                                ON R.HIERARCHY_DEFINITION_SID = HD.HIERARCHY_DEFINITION_SID
                        INNER JOIN HIERARCHY_LEVEL_DEFINITION HLD
                                ON HD.HIERARCHY_DEFINITION_SID = HLD.HIERARCHY_DEFINITION_SID
                        INNER JOIN HIERARCHY_LEVEL_VALUES HLV
                                ON HLV.HIERARCHY_LEVEL_DEFINITION_SID = HLD.HIERARCHY_LEVEL_DEFINITION_SID
                        INNER JOIN RELATIONSHIP_LEVEL_DEFINITION RLD
                                ON R.RELATIONSHIP_BUILDER_SID = RLD.RELATIONSHIP_BUILDER_SID
                                   AND RLD.HIERARCHY_LEVEL_DEFINITION_SID = HLD.HIERARCHY_LEVEL_DEFINITION_SID
                       
                        LEFT JOIN HELPER_TABLE H
                               ON H.HELPER_TABLE_SID = R.RELATIONSHIP_TYPE
                                  AND LIST_NAME = 'RELATIONSHIP_TYPE'
)A
         WHERE  RN = 1),
     DEFINED
     AS (SELECT NULL                          AS RN,
                R.RELATIONSHIP_BUILDER_SID,
                RLD.RELATIONSHIP_LEVEL_VALUES AS RELATIONSHIP_TREE,
                R.RELATIONSHIP_NAME,
                R.RELATIONSHIP_DESCRIPTION,
                H.DESCRIPTION                 AS RELATIONSHIP_TYPE,
                HD.HIERARCHY_NAME,
                RLD.LEVEL_NAME                AS HIERARCHY_LEVEL_NAME,
                HD.VERSION_NO                 AS HIERARCHY_VERSION_NO,
                R.START_DATE,
                R.BUILD_TYPE,
                RLD.HIERARCHY_NO,
                RLD.LEVEL_NO,
                RLD.PARENT_NODE
         FROM   RELATIONSHIP_BUILDER R
                INNER JOIN HIERARCHY_DEFINITION HD
                        ON R.HIERARCHY_DEFINITION_SID = HD.HIERARCHY_DEFINITION_SID
                LEFT JOIN HELPER_TABLE H
                       ON H.HELPER_TABLE_SID = R.RELATIONSHIP_TYPE
                          AND LIST_NAME = 'RELATIONSHIP_TYPE'
                INNER JOIN RELATIONSHIP_LEVEL_DEFINITION RLD
                        ON R.RELATIONSHIP_BUILDER_SID = RLD.RELATIONSHIP_BUILDER_SID
               
         WHERE  RLD.LEVEL_NAME NOT IN ( 'SEGMENT', 'SEGMENT GROUP' )
),
     LIN_DEF
     AS (SELECT HIERARCHY_PARENT=Row_number()
                                   OVER (
                                     PARTITION BY A.RELATIONSHIP_BUILDER_SID, Len(HIERARCHY_NO)
                                     ORDER BY A.RELATIONSHIP_BUILDER_SID),
                *
         FROM   (SELECT RELATIONSHIP_BUILDER_SID,
                        RELATIONSHIP_TREE,
                        RELATIONSHIP_NAME,
                        RELATIONSHIP_DESCRIPTION,
                        RELATIONSHIP_TYPE,
                        HIERARCHY_NAME,
                        HIERARCHY_LEVEL_NAME,
                        HIERARCHY_VERSION_NO,
                        START_DATE,
                        BUILD_TYPE,
                        HIERARCHY_NO,
                        LEVEL_NO,
                        PARENT_NODE
                 FROM   LINKED
                 UNION ALL
                 SELECT RELATIONSHIP_BUILDER_SID,
                        RELATIONSHIP_TREE,
                        RELATIONSHIP_NAME,
                        RELATIONSHIP_DESCRIPTION,
                        RELATIONSHIP_TYPE,
                        HIERARCHY_NAME,
                        HIERARCHY_LEVEL_NAME,
                        HIERARCHY_VERSION_NO,
                        START_DATE,
                        BUILD_TYPE,
                        HIERARCHY_NO,
                        LEVEL_NO,
                        PARENT_NODE
                 FROM   DEFINED)A)
SELECT *
FROM   LIN_DEF
ORDER  BY RELATIONSHIP_BUILDER_SID,
          HIERARCHY_PARENT,
          HIERARCHY_NO 


      ]]> 
      </query>
    </entity>
</sql>