<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE xml>
<sql>
	<entity id="getCustomViewCustomerHierarchyCount">
		<query> 
        <![CDATA[
		SELECT
                    count(DISTINCT RLD.LEVEL_NO)
                FROM RELATIONSHIP_BUILDER RB
                JOIN RELATIONSHIP_LEVEL_DEFINITION RLD on RLD.RELATIONSHIP_BUILDER_SID = RB.RELATIONSHIP_BUILDER_SID WHERE
                    RLD.VERSION_NO = RB.VERSION_NO
                    AND RB.RELATIONSHIP_BUILDER_SID = ?
      ]]>
		</query>
	</entity>
        <entity id="getCustomViewCustomerHierarchyData">
		<query> 
        <![CDATA[
            SELECT
                    DISTINCT RLD.LEVEL_NAME,RLD.LEVEL_NO,
                    convert(int,RLD.LEVEL_NO) as TREE_LEVEL_NO,
                    ? as HIERARCHY_INDICATOR,
                    RLD.HIERARCHY_LEVEL_DEFINITION_SID
                FROM RELATIONSHIP_BUILDER RB
                JOIN RELATIONSHIP_LEVEL_DEFINITION RLD on RLD.RELATIONSHIP_BUILDER_SID = RB.RELATIONSHIP_BUILDER_SID WHERE
                    RLD.VERSION_NO = RB.VERSION_NO
                    AND RB.RELATIONSHIP_BUILDER_SID = ?
                    order by convert(int, RLD.level_no) ;
        ]]>

		</query>
	</entity>
        <entity id="getCustomViewDeductionHierarchyCount">
		<query> 
        <![CDATA[
		SELECT
                    count(DISTINCT RLD.LEVEL_NO)
                FROM RELATIONSHIP_BUILDER RB
                JOIN RELATIONSHIP_LEVEL_DEFINITION RLD on RLD.RELATIONSHIP_BUILDER_SID = RB.RELATIONSHIP_BUILDER_SID WHERE
                    RLD.VERSION_NO = RB.VERSION_NO
                    AND RB.DEDUCTION_RELATION = ?
      ]]>
		</query>
	</entity>
        <entity id="getCustomViewDeductionHierarchyData">
		<query> 
        <![CDATA[
            SELECT
                    DISTINCT RLD.LEVEL_NAME,RLD.LEVEL_NO,
                    convert(int,RLD.LEVEL_NO) as TREE_LEVEL_NO,
                    ? as HIERARCHY_INDICATOR,
                    RLD.HIERARCHY_LEVEL_DEFINITION_SID
                FROM RELATIONSHIP_BUILDER RB
                JOIN RELATIONSHIP_LEVEL_DEFINITION RLD on RLD.RELATIONSHIP_BUILDER_SID = RB.RELATIONSHIP_BUILDER_SID WHERE
                    RLD.VERSION_NO = RB.VERSION_NO
                    AND RB.DEDUCTION_RELATION = ?
                    order by convert(int, RLD.level_no) ;
        ]]>

		</query>
	</entity>
        <entity id="getCustomViewNameDuplicateCheck">
		<query> 
        <![CDATA[
        SELECT
		count( distinct CV.CUST_VIEW_MASTER_SID )
	from
		dbo.CUST_VIEW_MASTER CV
	where
		CV.CUST_VIEW_NAME = '?';
   ]]>
		</query>
	</entity>
</sql>
