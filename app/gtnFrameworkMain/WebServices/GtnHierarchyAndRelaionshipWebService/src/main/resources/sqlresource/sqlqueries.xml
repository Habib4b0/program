<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">

<properties>
	<entry key="loadDate">
    <![CDATA[
        ;

WITH cte AS(
	SELECT
		TOP 1 FROM_DATE AS FROM_DATE,
		TO_DATE TO_DATE
	FROM
		forecast_config f
	JOIN HELPER_TABLE h ON
		f.BUSINESS_PROCESS_TYPE = h.HELPER_TABLE_SID
	WHERE
		LIST_NAME LIKE 'BUSINESS_PROCESS_TYPE'
		AND DESCRIPTION = 'Commercial'
	ORDER BY
		VERSION_NO DESC
) SELECT
	Min( period_sid ) AS PERIOD_SID,
	Concat( 'Q', QUARTER, ' - ', YEAR )
FROM
	PERIOD p
WHERE
	EXISTS(
		SELECT
			1
		FROM
			cte c
		WHERE
			p.PERIOD_DATE BETWEEN DATEADD(
				qq,
				DATEDIFF(
					qq,
					0,
					FROM_DATE
				),
				0
			) AND TO_DATE
	)
GROUP BY
	Concat( 'Q', QUARTER, ' - ', YEAR ),
	year,
	QUARTER
ORDER BY
	YEAR,
	QUARTER,
	Concat( 'Q', QUARTER, ' - ', YEAR )
    ]]>

	</entry>
	
	<entry key="loadFromAndToPeriod">
	<![CDATA[
		WITH cte AS (SELECT TOP 1 FROM_DATE AS FROM_DATE, TO_DATE   TO_DATE FROM   forecast_config f JOIN HELPER_TABLE h ON f.BUSINESS_PROCESS_TYPE = h.HELPER_TABLE_SID WHERE  LIST_NAME LIKE 'BUSINESS_PROCESS_TYPE' AND DESCRIPTION = 'Commercial' ORDER  BY VERSION_NO DESC) SELECT Min(period_sid) AS PERIOD_SID, Concat('Q', QUARTER, ' - ', YEAR) FROM   PERIOD p WHERE  EXISTS (SELECT 1 FROM   cte c WHERE  p.PERIOD_DATE BETWEEN DATEADD(qq, DATEDIFF(qq, 0, FROM_DATE), 0) AND TO_DATE) GROUP  BY Concat('Q', QUARTER, ' - ', YEAR), year, QUARTER ORDER  BY YEAR, QUARTER, Concat('Q', QUARTER, ' - ', YEAR) 
	
	]]>
	</entry>
</properties>