<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<sql>
<entity id="PPAResults.dataForTableLoad-Quaterly">
<query> <![CDATA[
		
                
   SELECT p.QUARTER,
       p.YEAR,
       Sum(PA.ACTUAL_DISCOUNT_DOLLAR)                                          AS ACTUAL_DISCOUNT_DOLLAR,
       Sum(ACTUAL_DISCOUNT_DOLLAR) / NULLIF(Sum(SA.actual_sales), 0)       AS RATE,
       Sum(PA.ACTUAL_DISCOUNT_UNITS)                                           AS ACTUAL_DISCOUNT_UNITS,
       Sum(ACTUAL_DISCOUNT_DOLLAR) / NULLIF(Sum(ACTUAL_DISCOUNT_UNITS), 0) AS Discount,
       0                                                                           AS actuals
FROM   projection_details pd
       JOIN PROJECTION_CUST_HIERARCHY ph
         ON pd.PROJECTION_MASTER_SID = ph.PROJECTION_MASTER_SID
       JOIN RELATIONSHIP_LEVEL_DEFINITION rld
         ON ph.RELATIONSHIP_LEVEL_SID = rld.RELATIONSHIP_LEVEL_SID
       JOIN (SELECT LCCP.RELATIONSHIP_LEVEL_SID,
                    LCCP.CCP_DETAILS_SID,
                    LCCP.HIERARCHY_NO
             FROM   (SELECT CCPMAP.CCP_DETAILS_SID,
                            HLD.HIERARCHY_NO,
                            HLD.RELATIONSHIP_LEVEL_SID
                     FROM   (SELECT RLD.RELATIONSHIP_LEVEL_VALUES,
                                    RLD.HIERARCHY_NO,
                                    CCP.CCP_DETAILS_SID
                             FROM   RELATIONSHIP_LEVEL_DEFINITION RLD
                                    JOIN CCP_MAP CCP
                                      ON RLD.RELATIONSHIP_LEVEL_SID = CCP.RELATIONSHIP_LEVEL_SID
                                    JOIN PROJECTION_DETAILS PD
                                      ON PD.CCP_DETAILS_SID = CCP.CCP_DETAILS_SID
                                         AND PD.PROJECTION_MASTER_SID = ?
                                    JOIN PROJECTION_CUST_HIERARCHY PCH1
                                      ON RLD.RELATIONSHIP_LEVEL_SID = PCH1.RELATIONSHIP_LEVEL_SID
                                    JOIN PROJECTION_MASTER PM
                                      ON PCH1.PROJECTION_MASTER_SID = PM.PROJECTION_MASTER_SID
                             WHERE  PM.PROJECTION_MASTER_SID = ?) CCPMAP,
                            (SELECT RLD1.HIERARCHY_NO,
                                    RLD1.RELATIONSHIP_LEVEL_SID
                             FROM   RELATIONSHIP_LEVEL_DEFINITION RLD1
                                    JOIN PROJECTION_CUST_HIERARCHY PCH
                                      ON PCH.RELATIONSHIP_LEVEL_SID = RLD1.RELATIONSHIP_LEVEL_SID
                                         AND PCH.PROJECTION_MASTER_SID = ?
                             WHERE  RLD1.HIERARCHY_NO LIKE '?%') HLD
                     WHERE  CCPMAP.HIERARCHY_NO LIKE HLD.HIERARCHY_NO + '%') LCCP
             WHERE  LCCP.HIERARCHY_NO IN (SELECT RLD2.HIERARCHY_NO
                                          FROM   RELATIONSHIP_LEVEL_DEFINITION RLD2
                                                 JOIN PROJECTION_CUST_HIERARCHY PCH2
                                                   ON PCH2.RELATIONSHIP_LEVEL_SID = RLD2.RELATIONSHIP_LEVEL_SID
                                                      AND PCH2.PROJECTION_MASTER_SID = ?
                                          WHERE  RLD2.LEVEL_NO = ?)) CCP
         ON CCP.CCP_DETAILS_SID = pd.CCP_DETAILS_SID
            AND CCP.RELATIONSHIP_LEVEL_SID = rld.RELATIONSHIP_LEVEL_SID
       JOIN ST_NM_PPA_PROJECTION_MASTER A
         ON pd.PROJECTION_DETAILS_SID = A.PROJECTION_DETAILS_SID
       JOIN ST_NM_ACTUAL_PPA PA
         ON pd.PROJECTION_DETAILS_SID = PA.PROJECTION_DETAILS_SID
       JOIN ST_NM_ACTUAL_SALES SA
         ON pd.PROJECTION_DETAILS_SID = SA.PROJECTION_DETAILS_SID
       JOIN PERIOD p
         ON p.period_sid = PA.PERIOD_SID
            AND p.PERIOD_SID = SA.PERIOD_SID
WHERE  pd.PROJECTION_MASTER_SID = ?
       AND rld.LEVEL_NO = '?'
       AND Isnull(A.USER_GROUP, '0') LIKE '?'
       AND PERIOD_DATE BETWEEN CONVERT(DATE, '?') AND CONVERT(DATE, '?')
GROUP  BY p.QUARTER,
          p."YEAR"


UNION
SELECT p.QUARTER,
       p.YEAR,
       Sum(PA.PROJECTION_DISCOUNT_DOLLAR)                                          AS PROJECTION_DISCOUNT_DOLLAR1,
       Sum(PROJECTION_DISCOUNT_DOLLAR) / NULLIF(Sum(SA.projection_sales), 0)       AS RATE,
       Sum(PA.PROJECTION_DISCOUNT_UNITS)                                           AS PROJECTION_DISCOUNT_UNITS1,
       Sum(PROJECTION_DISCOUNT_DOLLAR) / NULLIF(Sum(PROJECTION_DISCOUNT_UNITS), 0) AS Discount,
       1                                                                           AS actuals
FROM   projection_details pd
       JOIN PROJECTION_CUST_HIERARCHY ph
         ON pd.PROJECTION_MASTER_SID = ph.PROJECTION_MASTER_SID
       JOIN RELATIONSHIP_LEVEL_DEFINITION rld
         ON ph.RELATIONSHIP_LEVEL_SID = rld.RELATIONSHIP_LEVEL_SID
       JOIN (SELECT LCCP.RELATIONSHIP_LEVEL_SID,
                    LCCP.CCP_DETAILS_SID,
                    LCCP.HIERARCHY_NO
             FROM   (SELECT CCPMAP.CCP_DETAILS_SID,
                            HLD.HIERARCHY_NO,
                            HLD.RELATIONSHIP_LEVEL_SID
                     FROM   (SELECT RLD.RELATIONSHIP_LEVEL_VALUES,
                                    RLD.HIERARCHY_NO,
                                    CCP.CCP_DETAILS_SID
                             FROM   RELATIONSHIP_LEVEL_DEFINITION RLD
                                    JOIN CCP_MAP CCP
                                      ON RLD.RELATIONSHIP_LEVEL_SID = CCP.RELATIONSHIP_LEVEL_SID
                                    JOIN PROJECTION_DETAILS PD
                                      ON PD.CCP_DETAILS_SID = CCP.CCP_DETAILS_SID
                                         AND PD.PROJECTION_MASTER_SID = ?
                                    JOIN PROJECTION_CUST_HIERARCHY PCH1
                                      ON RLD.RELATIONSHIP_LEVEL_SID = PCH1.RELATIONSHIP_LEVEL_SID
                                    JOIN PROJECTION_MASTER PM
                                      ON PCH1.PROJECTION_MASTER_SID = PM.PROJECTION_MASTER_SID
                             WHERE  PM.PROJECTION_MASTER_SID = ?) CCPMAP,
                            (SELECT RLD1.HIERARCHY_NO,
                                    RLD1.RELATIONSHIP_LEVEL_SID
                             FROM   RELATIONSHIP_LEVEL_DEFINITION RLD1
                                    JOIN PROJECTION_CUST_HIERARCHY PCH
                                      ON PCH.RELATIONSHIP_LEVEL_SID = RLD1.RELATIONSHIP_LEVEL_SID
                                         AND PCH.PROJECTION_MASTER_SID = ?
                             WHERE  RLD1.HIERARCHY_NO LIKE '?%') HLD
                     WHERE  CCPMAP.HIERARCHY_NO LIKE HLD.HIERARCHY_NO + '%') LCCP
             WHERE  LCCP.HIERARCHY_NO IN (SELECT RLD2.HIERARCHY_NO
                                          FROM   RELATIONSHIP_LEVEL_DEFINITION RLD2
                                                 JOIN PROJECTION_CUST_HIERARCHY PCH2
                                                   ON PCH2.RELATIONSHIP_LEVEL_SID = RLD2.RELATIONSHIP_LEVEL_SID
                                                      AND PCH2.PROJECTION_MASTER_SID = ?
                                          WHERE  RLD2.LEVEL_NO = ?)) CCP
         ON CCP.CCP_DETAILS_SID = pd.CCP_DETAILS_SID
            AND CCP.RELATIONSHIP_LEVEL_SID = rld.RELATIONSHIP_LEVEL_SID
       JOIN ST_NM_PPA_PROJECTION_MASTER A
         ON pd.PROJECTION_DETAILS_SID = A.PROJECTION_DETAILS_SID
       JOIN ST_NM_PPA_PROJECTION PA
         ON pd.PROJECTION_DETAILS_SID = PA.PROJECTION_DETAILS_SID
       JOIN ST_NM_SALES_PROJECTION SA
         ON pd.PROJECTION_DETAILS_SID = SA.PROJECTION_DETAILS_SID
       JOIN PERIOD p
         ON p.period_sid = PA.PERIOD_SID
            AND p.PERIOD_SID = SA.PERIOD_SID
WHERE  pd.PROJECTION_MASTER_SID = ?
       AND rld.LEVEL_NO = '?'
       AND Isnull(A.USER_GROUP, '0') LIKE '?'
       AND PERIOD_DATE BETWEEN CONVERT(DATE, '?') AND CONVERT(DATE, '?')
GROUP  BY p.QUARTER,
          p."YEAR"
ORDER  BY YEAR,p.QUARTER; 

		
    ]]> </query>
</entity>
<entity id="PPAResults.dataForTableLoad-Quaterly1">
<query> <![CDATA[
		
                
   DECLARE @RELATIONSHIPBUILDERSHIPSID INT =?,
        @PROJECTIONMASTERSID    INT =?,
		@HIERARCHY_NO VARCHAR(100)= '?%',
		@LEVEL_NO INT=?,
		@USER_GROUP VARCHAR(50)='?',
		@START_DATE VARCHAR(50)='?',
		@END_DATE VARCHAR(50)='?'

DECLARE @CCP TABLE
  (
     PROJECTION_DETAILS_SID INT
  )

INSERT INTO @CCP
            (PROJECTION_DETAILS_SID)
SELECT distinct PD.PROJECTION_DETAILS_SID AS PROJECTION_DETAILS_SID
FROM   RELATIONSHIP_LEVEL_DEFINITION RLD
       JOIN PROJECTION_CUST_HIERARCHY PCH
         ON PCH.PROJECTION_MASTER_SID = @PROJECTIONMASTERSID
            AND RLD.RELATIONSHIP_LEVEL_SID = PCH.RELATIONSHIP_LEVEL_SID
            AND RLD.RELATIONSHIP_BUILDER_SID = @RELATIONSHIPBUILDERSHIPSID
       JOIN RELATIONSHIP_LEVEL_DEFINITION RLD1
         ON RLD1.HIERARCHY_NO LIKE @HIERARCHY_NO
            AND RLD.RELATIONSHIP_BUILDER_SID = RLD1.RELATIONSHIP_BUILDER_SID
            AND RLD.HIERARCHY_NO LIKE RLD1.HIERARCHY_NO + '%'
            AND RLD1.LEVEL_NO = @LEVEL_NO
       JOIN CCP_MAP CCPMAP
         ON CCPMAP.RELATIONSHIP_LEVEL_SID = RLD.RELATIONSHIP_LEVEL_SID
       JOIN PROJECTION_DETAILS PD
         ON PD.CCP_DETAILS_SID = CCPMAP.CCP_DETAILS_SID
       JOIN ST_NM_PPA_PROJECTION_MASTER A
         ON pd.PROJECTION_DETAILS_SID = A.PROJECTION_DETAILS_SID
            AND Isnull(A.USER_GROUP, '0') LIKE @USER_GROUP;

SELECT QUARTER
       ,YEAR
       ,SUM(DOLLAR) ACTUAL_DISCOUNT_DOLLAR
       ,SUM(DOLLAR)/NULLIF(SUM(SALE),0) RATE
       ,SUM(UNIT) PROJECTION_DISCOUNT_UNITS1
       ,SUM(DOLLAR)/NULLIF(SUM(UNIT),0) DISCOUNT
       ,0 ACTUALS
	   FROM (
SELECT QUARTER,YEAR,SUM(DOLLAR) DOLLAR,MIN(NULLIF(UNIT,0)) UNIT,MIN(NULLIF(SALES,0)) SALE,SUM(UNIT) UNITS,SUM(SALES) SALES,PROJECTION_DETAILS_SID FROM (
       SELECT SUM(ACTUAL_DISCOUNT_DOLLAR) DOLLAR
              ,SUM(SP.ACTUAL_UNITS) UNIT
              ,SUM(SP.ACTUAL_SALES) SALES
              ,S.RS_MODEL_SID
              ,P.QUARTER 
              ,P.YEAR
			  ,S.PROJECTION_DETAILS_SID
      	FROM ST_NM_ACTUAL_PPA S
		LEFT JOIN ST_NM_ACTUAL_SALES SP ON SP.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
			AND SP.PERIOD_SID = S.PERIOD_SID
		JOIN PERIOD P ON P.PERIOD_SID = S.PERIOD_SID
		JOIN @CCP C ON C.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
		GROUP BY S.PROJECTION_DETAILS_SID
			,S.RS_MODEL_SID
			,P.QUARTER
			,P.YEAR ) A
			  GROUP BY PROJECTION_DETAILS_SID,YEAR
       ,QUARTER) B 
GROUP BY YEAR
       ,QUARTER

UNION

SELECT QUARTER
       ,YEAR
       ,SUM(DOLLAR) PROJECTION_DISCOUNT_DOLLAR1
       ,SUM(DOLLAR)/NULLIF(SUM(SALES),0)
       ,SUM(UNIT) PROJECTION_DISCOUNT_UNITS1
       ,SUM(DOLLAR)/NULLIF(SUM(UNIT),0) 
       ,1 ACTUALS
	   FROM
	   (
SELECT PROJECTION_DETAILS_SID,MIN(NULLIF(UNIT,0)) UNIT,MIN(NULLIF(SALES,0)) SALES,SUM(UNIT) UNITS ,SUM(DOLLAR) DOLLAR,SUM(SALES) SALE,QUARTER,YEAR FROM (
       SELECT SUM(PROJECTION_DISCOUNT_DOLLAR) DOLLAR
              ,SUM(SP.PROJECTION_UNITS) UNIT
              ,SUM(SP.PROJECTION_SALES) SALES
              ,S.RS_MODEL_SID
              ,P.QUARTER 
              ,P.YEAR
			  ,S.PROJECTION_DETAILS_SID
      FROM ST_NM_PPA_PROJECTION S
		LEFT JOIN ST_NM_SALES_PROJECTION SP ON SP.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
			AND SP.PERIOD_SID = S.PERIOD_SID
		JOIN PERIOD P ON P.PERIOD_SID = S.PERIOD_SID
		JOIN @CCP C ON C.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
		GROUP BY S.PROJECTION_DETAILS_SID
			,S.RS_MODEL_SID
			,P.QUARTER
			,P.YEAR
       ) A
	   GROUP BY PROJECTION_DETAILS_SID,QUARTER,YEAR) B
	   GROUP BY YEAR
       ,QUARTER
ORDER BY YEAR
       ,QUARTER

		
    ]]> </query>
</entity>
<entity id="PPAResults.dataForTableLoad-Annually">
<query> <![CDATA[
		
                
     DECLARE @RELATIONSHIPBUILDERSHIPSID INT =?,
        @PROJECTIONMASTERSID    INT =?,
		@HIERARCHY_NO VARCHAR(100)= '?%',
		@LEVEL_NO INT=?,
		@USER_GROUP VARCHAR(50)='?',
		@START_DATE VARCHAR(50)='?',
		@END_DATE VARCHAR(50)='?'

DECLARE @CCP TABLE
  (
     PROJECTION_DETAILS_SID INT
  )

INSERT INTO @CCP
            (PROJECTION_DETAILS_SID)
SELECT distinct PD.PROJECTION_DETAILS_SID AS PROJECTION_DETAILS_SID
FROM   RELATIONSHIP_LEVEL_DEFINITION RLD
       JOIN PROJECTION_CUST_HIERARCHY PCH
         ON PCH.PROJECTION_MASTER_SID = @PROJECTIONMASTERSID
            AND RLD.RELATIONSHIP_LEVEL_SID = PCH.RELATIONSHIP_LEVEL_SID
            AND RLD.RELATIONSHIP_BUILDER_SID = @RELATIONSHIPBUILDERSHIPSID
       JOIN RELATIONSHIP_LEVEL_DEFINITION RLD1
         ON RLD1.HIERARCHY_NO LIKE @HIERARCHY_NO
            AND RLD.RELATIONSHIP_BUILDER_SID = RLD1.RELATIONSHIP_BUILDER_SID
            AND RLD.HIERARCHY_NO LIKE RLD1.HIERARCHY_NO + '%'
            AND RLD1.LEVEL_NO = @LEVEL_NO
       JOIN CCP_MAP CCPMAP
         ON CCPMAP.RELATIONSHIP_LEVEL_SID = RLD.RELATIONSHIP_LEVEL_SID
       JOIN PROJECTION_DETAILS PD
         ON PD.CCP_DETAILS_SID = CCPMAP.CCP_DETAILS_SID
       JOIN ST_NM_PPA_PROJECTION_MASTER A
         ON pd.PROJECTION_DETAILS_SID = A.PROJECTION_DETAILS_SID
            AND Isnull(A.USER_GROUP, '0') LIKE @USER_GROUP;
   
SELECT YEAR1
       ,YEAR
       ,SUM(DOLLAR) ACTUAL_DISCOUNT_DOLLAR
       ,SUM(DOLLAR)/NULLIF(SUM(SALE),0) RATE
       ,SUM(UNIT) PROJECTION_DISCOUNT_UNITS1
       ,SUM(DOLLAR)/NULLIF(SUM(UNIT),0) DISCOUNT
       ,0 ACTUALS
	   FROM (
SELECT YEAR1,YEAR,SUM(DOLLAR) DOLLAR,MIN(NULLIF(UNIT,0)) UNIT,MIN(NULLIF(SALES,0)) SALE,SUM(UNIT) UNITS,SUM(SALES) SALES,PROJECTION_DETAILS_SID FROM (
       SELECT SUM(ACTUAL_DISCOUNT_DOLLAR) DOLLAR
              ,SUM(SP.ACTUAL_UNITS) UNIT
              ,SUM(SP.ACTUAL_SALES) SALES
              ,S.RS_MODEL_SID
              ,P.YEAR YEAR1 
              ,P.YEAR
			  ,S.PROJECTION_DETAILS_SID
      	FROM ST_NM_ACTUAL_PPA S
		LEFT JOIN ST_NM_ACTUAL_SALES SP ON SP.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
			AND SP.PERIOD_SID = S.PERIOD_SID
		JOIN PERIOD P ON P.PERIOD_SID = S.PERIOD_SID
		JOIN @CCP C ON C.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
		GROUP BY S.PROJECTION_DETAILS_SID
			,S.RS_MODEL_SID
			,P.YEAR ) A
			  GROUP BY PROJECTION_DETAILS_SID,YEAR
       ,YEAR1) B 
GROUP BY YEAR
       ,YEAR1

UNION

SELECT YEAR1
       ,YEAR
       ,SUM(DOLLAR) PROJECTION_DISCOUNT_DOLLAR1
       ,SUM(DOLLAR)/NULLIF(SUM(SALES),0)
       ,SUM(UNIT) PROJECTION_DISCOUNT_UNITS1
       ,SUM(DOLLAR)/NULLIF(SUM(UNIT),0) 
       ,1 ACTUALS
	   FROM
	   (
SELECT PROJECTION_DETAILS_SID,MIN(NULLIF(UNIT,0)) UNIT,MIN(NULLIF(SALES,0)) SALES,SUM(UNIT) UNITS ,SUM(DOLLAR) DOLLAR,SUM(SALES) SALE,YEAR1,YEAR FROM (
       SELECT SUM(PROJECTION_DISCOUNT_DOLLAR) DOLLAR
              ,SUM(SP.PROJECTION_UNITS) UNIT
              ,SUM(SP.PROJECTION_SALES) SALES
              ,S.RS_MODEL_SID
              ,P.YEAR YEAR1 
              ,P.YEAR
			  ,S.PROJECTION_DETAILS_SID
      FROM ST_NM_PPA_PROJECTION S
		LEFT JOIN ST_NM_SALES_PROJECTION SP ON SP.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
			AND SP.PERIOD_SID = S.PERIOD_SID
		JOIN PERIOD P ON P.PERIOD_SID = S.PERIOD_SID
		JOIN @CCP C ON C.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
		GROUP BY S.PROJECTION_DETAILS_SID
			,S.RS_MODEL_SID
			,P.YEAR
       ) A
	   GROUP BY PROJECTION_DETAILS_SID,YEAR1,YEAR) B
	   GROUP BY YEAR
       ,YEAR1
ORDER BY YEAR
       ,YEAR1;

		
    ]]> </query>
</entity>
<entity id="PPAResults.Customer-Semi-Annual">
<query> <![CDATA[
		
              
    DECLARE @RELATIONSHIPBUILDERSHIPSID INT =?,
        @PROJECTIONMASTERSID    INT =?,
		@HIERARCHY_NO VARCHAR(100)= '?%',
		@LEVEL_NO INT=?,
		@USER_GROUP VARCHAR(50)='?',
		@START_DATE VARCHAR(50)='?',
		@END_DATE VARCHAR(50)='?'

DECLARE @CCP TABLE
  (
     PROJECTION_DETAILS_SID INT
  )

INSERT INTO @CCP
            (PROJECTION_DETAILS_SID)
SELECT distinct PD.PROJECTION_DETAILS_SID AS PROJECTION_DETAILS_SID
FROM   RELATIONSHIP_LEVEL_DEFINITION RLD
       JOIN PROJECTION_CUST_HIERARCHY PCH
         ON PCH.PROJECTION_MASTER_SID = @PROJECTIONMASTERSID
            AND RLD.RELATIONSHIP_LEVEL_SID = PCH.RELATIONSHIP_LEVEL_SID
            AND RLD.RELATIONSHIP_BUILDER_SID = @RELATIONSHIPBUILDERSHIPSID
       JOIN RELATIONSHIP_LEVEL_DEFINITION RLD1
         ON RLD1.HIERARCHY_NO LIKE @HIERARCHY_NO
            AND RLD.RELATIONSHIP_BUILDER_SID = RLD1.RELATIONSHIP_BUILDER_SID
            AND RLD.HIERARCHY_NO LIKE RLD1.HIERARCHY_NO + '%'
            AND RLD1.LEVEL_NO = @LEVEL_NO
       JOIN CCP_MAP CCPMAP
         ON CCPMAP.RELATIONSHIP_LEVEL_SID = RLD.RELATIONSHIP_LEVEL_SID
       JOIN PROJECTION_DETAILS PD
         ON PD.CCP_DETAILS_SID = CCPMAP.CCP_DETAILS_SID
       JOIN ST_NM_PPA_PROJECTION_MASTER A
         ON pd.PROJECTION_DETAILS_SID = A.PROJECTION_DETAILS_SID
            AND Isnull(A.USER_GROUP, '0') LIKE @USER_GROUP;

SELECT SEMI_ANNUAL
       ,YEAR
       ,SUM(DOLLAR) ACTUAL_DISCOUNT_DOLLAR
       ,SUM(DOLLAR)/NULLIF(SUM(SALE),0) RATE
       ,SUM(UNIT) PROJECTION_DISCOUNT_UNITS1
       ,SUM(DOLLAR)/NULLIF(SUM(UNIT),0) DISCOUNT
       ,0 ACTUALS
	   FROM (
SELECT SEMI_ANNUAL,YEAR,SUM(DOLLAR) DOLLAR,MIN(NULLIF(UNIT,0)) UNIT,MIN(NULLIF(SALES,0)) SALE,SUM(UNIT) UNITS,SUM(SALES) SALES,PROJECTION_DETAILS_SID FROM (
       SELECT SUM(ACTUAL_DISCOUNT_DOLLAR) DOLLAR
              ,SUM(SP.ACTUAL_UNITS) UNIT
              ,SUM(SP.ACTUAL_SALES) SALES
              ,S.RS_MODEL_SID
              ,P.SEMI_ANNUAL 
              ,P.YEAR
			  ,S.PROJECTION_DETAILS_SID
      	FROM ST_NM_ACTUAL_PPA S
		LEFT JOIN ST_NM_ACTUAL_SALES SP ON SP.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
			AND SP.PERIOD_SID = S.PERIOD_SID
		JOIN PERIOD P ON P.PERIOD_SID = S.PERIOD_SID
		JOIN @CCP C ON C.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
		GROUP BY S.PROJECTION_DETAILS_SID
			,S.RS_MODEL_SID
			,P.SEMI_ANNUAL
			,P.YEAR ) A
			  GROUP BY PROJECTION_DETAILS_SID,YEAR
       ,SEMI_ANNUAL) B 
GROUP BY YEAR
       ,SEMI_ANNUAL

UNION

SELECT SEMI_ANNUAL
       ,YEAR
       ,SUM(DOLLAR) PROJECTION_DISCOUNT_DOLLAR1
       ,SUM(DOLLAR)/NULLIF(SUM(SALES),0)
       ,SUM(UNIT) PROJECTION_DISCOUNT_UNITS1
       ,SUM(DOLLAR)/NULLIF(SUM(UNIT),0) 
       ,1 ACTUALS
	   FROM
	   (
SELECT PROJECTION_DETAILS_SID,MIN(NULLIF(UNIT,0)) UNIT,MIN(NULLIF(SALES,0)) SALES,SUM(UNIT) UNITS ,SUM(DOLLAR) DOLLAR,SUM(SALES) SALE,SEMI_ANNUAL,YEAR FROM (
       SELECT SUM(PROJECTION_DISCOUNT_DOLLAR) DOLLAR
              ,SUM(SP.PROJECTION_UNITS) UNIT
              ,SUM(SP.PROJECTION_SALES) SALES
              ,S.RS_MODEL_SID
              ,P.SEMI_ANNUAL 
              ,P.YEAR
			  ,S.PROJECTION_DETAILS_SID
      FROM ST_NM_PPA_PROJECTION S
		LEFT JOIN ST_NM_SALES_PROJECTION SP ON SP.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
			AND SP.PERIOD_SID = S.PERIOD_SID
		JOIN PERIOD P ON P.PERIOD_SID = S.PERIOD_SID
		JOIN @CCP C ON C.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
		GROUP BY S.PROJECTION_DETAILS_SID
			,S.RS_MODEL_SID
			,P.SEMI_ANNUAL
			,P.YEAR
       ) A
	   GROUP BY PROJECTION_DETAILS_SID,SEMI_ANNUAL,YEAR) B
	   GROUP BY YEAR
       ,SEMI_ANNUAL
ORDER BY YEAR
       ,SEMI_ANNUAL

		
    ]]> </query>
</entity>
<entity id="PPAResults.Monthly-Customer">
<query> <![CDATA[
		
               

      DECLARE @RELATIONSHIPBUILDERSHIPSID INT =?,
        @PROJECTIONMASTERSID    INT =?,
		@HIERARCHY_NO VARCHAR(100)= '?%',
		@LEVEL_NO INT=?,
		@USER_GROUP VARCHAR(50)='?',
		@START_DATE VARCHAR(50)='?',
		@END_DATE VARCHAR(50)='?'

DECLARE @CCP TABLE
  (
     PROJECTION_DETAILS_SID INT
  )

INSERT INTO @CCP
            (PROJECTION_DETAILS_SID)
SELECT distinct PD.PROJECTION_DETAILS_SID AS PROJECTION_DETAILS_SID
FROM   RELATIONSHIP_LEVEL_DEFINITION RLD
       JOIN PROJECTION_CUST_HIERARCHY PCH
         ON PCH.PROJECTION_MASTER_SID = @PROJECTIONMASTERSID
            AND RLD.RELATIONSHIP_LEVEL_SID = PCH.RELATIONSHIP_LEVEL_SID
            AND RLD.RELATIONSHIP_BUILDER_SID = @RELATIONSHIPBUILDERSHIPSID
       JOIN RELATIONSHIP_LEVEL_DEFINITION RLD1
         ON RLD1.HIERARCHY_NO LIKE @HIERARCHY_NO
            AND RLD.RELATIONSHIP_BUILDER_SID = RLD1.RELATIONSHIP_BUILDER_SID
            AND RLD.HIERARCHY_NO LIKE RLD1.HIERARCHY_NO + '%'
            AND RLD1.LEVEL_NO = @LEVEL_NO
       JOIN CCP_MAP CCPMAP
         ON CCPMAP.RELATIONSHIP_LEVEL_SID = RLD.RELATIONSHIP_LEVEL_SID
       JOIN PROJECTION_DETAILS PD
         ON PD.CCP_DETAILS_SID = CCPMAP.CCP_DETAILS_SID
       JOIN ST_NM_PPA_PROJECTION_MASTER A
         ON pd.PROJECTION_DETAILS_SID = A.PROJECTION_DETAILS_SID
            AND Isnull(A.USER_GROUP, '0') LIKE @USER_GROUP;

SELECT MONTH
       ,YEAR
       ,SUM(DOLLAR) ACTUAL_DISCOUNT_DOLLAR
       ,SUM(DOLLAR)/NULLIF(SUM(SALE),0) RATE
       ,SUM(UNIT) PROJECTION_DISCOUNT_UNITS1
       ,SUM(DOLLAR)/NULLIF(SUM(UNIT),0) DISCOUNT
       ,0 ACTUALS
	   FROM (
SELECT MONTH,YEAR,SUM(DOLLAR) DOLLAR,MIN(NULLIF(UNIT,0)) UNIT,MIN(NULLIF(SALES,0)) SALE,SUM(UNIT) UNITS,SUM(SALES) SALES,PROJECTION_DETAILS_SID FROM (
       SELECT SUM(ACTUAL_DISCOUNT_DOLLAR) DOLLAR
              ,SUM(SP.ACTUAL_UNITS) UNIT
              ,SUM(SP.ACTUAL_SALES) SALES
              ,S.RS_MODEL_SID
              ,P.MONTH 
              ,P.YEAR
			  ,S.PROJECTION_DETAILS_SID
      	FROM ST_NM_ACTUAL_PPA S
		LEFT JOIN ST_NM_ACTUAL_SALES SP ON SP.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
			AND SP.PERIOD_SID = S.PERIOD_SID
		JOIN PERIOD P ON P.PERIOD_SID = S.PERIOD_SID
		JOIN @CCP C ON C.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
		GROUP BY S.PROJECTION_DETAILS_SID
			,S.RS_MODEL_SID
			,P.MONTH
			,P.YEAR ) A
			  GROUP BY PROJECTION_DETAILS_SID,YEAR
       ,MONTH) B 
GROUP BY YEAR
       ,MONTH

UNION

SELECT MONTH
       ,YEAR
       ,SUM(DOLLAR) PROJECTION_DISCOUNT_DOLLAR1
       ,SUM(DOLLAR)/NULLIF(SUM(SALES),0)
       ,SUM(UNIT) PROJECTION_DISCOUNT_UNITS1
       ,SUM(DOLLAR)/NULLIF(SUM(UNIT),0) 
       ,1 ACTUALS
	   FROM
	   (
SELECT PROJECTION_DETAILS_SID,MIN(NULLIF(UNIT,0)) UNIT,MIN(NULLIF(SALES,0)) SALES,SUM(UNIT) UNITS ,SUM(DOLLAR) DOLLAR,SUM(SALES) SALE,MONTH,YEAR FROM (
       SELECT SUM(PROJECTION_DISCOUNT_DOLLAR) DOLLAR
              ,SUM(SP.PROJECTION_UNITS) UNIT
              ,SUM(SP.PROJECTION_SALES) SALES
              ,S.RS_MODEL_SID
              ,P.MONTH 
              ,P.YEAR
			  ,S.PROJECTION_DETAILS_SID
      FROM ST_NM_PPA_PROJECTION S
		LEFT JOIN ST_NM_SALES_PROJECTION SP ON SP.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
			AND SP.PERIOD_SID = S.PERIOD_SID
		JOIN PERIOD P ON P.PERIOD_SID = S.PERIOD_SID
		JOIN @CCP C ON C.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
		GROUP BY S.PROJECTION_DETAILS_SID
			,S.RS_MODEL_SID
			,P.MONTH
			,P.YEAR
       ) A
	   GROUP BY PROJECTION_DETAILS_SID,MONTH,YEAR) B
	   GROUP BY YEAR
       ,MONTH
ORDER BY YEAR
       ,MONTH
		
    ]]> </query>
</entity>
<entity id="PPAResults.Monthly-Product">
<query> <![CDATA[
		
               

    DECLARE @RELATIONSHIPBUILDERSHIPSID INT =?,
        @PROJECTIONMASTERSID    INT =?,
		@HIERARCHY_NO VARCHAR(100)= '?%',
		@LEVEL_NO INT=?,
		
		@START_DATE VARCHAR(50)='?',
		@END_DATE VARCHAR(50)='?'

DECLARE @CCP TABLE
  (
     PROJECTION_DETAILS_SID INT
  )

INSERT INTO @CCP
            (PROJECTION_DETAILS_SID)
SELECT distinct PD.PROJECTION_DETAILS_SID AS PROJECTION_DETAILS_SID
FROM   RELATIONSHIP_LEVEL_DEFINITION RLD
       JOIN PROJECTION_PROD_HIERARCHY PCH
         ON PCH.PROJECTION_MASTER_SID = @PROJECTIONMASTERSID
            AND RLD.RELATIONSHIP_LEVEL_SID = PCH.RELATIONSHIP_LEVEL_SID
            AND RLD.RELATIONSHIP_BUILDER_SID = @RELATIONSHIPBUILDERSHIPSID
       JOIN RELATIONSHIP_LEVEL_DEFINITION RLD1
         ON RLD1.HIERARCHY_NO LIKE @HIERARCHY_NO
            AND RLD.RELATIONSHIP_BUILDER_SID = RLD1.RELATIONSHIP_BUILDER_SID
            AND RLD.HIERARCHY_NO LIKE RLD1.HIERARCHY_NO + '%'
            AND RLD1.LEVEL_NO = @LEVEL_NO
       JOIN CCP_MAP CCPMAP
         ON CCPMAP.RELATIONSHIP_LEVEL_SID = RLD.RELATIONSHIP_LEVEL_SID
       JOIN PROJECTION_DETAILS PD
         ON PD.CCP_DETAILS_SID = CCPMAP.CCP_DETAILS_SID
       JOIN ST_NM_PPA_PROJECTION_MASTER A
         ON pd.PROJECTION_DETAILS_SID = A.PROJECTION_DETAILS_SID;
          
          SELECT MONTH
       ,YEAR
       ,SUM(DOLLAR) ACTUAL_DISCOUNT_DOLLAR
       ,SUM(DOLLAR)/NULLIF(SUM(SALE),0) RATE
       ,SUM(UNIT) PROJECTION_DISCOUNT_UNITS1
       ,SUM(DOLLAR)/NULLIF(SUM(UNIT),0) DISCOUNT
       ,0 ACTUALS
	   FROM (
SELECT MONTH,YEAR,SUM(DOLLAR) DOLLAR,MIN(NULLIF(UNIT,0)) UNIT,MIN(NULLIF(SALES,0)) SALE,SUM(UNIT) UNITS,SUM(SALES) SALES,PROJECTION_DETAILS_SID FROM (
       SELECT SUM(ACTUAL_DISCOUNT_DOLLAR) DOLLAR
              ,SUM(SP.ACTUAL_UNITS) UNIT
              ,SUM(SP.ACTUAL_SALES) SALES
              ,S.RS_MODEL_SID
              ,P.MONTH 
              ,P.YEAR
			  ,S.PROJECTION_DETAILS_SID
      	FROM ST_NM_ACTUAL_PPA S
		LEFT JOIN ST_NM_ACTUAL_SALES SP ON SP.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
			AND SP.PERIOD_SID = S.PERIOD_SID
		JOIN PERIOD P ON P.PERIOD_SID = S.PERIOD_SID
		JOIN @CCP C ON C.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
		GROUP BY S.PROJECTION_DETAILS_SID
			,S.RS_MODEL_SID
			,P.MONTH
			,P.YEAR ) A
			  GROUP BY PROJECTION_DETAILS_SID,YEAR
       ,MONTH) B 
GROUP BY YEAR
       ,MONTH

UNION

SELECT MONTH
       ,YEAR
       ,SUM(DOLLAR) PROJECTION_DISCOUNT_DOLLAR1
       ,SUM(DOLLAR)/NULLIF(SUM(SALES),0)
       ,SUM(UNIT) PROJECTION_DISCOUNT_UNITS1
       ,SUM(DOLLAR)/NULLIF(SUM(UNIT),0) 
       ,1 ACTUALS
	   FROM
	   (
SELECT PROJECTION_DETAILS_SID,MIN(NULLIF(UNIT,0)) UNIT,MIN(NULLIF(SALES,0)) SALES,SUM(UNIT) UNITS ,SUM(DOLLAR) DOLLAR,SUM(SALES) SALE,MONTH,YEAR FROM (
       SELECT SUM(PROJECTION_DISCOUNT_DOLLAR) DOLLAR
              ,SUM(SP.PROJECTION_UNITS) UNIT
              ,SUM(SP.PROJECTION_SALES) SALES
              ,S.RS_MODEL_SID
              ,P.MONTH 
              ,P.YEAR
			  ,S.PROJECTION_DETAILS_SID
      FROM ST_NM_PPA_PROJECTION S
		LEFT JOIN ST_NM_SALES_PROJECTION SP ON SP.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
			AND SP.PERIOD_SID = S.PERIOD_SID
		JOIN PERIOD P ON P.PERIOD_SID = S.PERIOD_SID
		JOIN @CCP C ON C.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
		GROUP BY S.PROJECTION_DETAILS_SID
			,S.RS_MODEL_SID
			,P.MONTH
			,P.YEAR
       ) A
	   GROUP BY PROJECTION_DETAILS_SID,MONTH,YEAR) B
	   GROUP BY YEAR
       ,MONTH
ORDER BY YEAR
       ,MONTH;
		
    ]]> </query>
</entity>
<entity id="PPAResults.dataForTableLoad-Quaterly-Product">
<query> <![CDATA[
		
                
   DECLARE @RELATIONSHIPBUILDERSHIPSID INT =?,
        @PROJECTIONMASTERSID    INT =?,
		@HIERARCHY_NO VARCHAR(100)= '?%',
		@LEVEL_NO INT=?,
		
		@START_DATE VARCHAR(50)='?',
		@END_DATE VARCHAR(50)='?'

DECLARE @CCP TABLE
  (
     PROJECTION_DETAILS_SID INT
  )

INSERT INTO @CCP
            (PROJECTION_DETAILS_SID)
SELECT distinct PD.PROJECTION_DETAILS_SID AS PROJECTION_DETAILS_SID
FROM   RELATIONSHIP_LEVEL_DEFINITION RLD
       JOIN PROJECTION_PROD_HIERARCHY PCH
         ON PCH.PROJECTION_MASTER_SID = @PROJECTIONMASTERSID
            AND RLD.RELATIONSHIP_LEVEL_SID = PCH.RELATIONSHIP_LEVEL_SID
            AND RLD.RELATIONSHIP_BUILDER_SID = @RELATIONSHIPBUILDERSHIPSID
       JOIN RELATIONSHIP_LEVEL_DEFINITION RLD1
         ON RLD1.HIERARCHY_NO LIKE @HIERARCHY_NO
            AND RLD.RELATIONSHIP_BUILDER_SID = RLD1.RELATIONSHIP_BUILDER_SID
            AND RLD.HIERARCHY_NO LIKE RLD1.HIERARCHY_NO + '%'
            AND RLD1.LEVEL_NO = @LEVEL_NO
       JOIN CCP_MAP CCPMAP
         ON CCPMAP.RELATIONSHIP_LEVEL_SID = RLD.RELATIONSHIP_LEVEL_SID
       JOIN PROJECTION_DETAILS PD
         ON PD.CCP_DETAILS_SID = CCPMAP.CCP_DETAILS_SID
       JOIN ST_NM_PPA_PROJECTION_MASTER A
         ON pd.PROJECTION_DETAILS_SID = A.PROJECTION_DETAILS_SID;
   SELECT QUARTER
       ,YEAR
       ,SUM(DOLLAR) ACTUAL_DISCOUNT_DOLLAR
       ,SUM(DOLLAR)/NULLIF(SUM(SALE),0) RATE
       ,SUM(UNIT) PROJECTION_DISCOUNT_UNITS1
       ,SUM(DOLLAR)/NULLIF(SUM(UNIT),0) DISCOUNT
       ,0 ACTUALS
	   FROM (
SELECT QUARTER,YEAR,SUM(DOLLAR) DOLLAR,MIN(NULLIF(UNIT,0)) UNIT,MIN(NULLIF(SALES,0)) SALE,SUM(UNIT) UNITS,SUM(SALES) SALES,PROJECTION_DETAILS_SID FROM (
       SELECT SUM(ACTUAL_DISCOUNT_DOLLAR) DOLLAR
              ,SUM(SP.ACTUAL_UNITS) UNIT
              ,SUM(SP.ACTUAL_SALES) SALES
              ,S.RS_MODEL_SID
              ,P.QUARTER 
              ,P.YEAR
			  ,S.PROJECTION_DETAILS_SID
      	FROM ST_NM_ACTUAL_PPA S
		LEFT JOIN ST_NM_ACTUAL_SALES SP ON SP.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
			AND SP.PERIOD_SID = S.PERIOD_SID
		JOIN PERIOD P ON P.PERIOD_SID = S.PERIOD_SID
		JOIN @CCP C ON C.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
		GROUP BY S.PROJECTION_DETAILS_SID
			,S.RS_MODEL_SID
			,P.QUARTER
			,P.YEAR ) A
			  GROUP BY PROJECTION_DETAILS_SID,YEAR
       ,QUARTER) B 
GROUP BY YEAR
       ,QUARTER

UNION

SELECT QUARTER
       ,YEAR
       ,SUM(DOLLAR) PROJECTION_DISCOUNT_DOLLAR1
       ,SUM(DOLLAR)/NULLIF(SUM(SALES),0)
       ,SUM(UNIT) PROJECTION_DISCOUNT_UNITS1
       ,SUM(DOLLAR)/NULLIF(SUM(UNIT),0) 
       ,1 ACTUALS
	   FROM
	   (
SELECT PROJECTION_DETAILS_SID,MIN(NULLIF(UNIT,0)) UNIT,MIN(NULLIF(SALES,0)) SALES,SUM(UNIT) UNITS ,SUM(DOLLAR) DOLLAR,SUM(SALES) SALE,QUARTER,YEAR FROM (
       SELECT SUM(PROJECTION_DISCOUNT_DOLLAR) DOLLAR
              ,SUM(SP.PROJECTION_UNITS) UNIT
              ,SUM(SP.PROJECTION_SALES) SALES
              ,S.RS_MODEL_SID
              ,P.QUARTER 
              ,P.YEAR
			  ,S.PROJECTION_DETAILS_SID
      FROM ST_NM_PPA_PROJECTION S
		LEFT JOIN ST_NM_SALES_PROJECTION SP ON SP.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
			AND SP.PERIOD_SID = S.PERIOD_SID
		JOIN PERIOD P ON P.PERIOD_SID = S.PERIOD_SID
		JOIN @CCP C ON C.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
		GROUP BY S.PROJECTION_DETAILS_SID
			,S.RS_MODEL_SID
			,P.QUARTER
			,P.YEAR
       ) A
	   GROUP BY PROJECTION_DETAILS_SID,QUARTER,YEAR) B
	   GROUP BY YEAR
       ,QUARTER
ORDER BY YEAR
       ,QUARTER
  
		
    ]]> </query>
</entity>
<entity id="PPAResults.dataForTableLoad-Annually_Product">
<query> <![CDATA[
		
                
     DECLARE @RELATIONSHIPBUILDERSHIPSID INT =?,
        @PROJECTIONMASTERSID    INT =?,
		@HIERARCHY_NO VARCHAR(100)= '?%',
		@LEVEL_NO INT=?,
		
		@START_DATE VARCHAR(50)='?',
		@END_DATE VARCHAR(50)='?'

DECLARE @CCP TABLE
  (
     PROJECTION_DETAILS_SID INT
  )

INSERT INTO @CCP
            (PROJECTION_DETAILS_SID)
SELECT distinct PD.PROJECTION_DETAILS_SID AS PROJECTION_DETAILS_SID
FROM   RELATIONSHIP_LEVEL_DEFINITION RLD
       JOIN PROJECTION_PROD_HIERARCHY PCH
         ON PCH.PROJECTION_MASTER_SID = @PROJECTIONMASTERSID
            AND RLD.RELATIONSHIP_LEVEL_SID = PCH.RELATIONSHIP_LEVEL_SID
            AND RLD.RELATIONSHIP_BUILDER_SID = @RELATIONSHIPBUILDERSHIPSID
       JOIN RELATIONSHIP_LEVEL_DEFINITION RLD1
         ON RLD1.HIERARCHY_NO LIKE @HIERARCHY_NO
            AND RLD.RELATIONSHIP_BUILDER_SID = RLD1.RELATIONSHIP_BUILDER_SID
            AND RLD.HIERARCHY_NO LIKE RLD1.HIERARCHY_NO + '%'
            AND RLD1.LEVEL_NO = @LEVEL_NO
       JOIN CCP_MAP CCPMAP
         ON CCPMAP.RELATIONSHIP_LEVEL_SID = RLD.RELATIONSHIP_LEVEL_SID
       JOIN PROJECTION_DETAILS PD
         ON PD.CCP_DETAILS_SID = CCPMAP.CCP_DETAILS_SID
       JOIN ST_NM_PPA_PROJECTION_MASTER A
         ON pd.PROJECTION_DETAILS_SID = A.PROJECTION_DETAILS_SID
           
  SELECT YEAR1
       ,YEAR
       ,SUM(DOLLAR) ACTUAL_DISCOUNT_DOLLAR
       ,SUM(DOLLAR)/NULLIF(SUM(SALE),0) RATE
       ,SUM(UNIT) PROJECTION_DISCOUNT_UNITS1
       ,SUM(DOLLAR)/NULLIF(SUM(UNIT),0) DISCOUNT
       ,0 ACTUALS
	   FROM (
SELECT YEAR1,YEAR,SUM(DOLLAR) DOLLAR,MIN(NULLIF(UNIT,0)) UNIT,MIN(NULLIF(SALES,0)) SALE,SUM(UNIT) UNITS,SUM(SALES) SALES,PROJECTION_DETAILS_SID FROM (
       SELECT SUM(ACTUAL_DISCOUNT_DOLLAR) DOLLAR
              ,SUM(SP.ACTUAL_UNITS) UNIT
              ,SUM(SP.ACTUAL_SALES) SALES
              ,S.RS_MODEL_SID
              ,P.YEAR YEAR1 
              ,P.YEAR
			  ,S.PROJECTION_DETAILS_SID
      	FROM ST_NM_ACTUAL_PPA S
		LEFT JOIN ST_NM_ACTUAL_SALES SP ON SP.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
			AND SP.PERIOD_SID = S.PERIOD_SID
		JOIN PERIOD P ON P.PERIOD_SID = S.PERIOD_SID
		JOIN @CCP C ON C.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
		GROUP BY S.PROJECTION_DETAILS_SID
			,S.RS_MODEL_SID
			,P.YEAR ) A
			  GROUP BY PROJECTION_DETAILS_SID,YEAR
       ,YEAR1) B 
GROUP BY YEAR
       ,YEAR1

UNION

SELECT YEAR1
       ,YEAR
       ,SUM(DOLLAR) PROJECTION_DISCOUNT_DOLLAR1
       ,SUM(DOLLAR)/NULLIF(SUM(SALES),0)
       ,SUM(UNIT) PROJECTION_DISCOUNT_UNITS1
       ,SUM(DOLLAR)/NULLIF(SUM(UNIT),0) 
       ,1 ACTUALS
	   FROM
	   (
SELECT PROJECTION_DETAILS_SID,MIN(NULLIF(UNIT,0)) UNIT,MIN(NULLIF(SALES,0)) SALES,SUM(UNIT) UNITS ,SUM(DOLLAR) DOLLAR,SUM(SALES) SALE,YEAR1,YEAR FROM (
       SELECT SUM(PROJECTION_DISCOUNT_DOLLAR) DOLLAR
              ,SUM(SP.PROJECTION_UNITS) UNIT
              ,SUM(SP.PROJECTION_SALES) SALES
              ,S.RS_MODEL_SID
              ,P.YEAR YEAR1 
              ,P.YEAR
			  ,S.PROJECTION_DETAILS_SID
      FROM ST_NM_PPA_PROJECTION S
		LEFT JOIN ST_NM_SALES_PROJECTION SP ON SP.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
			AND SP.PERIOD_SID = S.PERIOD_SID
		JOIN PERIOD P ON P.PERIOD_SID = S.PERIOD_SID
		JOIN @CCP C ON C.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
		GROUP BY S.PROJECTION_DETAILS_SID
			,S.RS_MODEL_SID
			,P.YEAR
       ) A
	   GROUP BY PROJECTION_DETAILS_SID,YEAR1,YEAR) B
	   GROUP BY YEAR
       ,YEAR1
ORDER BY YEAR
       ,YEAR1

		
    ]]> </query>
</entity>
<entity id="PPAResults.countData-Semi-Annual-Product">
<query> <![CDATA[
		
              
    DECLARE @RELATIONSHIPBUILDERSHIPSID INT =?,
        @PROJECTIONMASTERSID    INT =?,
		@HIERARCHY_NO VARCHAR(100)= '?%',
		@LEVEL_NO INT=?,		
		@START_DATE VARCHAR(50)='?',
		@END_DATE VARCHAR(50)='?'

DECLARE @CCP TABLE
  (
     PROJECTION_DETAILS_SID INT
  )

INSERT INTO @CCP
            (PROJECTION_DETAILS_SID)
SELECT distinct PD.PROJECTION_DETAILS_SID AS PROJECTION_DETAILS_SID
FROM   RELATIONSHIP_LEVEL_DEFINITION RLD
       JOIN PROJECTION_PROD_HIERARCHY PCH
         ON PCH.PROJECTION_MASTER_SID = @PROJECTIONMASTERSID
            AND RLD.RELATIONSHIP_LEVEL_SID = PCH.RELATIONSHIP_LEVEL_SID
            AND RLD.RELATIONSHIP_BUILDER_SID = @RELATIONSHIPBUILDERSHIPSID
       JOIN RELATIONSHIP_LEVEL_DEFINITION RLD1
         ON RLD1.HIERARCHY_NO LIKE @HIERARCHY_NO
            AND RLD.RELATIONSHIP_BUILDER_SID = RLD1.RELATIONSHIP_BUILDER_SID
            AND RLD.HIERARCHY_NO LIKE RLD1.HIERARCHY_NO + '%'
            AND RLD1.LEVEL_NO = @LEVEL_NO
       JOIN CCP_MAP CCPMAP
         ON CCPMAP.RELATIONSHIP_LEVEL_SID = RLD.RELATIONSHIP_LEVEL_SID
       JOIN PROJECTION_DETAILS PD
         ON PD.CCP_DETAILS_SID = CCPMAP.CCP_DETAILS_SID
       JOIN ST_NM_PPA_PROJECTION_MASTER A
         ON pd.PROJECTION_DETAILS_SID = A.PROJECTION_DETAILS_SID
     

SELECT SEMI_ANNUAL
       ,YEAR
       ,SUM(DOLLAR) ACTUAL_DISCOUNT_DOLLAR
       ,SUM(DOLLAR)/NULLIF(SUM(SALE),0) RATE
       ,SUM(UNIT) PROJECTION_DISCOUNT_UNITS1
       ,SUM(DOLLAR)/NULLIF(SUM(UNIT),0) DISCOUNT
       ,0 ACTUALS
	   FROM (
SELECT SEMI_ANNUAL,YEAR,SUM(DOLLAR) DOLLAR,MIN(NULLIF(UNIT,0)) UNIT,MIN(NULLIF(SALES,0)) SALE,SUM(UNIT) UNITS,SUM(SALES) SALES,PROJECTION_DETAILS_SID FROM (
       SELECT SUM(ACTUAL_DISCOUNT_DOLLAR) DOLLAR
              ,SUM(SP.ACTUAL_UNITS) UNIT
              ,SUM(SP.ACTUAL_SALES) SALES
              ,S.RS_MODEL_SID
              ,P.SEMI_ANNUAL 
              ,P.YEAR
			  ,S.PROJECTION_DETAILS_SID
      	FROM ST_NM_ACTUAL_PPA S
		LEFT JOIN ST_NM_ACTUAL_SALES SP ON SP.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
			AND SP.PERIOD_SID = S.PERIOD_SID
		JOIN PERIOD P ON P.PERIOD_SID = S.PERIOD_SID
		JOIN @CCP C ON C.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
		GROUP BY S.PROJECTION_DETAILS_SID
			,S.RS_MODEL_SID
			,P.SEMI_ANNUAL
			,P.YEAR ) A
			  GROUP BY PROJECTION_DETAILS_SID,YEAR
       ,SEMI_ANNUAL) B 
GROUP BY YEAR
       ,SEMI_ANNUAL

UNION

SELECT SEMI_ANNUAL
       ,YEAR
       ,SUM(DOLLAR) PROJECTION_DISCOUNT_DOLLAR1
       ,SUM(DOLLAR)/NULLIF(SUM(SALES),0)
       ,SUM(UNIT) PROJECTION_DISCOUNT_UNITS1
       ,SUM(DOLLAR)/NULLIF(SUM(UNIT),0) 
       ,1 ACTUALS
	   FROM
	   (
SELECT PROJECTION_DETAILS_SID,MIN(NULLIF(UNIT,0)) UNIT,MIN(NULLIF(SALES,0)) SALES,SUM(UNIT) UNITS ,SUM(DOLLAR) DOLLAR,SUM(SALES) SALE,SEMI_ANNUAL,YEAR FROM (
       SELECT SUM(PROJECTION_DISCOUNT_DOLLAR) DOLLAR
              ,SUM(SP.PROJECTION_UNITS) UNIT
              ,SUM(SP.PROJECTION_SALES) SALES
              ,S.RS_MODEL_SID
              ,P.SEMI_ANNUAL 
              ,P.YEAR
			  ,S.PROJECTION_DETAILS_SID
      FROM ST_NM_PPA_PROJECTION S
		LEFT JOIN ST_NM_SALES_PROJECTION SP ON SP.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
			AND SP.PERIOD_SID = S.PERIOD_SID
		JOIN PERIOD P ON P.PERIOD_SID = S.PERIOD_SID
		JOIN @CCP C ON C.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
		GROUP BY S.PROJECTION_DETAILS_SID
			,S.RS_MODEL_SID
			,P.SEMI_ANNUAL
			,P.YEAR
       ) A
	   GROUP BY PROJECTION_DETAILS_SID,SEMI_ANNUAL,YEAR) B
	   GROUP BY YEAR
       ,SEMI_ANNUAL
ORDER BY YEAR
       ,SEMI_ANNUAL
		
    ]]> </query>
</entity>
<entity id="PPAResults.dataForTableLoad-Annually-Total">
<query> <![CDATA[
		
         SELECT      YEAR1
       ,YEAR,SUM(DOLLAR) DOLLAR
       ,SUM(DOLLAR)/NULLIF(SUM(SALE),0) RATE
       ,SUM(PROJECTION_DISCOUNT_UNITS1) UNIT
       ,SUM(DOLLAR)/NULLIF(SUM(PROJECTION_DISCOUNT_UNITS1),0) RPU
	   ,0 ACTUALS
FROM (
       SELECT PROJECTION_DETAILS_SID
              ,YEAR1
              ,YEAR
              ,SUM(DOLLAR) DOLLAR
              ,MIN(NULLIF(UNIT, 0)) PROJECTION_DISCOUNT_UNITS1
			  ,SUM(SALES) SALES
			  ,SUM(UNIT) UNITS
			  ,MIN(NULLIF(SALES, 0)) SALE
       FROM (
              SELECT S.PROJECTION_DETAILS_SID
                     ,SUM(ACTUAL_DISCOUNT_DOLLAR) DOLLAR
                     ,SUM(SP.ACTUAL_UNITS) UNIT
                     ,SUM(SP.ACTUAL_SALES) SALES 
                     ,S.RS_MODEL_SID
                     ,P.YEAR YEAR1
                     ,P.YEAR
              FROM ST_NM_ACTUAL_PPA S
              JOIN PROJECTION_DETAILS PD ON PD.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
              LEFT JOIN ST_NM_ACTUAL_SALES SP ON SP.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                     AND SP.PERIOD_SID = S.PERIOD_SID
              JOIN PERIOD P ON P.PERIOD_SID = S.PERIOD_SID
              JOIN ST_NM_PPA_PROJECTION_MASTER C ON C.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                     AND C.RS_MODEL_SID = S.RS_MODEL_SID
              WHERE PD.PROJECTION_MASTER_SID = ?
                     AND ISNULL(C.USER_GROUP, '0') LIKE '?'
                     AND PERIOD_DATE BETWEEN CONVERT(DATE, '?')
                           AND CONVERT(DATE, '?')
              GROUP BY S.PROJECTION_DETAILS_SID
                     ,S.RS_MODEL_SID
                     ,P.YEAR
              ) G
       GROUP BY PROJECTION_DETAILS_SID
              ,YEAR1
              ,YEAR
       ) Y
GROUP BY YEAR1
       ,YEAR

UNION

SELECT YEAR1
       ,YEAR,SUM(DOLLAR)
       ,SUM(DOLLAR)/NULLIF(SUM(SALES),0) RATE
	          ,SUM(UNITS)
	   ,SUM(DOLLAR)/NULLIF(SUM(UNITS),0) RPU
	   ,1
FROM (
       SELECT PROJECTION_DETAILS_SID
              ,SUM(DOLLAR) DOLLAR
              ,MIN(NULLIF(UNI,0)) UNITS
			  ,SUM(UNIT) UNIT
			  ,SUM(SALES) SALE
              ,YEAR1
              ,YEAR
			  ,MIN(NULLIF(SALES, 0)) SALES
       FROM (
              SELECT S.PROJECTION_DETAILS_SID
                     ,SUM(SP.PROJECTION_SALES) SALES
                     ,SUM(SP.PROJECTION_UNITS) UNI
                     ,SUM(PROJECTION_DISCOUNT_DOLLAR) DOLLAR
                     ,SUM(SP.PROJECTION_UNITS) UNIT 
                     ,S.RS_MODEL_SID
                     ,P.YEAR YEAR1
                     ,P.YEAR
              FROM ST_NM_PPA_PROJECTION S
              JOIN PROJECTION_DETAILS PD ON PD.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
              LEFT JOIN ST_NM_SALES_PROJECTION SP ON SP.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                     AND SP.PERIOD_SID = S.PERIOD_SID
              JOIN PERIOD P ON P.PERIOD_SID = S.PERIOD_SID
              JOIN ST_NM_PPA_PROJECTION_MASTER C ON C.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                     AND C.RS_MODEL_SID = S.RS_MODEL_SID
              WHERE PD.PROJECTION_MASTER_SID = ?
                     AND ISNULL(C.USER_GROUP, '0') LIKE '?'
                     AND PERIOD_DATE BETWEEN CONVERT(DATE, '?')
                           AND CONVERT(DATE, '?')
              GROUP BY S.PROJECTION_DETAILS_SID
                     ,S.RS_MODEL_SID
                     ,P.YEAR
              ) G
       GROUP BY PROJECTION_DETAILS_SID
              ,YEAR1
              ,YEAR
       ) Y
GROUP BY YEAR1
       ,YEAR
	   ORDER BY YEAR,YEAR1
		
    ]]> </query>
</entity>
<entity id="PPAResults.Monthly-Total">
<query> <![CDATA[
		
           SELECT      MONTH
       ,YEAR,SUM(DOLLAR) DOLLAR
       ,SUM(DOLLAR)/NULLIF(SUM(SALE),0) RATE
       ,SUM(PROJECTION_DISCOUNT_UNITS1) UNIT
       ,SUM(DOLLAR)/NULLIF(SUM(PROJECTION_DISCOUNT_UNITS1),0) RPU
	   ,0 ACTUALS
FROM (
       SELECT PROJECTION_DETAILS_SID
              ,MONTH
              ,YEAR
              ,SUM(DOLLAR) DOLLAR
              ,MIN(NULLIF(UNIT, 0)) PROJECTION_DISCOUNT_UNITS1
			  ,SUM(SALES) SALES
			  ,SUM(UNIT) UNITS
			  ,MIN(NULLIF(SALES, 0)) SALE
       FROM (
              SELECT S.PROJECTION_DETAILS_SID
                     ,SUM(ACTUAL_DISCOUNT_DOLLAR) DOLLAR
                     ,SUM(SP.ACTUAL_UNITS) UNIT
                     ,SUM(SP.ACTUAL_SALES) SALES 
                     ,S.RS_MODEL_SID
                     ,P.MONTH
                     ,P.YEAR
              FROM ST_NM_ACTUAL_PPA S
              JOIN PROJECTION_DETAILS PD ON PD.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
              LEFT JOIN ST_NM_ACTUAL_SALES SP ON SP.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                     AND SP.PERIOD_SID = S.PERIOD_SID
              JOIN PERIOD P ON P.PERIOD_SID = S.PERIOD_SID
              JOIN ST_NM_PPA_PROJECTION_MASTER C ON C.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                     AND C.RS_MODEL_SID = S.RS_MODEL_SID
              WHERE PD.PROJECTION_MASTER_SID = ?
                     AND ISNULL(C.USER_GROUP, '0') LIKE '?'
                     AND PERIOD_DATE BETWEEN CONVERT(DATE, '?')
                           AND CONVERT(DATE, '?')
              GROUP BY S.PROJECTION_DETAILS_SID
                     ,S.RS_MODEL_SID
                     ,P.MONTH
                     ,P.YEAR
              ) G
       GROUP BY PROJECTION_DETAILS_SID
              ,MONTH
              ,YEAR
       ) Y
GROUP BY MONTH
       ,YEAR

UNION

SELECT MONTH
       ,YEAR,SUM(DOLLAR)
       ,SUM(DOLLAR)/NULLIF(SUM(SALES),0) RATE
	          ,SUM(UNITS)
	   ,SUM(DOLLAR)/NULLIF(SUM(UNITS),0) RPU
	   ,1
FROM (
       SELECT PROJECTION_DETAILS_SID
              ,SUM(DOLLAR) DOLLAR
              ,MIN(NULLIF(UNI,0)) UNITS
			  ,SUM(UNIT) UNIT
			  ,SUM(SALES) SALE
              ,MONTH
              ,YEAR
			  ,MIN(NULLIF(SALES, 0)) SALES
       FROM (
              SELECT S.PROJECTION_DETAILS_SID
                     ,SUM(SP.PROJECTION_SALES) SALES
                     ,SUM(SP.PROJECTION_UNITS) UNI
                     ,SUM(PROJECTION_DISCOUNT_DOLLAR) DOLLAR
                     ,SUM(SP.PROJECTION_UNITS) UNIT 
                     ,S.RS_MODEL_SID
                     ,P.MONTH
                     ,P.YEAR
              FROM ST_NM_PPA_PROJECTION S
              JOIN PROJECTION_DETAILS PD ON PD.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
              LEFT JOIN ST_NM_SALES_PROJECTION SP ON SP.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                     AND SP.PERIOD_SID = S.PERIOD_SID
              JOIN PERIOD P ON P.PERIOD_SID = S.PERIOD_SID
              JOIN ST_NM_PPA_PROJECTION_MASTER C ON C.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                     AND C.RS_MODEL_SID = S.RS_MODEL_SID
              WHERE PD.PROJECTION_MASTER_SID = ?
                     AND ISNULL(C.USER_GROUP, '0') LIKE '?'
                     AND PERIOD_DATE BETWEEN CONVERT(DATE, '?')
                           AND CONVERT(DATE, '?')
              GROUP BY S.PROJECTION_DETAILS_SID
                     ,S.RS_MODEL_SID
                     ,P.MONTH
                     ,P.YEAR
              ) G
       GROUP BY PROJECTION_DETAILS_SID
              ,MONTH
              ,YEAR
       ) Y
GROUP BY MONTH
       ,YEAR
	   ORDER BY YEAR,MONTH
		
    ]]> </query>
</entity>
<entity id="PPAResults.dataForTableLoad-Quaterly-Total">
<query> <![CDATA[
		
              SELECT      QUARTER
       ,YEAR,SUM(DOLLAR) DOLLAR
       ,SUM(DOLLAR)/NULLIF(SUM(SALE),0) RATE
       ,SUM(PROJECTION_DISCOUNT_UNITS1) UNIT
       ,SUM(DOLLAR)/NULLIF(SUM(PROJECTION_DISCOUNT_UNITS1),0) RPU
	   ,0 ACTUALS
FROM (
       SELECT PROJECTION_DETAILS_SID
              ,QUARTER
              ,YEAR
              ,SUM(DOLLAR) DOLLAR
              ,MIN(NULLIF(UNIT, 0)) PROJECTION_DISCOUNT_UNITS1
			  ,SUM(SALES) SALES
			  ,SUM(UNIT) UNITS
			  ,MIN(NULLIF(SALES, 0)) SALE
       FROM (
              SELECT S.PROJECTION_DETAILS_SID
                     ,SUM(ACTUAL_DISCOUNT_DOLLAR) DOLLAR
                     ,SUM(SP.ACTUAL_UNITS) UNIT
                     ,SUM(SP.ACTUAL_SALES) SALES 
                     ,S.RS_MODEL_SID
                     ,P.QUARTER
                     ,P.YEAR
              FROM ST_NM_ACTUAL_PPA S
              JOIN PROJECTION_DETAILS PD ON PD.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
              LEFT JOIN ST_NM_ACTUAL_SALES SP ON SP.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                   AND SP.PERIOD_SID = S.PERIOD_SID
              JOIN PERIOD P ON P.PERIOD_SID = S.PERIOD_SID
              JOIN ST_NM_PPA_PROJECTION_MASTER C ON C.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                    AND C.RS_MODEL_SID = S.RS_MODEL_SID
              WHERE PD.PROJECTION_MASTER_SID = ?
                     AND ISNULL(C.USER_GROUP, '0') LIKE '?'
                     AND PERIOD_DATE BETWEEN CONVERT(DATE, '?')
                           AND CONVERT(DATE, '?')
              GROUP BY S.PROJECTION_DETAILS_SID
                     ,S.RS_MODEL_SID
                     ,P.QUARTER
                     ,P.YEAR
              ) G
       GROUP BY PROJECTION_DETAILS_SID
              ,QUARTER
              ,YEAR
       ) Y
GROUP BY QUARTER
       ,YEAR

UNION

SELECT QUARTER
       ,YEAR,SUM(DOLLAR)
       ,SUM(DOLLAR)/NULLIF(SUM(SALES),0) RATE
	          ,SUM(UNITS)
	   ,SUM(DOLLAR)/NULLIF(SUM(UNITS),0) RPU
	   ,1
FROM (
       SELECT PROJECTION_DETAILS_SID
              ,SUM(DOLLAR) DOLLAR
              ,MIN(NULLIF(UNI,0)) UNITS
			  ,SUM(UNIT) UNIT
			  ,SUM(SALES) SALE
              ,QUARTER
              ,YEAR
			  ,MIN(NULLIF(SALES, 0)) SALES
       FROM (
              SELECT S.PROJECTION_DETAILS_SID
                     ,SUM(SP.PROJECTION_SALES) SALES
                     ,SUM(SP.PROJECTION_UNITS) UNI
                     ,SUM(PROJECTION_DISCOUNT_DOLLAR) DOLLAR
                     ,SUM(SP.PROJECTION_UNITS) UNIT 
                     ,S.RS_MODEL_SID
                     ,P.QUARTER
                     ,P.YEAR
              FROM ST_NM_PPA_PROJECTION S
              JOIN PROJECTION_DETAILS PD ON PD.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
              LEFT JOIN ST_NM_SALES_PROJECTION SP ON SP.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                    AND SP.PERIOD_SID = S.PERIOD_SID
              JOIN PERIOD P ON P.PERIOD_SID = S.PERIOD_SID
              JOIN ST_NM_PPA_PROJECTION_MASTER C ON C.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                   AND C.RS_MODEL_SID = S.RS_MODEL_SID
              WHERE PD.PROJECTION_MASTER_SID = ?
                     AND ISNULL(C.USER_GROUP, '0') LIKE '?'
                     AND PERIOD_DATE BETWEEN CONVERT(DATE, '?')
                           AND CONVERT(DATE, '?')
              GROUP BY S.PROJECTION_DETAILS_SID
                     ,S.RS_MODEL_SID
                     ,P.QUARTER
                     ,P.YEAR
              ) G
       GROUP BY PROJECTION_DETAILS_SID
              ,QUARTER
              ,YEAR
       ) Y
GROUP BY QUARTER
       ,YEAR
	   ORDER BY YEAR,QUARTER
		
    ]]> </query>
</entity>
<entity id="PPAResults.Semi-Annual-Total">
<query> <![CDATA[
		
         SELECT      SEMI_ANNUAL
       ,YEAR,SUM(DOLLAR) DOLLAR
       ,SUM(DOLLAR)/NULLIF(SUM(SALE),0) RATE
       ,SUM(PROJECTION_DISCOUNT_UNITS1) UNIT
       ,SUM(DOLLAR)/NULLIF(SUM(PROJECTION_DISCOUNT_UNITS1),0) RPU
	   ,0 ACTUALS
FROM (
       SELECT PROJECTION_DETAILS_SID
              ,SEMI_ANNUAL
              ,YEAR
              ,SUM(DOLLAR) DOLLAR
              ,MIN(NULLIF(UNIT, 0)) PROJECTION_DISCOUNT_UNITS1
			  ,SUM(SALES) SALES
			  ,SUM(UNIT) UNITS
			  ,MIN(NULLIF(SALES, 0)) SALE
       FROM (
              SELECT S.PROJECTION_DETAILS_SID
                     ,SUM(ACTUAL_DISCOUNT_DOLLAR) DOLLAR
                     ,SUM(SP.ACTUAL_UNITS) UNIT
                     ,SUM(SP.ACTUAL_SALES) SALES 
                     ,S.RS_MODEL_SID
                     ,P.SEMI_ANNUAL
                     ,P.YEAR
              FROM ST_NM_ACTUAL_PPA S
              JOIN PROJECTION_DETAILS PD ON PD.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
              LEFT JOIN ST_NM_ACTUAL_SALES SP ON SP.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                     AND SP.PERIOD_SID = S.PERIOD_SID
              JOIN PERIOD P ON P.PERIOD_SID = S.PERIOD_SID
              JOIN ST_NM_PPA_PROJECTION_MASTER C ON C.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                     AND C.RS_MODEL_SID = S.RS_MODEL_SID
              WHERE PD.PROJECTION_MASTER_SID = ?
                     AND ISNULL(C.USER_GROUP, '0') LIKE '?'
                     AND PERIOD_DATE BETWEEN CONVERT(DATE, '?')
                           AND CONVERT(DATE, '?')
              GROUP BY S.PROJECTION_DETAILS_SID
                     ,S.RS_MODEL_SID
                     ,P.SEMI_ANNUAL
                     ,P.YEAR
              ) G
       GROUP BY PROJECTION_DETAILS_SID
              ,SEMI_ANNUAL
              ,YEAR
       ) Y
GROUP BY SEMI_ANNUAL
       ,YEAR

UNION

SELECT SEMI_ANNUAL
       ,YEAR,SUM(DOLLAR)
       ,SUM(DOLLAR)/NULLIF(SUM(SALES),0) RATE
	          ,SUM(UNITS)
	   ,SUM(DOLLAR)/NULLIF(SUM(UNITS),0) RPU
	   ,1
FROM (
       SELECT PROJECTION_DETAILS_SID
              ,SUM(DOLLAR) DOLLAR
              ,MIN(NULLIF(UNI,0)) UNITS
			  ,SUM(UNIT) UNIT
			  ,SUM(SALES) SALE
              ,SEMI_ANNUAL
              ,YEAR
			  ,MIN(NULLIF(SALES, 0)) SALES
       FROM (
              SELECT S.PROJECTION_DETAILS_SID
                     ,SUM(SP.PROJECTION_SALES) SALES
                     ,SUM(SP.PROJECTION_UNITS) UNI
                     ,SUM(PROJECTION_DISCOUNT_DOLLAR) DOLLAR
                     ,SUM(SP.PROJECTION_UNITS) UNIT 
                     ,S.RS_MODEL_SID
                     ,P.SEMI_ANNUAL
                     ,P.YEAR
              FROM ST_NM_PPA_PROJECTION S
              JOIN PROJECTION_DETAILS PD ON PD.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
              LEFT JOIN ST_NM_SALES_PROJECTION SP ON SP.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                     AND SP.PERIOD_SID = S.PERIOD_SID
              JOIN PERIOD P ON P.PERIOD_SID = S.PERIOD_SID
              JOIN ST_NM_PPA_PROJECTION_MASTER C ON C.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                     AND C.RS_MODEL_SID = S.RS_MODEL_SID
              WHERE PD.PROJECTION_MASTER_SID = ?
                     AND ISNULL(C.USER_GROUP, '0') LIKE '?'
                     AND PERIOD_DATE BETWEEN CONVERT(DATE, '?')
                           AND CONVERT(DATE, '?')
              GROUP BY S.PROJECTION_DETAILS_SID
                     ,S.RS_MODEL_SID
                     ,P.SEMI_ANNUAL
                     ,P.YEAR
              ) G
       GROUP BY PROJECTION_DETAILS_SID
              ,SEMI_ANNUAL
              ,YEAR
       ) Y
GROUP BY SEMI_ANNUAL
       ,YEAR
	   ORDER BY YEAR,SEMI_ANNUAL
		
    ]]> </query>
</entity>
<entity id="PPAResults.CustomCCPQuary">
<query> <![CDATA[
		
                
    DECLARE @CCP TABLE
  (
     RELATIONSHIP_LEVEL_SID INT,
     CCP_DETAILS_SID        INT,
     HIERARCHY_NO           VARCHAR(50)
  )

INSERT INTO @CCP
            (RELATIONSHIP_LEVEL_SID,
             CCP_DETAILS_SID,
             HIERARCHY_NO)
      SELECT DISTINCT coalesce(HLDp.RELATIONSHIP_LEVEL_SID,HLDc.RELATIONSHIP_LEVEL_SID),
				CCPMAPp.CCP_DETAILS_SID,
				coalesce(HLDp.HIERARCHY_NO,HLDc.HIERARCHY_NO)
        FROM   (SELECT DISTINCT RLD.RELATIONSHIP_LEVEL_VALUES,
               RLD.HIERARCHY_NO,
               CCP.CCP_DETAILS_SID
        FROM   RELATIONSHIP_LEVEL_DEFINITION RLD
               JOIN CCP_MAP CCP
                 ON RLD.RELATIONSHIP_LEVEL_SID = CCP.RELATIONSHIP_LEVEL_SID
               JOIN PROJECTION_DETAILS PD
                 ON PD.CCP_DETAILS_SID = CCP.CCP_DETAILS_SID
                    AND PD.PROJECTION_MASTER_SID = ?
               JOIN ST_NM_PPA_PROJECTION_MASTER S
                 ON S.PROJECTION_DETAILS_SID = PD.PROJECTION_DETAILS_SID
        WHERE  S.USER_GROUP LIKE '?') CCPMAPC
       JOIN (SELECT DISTINCT RLD.RELATIONSHIP_LEVEL_VALUES,
                    RLD.HIERARCHY_NO,
                    CCP.CCP_DETAILS_SID
             FROM   RELATIONSHIP_LEVEL_DEFINITION RLD
                    JOIN CCP_MAP CCP
                      ON RLD.RELATIONSHIP_LEVEL_SID = CCP.RELATIONSHIP_LEVEL_SID
                    JOIN PROJECTION_DETAILS PD
                      ON PD.CCP_DETAILS_SID = CCP.CCP_DETAILS_SID
                         AND PD.PROJECTION_MASTER_SID = ?
                    JOIN ST_NM_PPA_PROJECTION_MASTER S
                      ON S.PROJECTION_DETAILS_SID = PD.PROJECTION_DETAILS_SID
             WHERE  S.USER_GROUP LIKE '?') CCPMAPP
         ON CCPMAPC.CCP_DETAILS_SID = CCPMAPP.CCP_DETAILS_SID
      LEFT JOIN (SELECT DISTINCT RLD2.HIERARCHY_NO,
                    RLD2.RELATIONSHIP_LEVEL_SID,
                    CVD.LEVEL_NO,
                     RLD2.RELATIONSHIP_LEVEL_VALUES
             FROM   CUSTOM_VIEW_DETAILS CVD
                    JOIN CUSTOM_VIEW_MASTER CVM
                      ON CVD.CUSTOM_VIEW_MASTER_SID = ?
                         AND CVD.LEVEL_NO LIKE '?%'
                    JOIN HIERARCHY_LEVEL_DEFINITION HLD
                      ON CVD.HIERARCHY_ID = HLD.HIERARCHY_LEVEL_DEFINITION_SID
                    JOIN RELATIONSHIP_LEVEL_DEFINITION RLD2
                      ON HLD.HIERARCHY_LEVEL_DEFINITION_SID = RLD2.HIERARCHY_LEVEL_DEFINITION_SID
                    JOIN PROJECTION_CUST_HIERARCHY PCH2
                      ON PCH2.RELATIONSHIP_LEVEL_SID = RLD2.RELATIONSHIP_LEVEL_SID
                         AND PCH2.PROJECTION_MASTER_SID = ?
             WHERE  RLD2.HIERARCHY_NO LIKE '?%') HLDC
         ON CCPMAPC.HIERARCHY_NO LIKE HLDC.HIERARCHY_NO + '%'
      LEFT JOIN (SELECT DISTINCT RLD2.HIERARCHY_NO,
                    RLD2.RELATIONSHIP_LEVEL_SID,
                    CVD.LEVEL_NO,
                    RLD2.RELATIONSHIP_LEVEL_VALUES
             FROM   CUSTOM_VIEW_DETAILS CVD
                    JOIN CUSTOM_VIEW_MASTER CVM
                      ON CVD.CUSTOM_VIEW_MASTER_SID = ?
                         AND CVD.LEVEL_NO LIKE '?%'
                    JOIN HIERARCHY_LEVEL_DEFINITION HLD
                      ON CVD.HIERARCHY_ID = HLD.HIERARCHY_LEVEL_DEFINITION_SID
                    JOIN RELATIONSHIP_LEVEL_DEFINITION RLD2
                      ON HLD.HIERARCHY_LEVEL_DEFINITION_SID = RLD2.HIERARCHY_LEVEL_DEFINITION_SID
                    JOIN PROJECTION_PROD_HIERARCHY PCH2
                      ON PCH2.RELATIONSHIP_LEVEL_SID = RLD2.RELATIONSHIP_LEVEL_SID
                         AND PCH2.PROJECTION_MASTER_SID = ?
             WHERE  RLD2.HIERARCHY_NO LIKE '?%') HLDP
         ON CCPMAPP.HIERARCHY_NO LIKE HLDP.HIERARCHY_NO + '%'
          where coalesce(HLDp.RELATIONSHIP_LEVEL_SID,HLDc.RELATIONSHIP_LEVEL_SID) is not null;  
		
    ]]> </query>
</entity>
<entity id="PPAResults.dataForTableLoad-Custom-Quaterly">
<query> <![CDATA[
		
     SELECT QUARTER
       ,YEAR
       ,SUM(DOLLAR) ACTUAL_DISCOUNT_DOLLAR
       ,SUM(DOLLAR)/NULLIF(SUM(SALE),0) RATE
       ,SUM(UNIT) PROJECTION_DISCOUNT_UNITS1
       ,SUM(DOLLAR)/NULLIF(SUM(UNIT),0) DISCOUNT
       ,0 ACTUALS FROM (
SELECT PROJECTION_DETAILS_SID,QUARTER,YEAR, SUM(DOLLAR) DOLLAR, SUM(UNIT) UNITS, MIN(UNIT) UNIT,SUM(SALES) SALES,MIN(NULLIF(SALES,0)) SALE FROM (
       SELECT SUM(ACTUAL_DISCOUNT_DOLLAR) DOLLAR
              ,SUM(SP.ACTUAL_UNITS) UNIT
              ,SUM(SP.ACTUAL_SALES) SALES
              ,S.RS_MODEL_SID
              ,P.QUARTER
              ,P.YEAR
			 , S.PROJECTION_DETAILS_SID
       FROM ST_NM_ACTUAL_PPA S
          LEFT JOIN ST_NM_ACTUAL_SALES SP ON SP.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
              AND SP.PERIOD_SID = S.PERIOD_SID
       JOIN PERIOD P ON P.PERIOD_SID = S.PERIOD_SID
          JOIN PROJECTION_DETAILS PD ON PD.PROJECTION_DETAILS_SID=S.PROJECTION_DETAILS_SID
       JOIN @CCP C ON C.CCP_DETAILS_SID= PD.CCP_DETAILS_SID
                     WHERE PD.PROJECTION_MASTER_SID = ?
              AND PERIOD_DATE BETWEEN CONVERT(DATE, '?')
                     AND CONVERT(DATE, '?')


       GROUP BY  S.PROJECTION_DETAILS_SID,S.RS_MODEL_SID
              ,P.QUARTER
              ,P.YEAR
       ) A
	   GROUP BY  PROJECTION_DETAILS_SID,YEAR
       ,QUARTER
	   )B
GROUP BY  YEAR
       ,QUARTER

UNION

SELECT QUARTER
       ,YEAR
       ,SUM(DOLLAR) PROJECTION_DISCOUNT_DOLLAR1
       ,SUM(DOLLAR)/NULLIF(SUM(SALE),0) RATE
       ,SUM(UNIT) PROJECTION_DISCOUNT_UNITS1
       ,SUM(DOLLAR)/NULLIF(SUM(UNIT),0) DISCOUNT
       ,1 ACTUALS
FROM (
SELECT PROJECTION_DETAILS_SID,QUARTER,YEAR, SUM(DOLLAR) DOLLAR, SUM(UNIT) UNITS, MIN(NULLIF(UNIT,0)) UNIT,SUM(SALES) SALES,MIN(NULLIF(SALES,0)) SALE FROM (
       SELECT SUM(PROJECTION_DISCOUNT_DOLLAR) DOLLAR
              ,SUM(SP.PROJECTION_UNITS) UNIT
              ,SUM(SP.PROJECTION_SALES) SALES
              ,S.RS_MODEL_SID
              ,P.QUARTER
              ,P.YEAR
			  ,S.PROJECTION_DETAILS_SID
       FROM ST_NM_PPA_PROJECTION S
          JOIN PERIOD P ON P.PERIOD_SID=S.PERIOD_SID
       LEFT JOIN ST_NM_SALES_PROJECTION SP ON SP.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
              AND SP.PERIOD_SID = S.PERIOD_SID
       JOIN PROJECTION_DETAILS PD ON PD.PROJECTION_DETAILS_SID=S.PROJECTION_DETAILS_SID
       JOIN @CCP C ON C.CCP_DETAILS_SID= PD.CCP_DETAILS_SID
      WHERE PD.PROJECTION_MASTER_SID = ?
              AND PERIOD_DATE BETWEEN CONVERT(DATE, '?')
                     AND CONVERT(DATE, '?')
       GROUP BY S.PROJECTION_DETAILS_SID,S.RS_MODEL_SID
              ,P.QUARTER
              ,P.YEAR
       ) A
  GROUP BY  PROJECTION_DETAILS_SID,YEAR
       ,QUARTER
	   )B
GROUP BY  YEAR
       ,QUARTER

ORDER BY YEAR
       ,QUARTER
		
    ]]> </query>
</entity>
<entity id="PPAResults.dataForTableLoad-Custom-Monthly">
<query> <![CDATA[
		
  SELECT MONTH
       ,YEAR
       ,SUM(DOLLAR) ACTUAL_DISCOUNT_DOLLAR
       ,SUM(DOLLAR)/NULLIF(SUM(SALE),0) RATE
       ,SUM(UNIT) PROJECTION_DISCOUNT_UNITS1
       ,SUM(DOLLAR)/NULLIF(SUM(UNIT),0) DISCOUNT
       ,0 ACTUALS FROM (
SELECT PROJECTION_DETAILS_SID,MONTH,YEAR, SUM(DOLLAR) DOLLAR, SUM(UNIT) UNITS, MIN(UNIT) UNIT,SUM(SALES) SALES,MIN(NULLIF(SALES,0)) SALE FROM (
       SELECT SUM(ACTUAL_DISCOUNT_DOLLAR) DOLLAR
              ,SUM(SP.ACTUAL_UNITS) UNIT
              ,SUM(SP.ACTUAL_SALES) SALES
              ,S.RS_MODEL_SID
              ,P.MONTH
              ,P.YEAR
			 , S.PROJECTION_DETAILS_SID
       FROM ST_NM_ACTUAL_PPA S
          LEFT JOIN ST_NM_ACTUAL_SALES SP ON SP.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
              AND SP.PERIOD_SID = S.PERIOD_SID
       JOIN PERIOD P ON P.PERIOD_SID = S.PERIOD_SID
          JOIN PROJECTION_DETAILS PD ON PD.PROJECTION_DETAILS_SID=S.PROJECTION_DETAILS_SID
       JOIN @CCP C ON C.CCP_DETAILS_SID= PD.CCP_DETAILS_SID
                     WHERE PD.PROJECTION_MASTER_SID = ?
              AND PERIOD_DATE BETWEEN CONVERT(DATE, '?')
                     AND CONVERT(DATE, '?')


       GROUP BY  S.PROJECTION_DETAILS_SID,S.RS_MODEL_SID
              ,P.MONTH
              ,P.YEAR
       ) A
	   GROUP BY  PROJECTION_DETAILS_SID,YEAR
       ,MONTH
	   )B
GROUP BY  YEAR
       ,MONTH

UNION

SELECT MONTH
       ,YEAR
       ,SUM(DOLLAR) PROJECTION_DISCOUNT_DOLLAR1
       ,SUM(DOLLAR)/NULLIF(SUM(SALE),0) RATE
       ,SUM(UNIT) PROJECTION_DISCOUNT_UNITS1
       ,SUM(DOLLAR)/NULLIF(SUM(UNIT),0) DISCOUNT
       ,1 ACTUALS
FROM (
SELECT PROJECTION_DETAILS_SID,MONTH,YEAR, SUM(DOLLAR) DOLLAR, SUM(UNIT) UNITS, MIN(NULLIF(UNIT,0)) UNIT,SUM(SALES) SALES,MIN(NULLIF(SALES,0)) SALE FROM (
       SELECT SUM(PROJECTION_DISCOUNT_DOLLAR) DOLLAR
              ,SUM(SP.PROJECTION_UNITS) UNIT
              ,SUM(SP.PROJECTION_SALES) SALES
              ,S.RS_MODEL_SID
              ,P.MONTH
              ,P.YEAR
			  ,S.PROJECTION_DETAILS_SID
       FROM ST_NM_PPA_PROJECTION S
          JOIN PERIOD P ON P.PERIOD_SID=S.PERIOD_SID
       LEFT JOIN ST_NM_SALES_PROJECTION SP ON SP.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
              AND SP.PERIOD_SID = S.PERIOD_SID
       JOIN PROJECTION_DETAILS PD ON PD.PROJECTION_DETAILS_SID=S.PROJECTION_DETAILS_SID
       JOIN @CCP C ON C.CCP_DETAILS_SID= PD.CCP_DETAILS_SID
      WHERE PD.PROJECTION_MASTER_SID = ?
              AND PERIOD_DATE BETWEEN CONVERT(DATE, '?')
                     AND CONVERT(DATE, '?')
       GROUP BY S.PROJECTION_DETAILS_SID,S.RS_MODEL_SID
              ,P.MONTH
              ,P.YEAR
       ) A
  GROUP BY  PROJECTION_DETAILS_SID,YEAR
       ,MONTH
	   )B
GROUP BY  YEAR
       ,MONTH

ORDER BY YEAR
       ,MONTH;
		
    ]]> </query>
</entity>
<entity id="PPAResults.dataForTableLoad-Custom-semiannually">
<query> <![CDATA[
		
     SELECT SEMI_ANNUAL
       ,YEAR
       ,SUM(DOLLAR) ACTUAL_DISCOUNT_DOLLAR
       ,SUM(DOLLAR)/NULLIF(SUM(SALE),0) RATE
       ,SUM(UNIT) PROJECTION_DISCOUNT_UNITS1
       ,SUM(DOLLAR)/NULLIF(SUM(UNIT),0) DISCOUNT
       ,0 ACTUALS FROM (
SELECT PROJECTION_DETAILS_SID,SEMI_ANNUAL,YEAR, SUM(DOLLAR) DOLLAR, SUM(UNIT) UNITS, MIN(UNIT) UNIT,SUM(SALES) SALES,MIN(NULLIF(SALES,0)) SALE FROM (
       SELECT SUM(ACTUAL_DISCOUNT_DOLLAR) DOLLAR
              ,SUM(SP.ACTUAL_UNITS) UNIT
              ,SUM(SP.ACTUAL_SALES) SALES
              ,S.RS_MODEL_SID
              ,P.SEMI_ANNUAL
              ,P.YEAR
			 , S.PROJECTION_DETAILS_SID
       FROM ST_NM_ACTUAL_PPA S
          LEFT JOIN ST_NM_ACTUAL_SALES SP ON SP.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
              AND SP.PERIOD_SID = S.PERIOD_SID
       JOIN PERIOD P ON P.PERIOD_SID = S.PERIOD_SID
          JOIN PROJECTION_DETAILS PD ON PD.PROJECTION_DETAILS_SID=S.PROJECTION_DETAILS_SID
       JOIN @CCP C ON C.CCP_DETAILS_SID= PD.CCP_DETAILS_SID
                     WHERE PD.PROJECTION_MASTER_SID = ?
              AND PERIOD_DATE BETWEEN CONVERT(DATE, '?')
                     AND CONVERT(DATE, '?')


       GROUP BY  S.PROJECTION_DETAILS_SID,S.RS_MODEL_SID
              ,P.SEMI_ANNUAL
              ,P.YEAR
       ) A
	   GROUP BY  PROJECTION_DETAILS_SID,YEAR
       ,SEMI_ANNUAL
	   )B
GROUP BY  YEAR
       ,SEMI_ANNUAL

UNION

SELECT SEMI_ANNUAL
       ,YEAR
       ,SUM(DOLLAR) PROJECTION_DISCOUNT_DOLLAR1
       ,SUM(DOLLAR)/NULLIF(SUM(SALE),0) RATE
       ,SUM(UNIT) PROJECTION_DISCOUNT_UNITS1
       ,SUM(DOLLAR)/NULLIF(SUM(UNIT),0) DISCOUNT
       ,1 ACTUALS
FROM (
SELECT PROJECTION_DETAILS_SID,SEMI_ANNUAL,YEAR, SUM(DOLLAR) DOLLAR, SUM(UNIT) UNITS, MIN(NULLIF(UNIT,0)) UNIT,SUM(SALES) SALES,MIN(NULLIF(SALES,0)) SALE FROM (
       SELECT SUM(PROJECTION_DISCOUNT_DOLLAR) DOLLAR
              ,SUM(SP.PROJECTION_UNITS) UNIT
              ,SUM(SP.PROJECTION_SALES) SALES
              ,S.RS_MODEL_SID
              ,P.SEMI_ANNUAL
              ,P.YEAR
			  ,S.PROJECTION_DETAILS_SID
       FROM ST_NM_PPA_PROJECTION S
          JOIN PERIOD P ON P.PERIOD_SID=S.PERIOD_SID
       LEFT JOIN ST_NM_SALES_PROJECTION SP ON SP.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
              AND SP.PERIOD_SID = S.PERIOD_SID
       JOIN PROJECTION_DETAILS PD ON PD.PROJECTION_DETAILS_SID=S.PROJECTION_DETAILS_SID
       JOIN @CCP C ON C.CCP_DETAILS_SID= PD.CCP_DETAILS_SID
      WHERE PD.PROJECTION_MASTER_SID = ?
              AND PERIOD_DATE BETWEEN CONVERT(DATE, '?')
                     AND CONVERT(DATE, '?')
       GROUP BY S.PROJECTION_DETAILS_SID,S.RS_MODEL_SID
              ,P.SEMI_ANNUAL
              ,P.YEAR
       ) A
  GROUP BY  PROJECTION_DETAILS_SID,YEAR
       ,SEMI_ANNUAL
	   )B
GROUP BY  YEAR
       ,SEMI_ANNUAL

ORDER BY YEAR
       ,SEMI_ANNUAL;

		
    ]]> </query>
</entity>
<entity id="PPAResults.dataForTableLoad-Custom-annually">
<query> <![CDATA[
		
        SELECT YEAR1
       ,YEAR
       ,SUM(DOLLAR) ACTUAL_DISCOUNT_DOLLAR
       ,SUM(DOLLAR)/NULLIF(SUM(SALE),0) RATE
       ,SUM(UNIT) PROJECTION_DISCOUNT_UNITS1
       ,SUM(DOLLAR)/NULLIF(SUM(UNIT),0) DISCOUNT
       ,0 ACTUALS FROM (
SELECT PROJECTION_DETAILS_SID,YEAR1,YEAR, SUM(DOLLAR) DOLLAR, SUM(UNIT) UNITS, MIN(UNIT) UNIT,SUM(SALES) SALES,MIN(NULLIF(SALES,0)) SALE FROM (
       SELECT SUM(ACTUAL_DISCOUNT_DOLLAR) DOLLAR
              ,SUM(SP.ACTUAL_UNITS) UNIT
              ,SUM(SP.ACTUAL_SALES) SALES
              ,S.RS_MODEL_SID
              ,P.YEAR YEAR1
              ,P.YEAR
			 , S.PROJECTION_DETAILS_SID
       FROM ST_NM_ACTUAL_PPA S
          LEFT JOIN ST_NM_ACTUAL_SALES SP ON SP.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
              AND SP.PERIOD_SID = S.PERIOD_SID
       JOIN PERIOD P ON P.PERIOD_SID = S.PERIOD_SID
          JOIN PROJECTION_DETAILS PD ON PD.PROJECTION_DETAILS_SID=S.PROJECTION_DETAILS_SID
       JOIN @CCP C ON C.CCP_DETAILS_SID= PD.CCP_DETAILS_SID
                     WHERE PD.PROJECTION_MASTER_SID = ?
              AND PERIOD_DATE BETWEEN CONVERT(DATE, '?')
                     AND CONVERT(DATE, '?')


       GROUP BY  S.PROJECTION_DETAILS_SID,S.RS_MODEL_SID
              ,P.YEAR
       ) A
	   GROUP BY  PROJECTION_DETAILS_SID,YEAR
       ,YEAR1
	   )B
GROUP BY  YEAR
       ,YEAR1

UNION

SELECT YEAR1
       ,YEAR
       ,SUM(DOLLAR) PROJECTION_DISCOUNT_DOLLAR1
       ,SUM(DOLLAR)/NULLIF(SUM(SALE),0) RATE
       ,SUM(UNIT) PROJECTION_DISCOUNT_UNITS1
       ,SUM(DOLLAR)/NULLIF(SUM(UNIT),0) DISCOUNT
       ,1 ACTUALS
FROM (
SELECT PROJECTION_DETAILS_SID,YEAR1,YEAR, SUM(DOLLAR) DOLLAR, SUM(UNIT) UNITS, MIN(NULLIF(UNIT,0)) UNIT,SUM(SALES) SALES,MIN(NULLIF(SALES,0)) SALE FROM (
       SELECT SUM(PROJECTION_DISCOUNT_DOLLAR) DOLLAR
              ,SUM(SP.PROJECTION_UNITS) UNIT
              ,SUM(SP.PROJECTION_SALES) SALES
              ,S.RS_MODEL_SID
              ,P.YEAR YEAR1
              ,P.YEAR
			  ,S.PROJECTION_DETAILS_SID
       FROM ST_NM_PPA_PROJECTION S
          JOIN PERIOD P ON P.PERIOD_SID=S.PERIOD_SID
       LEFT JOIN ST_NM_SALES_PROJECTION SP ON SP.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
              AND SP.PERIOD_SID = S.PERIOD_SID
       JOIN PROJECTION_DETAILS PD ON PD.PROJECTION_DETAILS_SID=S.PROJECTION_DETAILS_SID
       JOIN @CCP C ON C.CCP_DETAILS_SID= PD.CCP_DETAILS_SID
      WHERE PD.PROJECTION_MASTER_SID = ?
              AND PERIOD_DATE BETWEEN CONVERT(DATE, '?')
                     AND CONVERT(DATE, '?')
       GROUP BY S.PROJECTION_DETAILS_SID,S.RS_MODEL_SID
              ,P.YEAR
       ) A
  GROUP BY  PROJECTION_DETAILS_SID,YEAR
       ,YEAR1
	   )B
GROUP BY  YEAR
       ,YEAR1

ORDER BY YEAR
       ,YEAR1
		
    ]]> </query>
</entity>
<entity id="ppa-details-generate">
<query> <![CDATA[
        
        SELECT p.year
       ,p.MONTH
       ,ipq.PRICING_QUALIFIER price_protection_price_type
       ,snpp.Price Price
       ,snpp.PriceChange PriceChange
       ,snpp.PROJECTION_MAP map
       ,snpp.TotalDeductions TotalDeductions
       ,snpp.PROJECTION_DISCOUNT_UNITS units
       ,snpp.deduction_per_unit projection_deduction_per_unit
       ,snpp.NetPrice NetPrice
       ,snpp.NetMap NetMap
       ,snpp.PriceProtectionAmountPerUnit PriceProtectionAmountPerUnit
       ,snpp.PriceProtectionPercentage PriceProtectionPercent
       ,snpp.TotalPriceProtectionDeduction TotalPriceProtectionDeduction
       ,snpp.NEP
       ,snpp.NEP_Formula
       ,HT1.DESCRIPTION Price_Tolerance_Type
       ,snpp.Price_Tolerance
       ,HT2.DESCRIPTION Price_Tolerance_Interval
       ,HT3.DESCRIPTION Price_Tolerance_Frequency
       ,snpp.Max_Incremental_Change
       ,HT4.DESCRIPTION Reset_Eligible
       ,HT5.DESCRIPTION Reset_Type
       ,snpp.Reset_Date
       ,HT6.DESCRIPTION Reset_Interval
       ,HT7.DESCRIPTION Reset_Frequency
       ,HT8.DESCRIPTION Net_Price_Type
       ,nsfm.NET_SALES_FORMULA_NAME Net_Price_Type_Formula
FROM ST_NM_PPA_PROJECTION snpp
LEFT JOIN ITEM_PRICING_QUALIFIER ipq ON ipq.ITEM_PRICING_QUALIFIER_SID = snpp.ITEM_PRICING_QUALIFIER_SID
LEFT JOIN HELPER_TABLE HT1 ON HT1.HELPER_TABLE_SID = SNPP.PRICE_TOLERANCE_TYPE
       AND SNPP.PRICE_TOLERANCE_TYPE <> 0
LEFT JOIN HELPER_TABLE HT2 ON HT2.HELPER_TABLE_SID = SNPP.PRICE_TOLERANCE_INTERVAL
       AND SNPP.PRICE_TOLERANCE_INTERVAL <> 0
LEFT JOIN HELPER_TABLE HT3 ON HT3.HELPER_TABLE_SID = SNPP.PRICE_TOLERANCE_FREQUENCY
       AND SNPP.PRICE_TOLERANCE_FREQUENCY <> 0
LEFT JOIN HELPER_TABLE HT4 ON HT4.HELPER_TABLE_SID = SNPP.RESET_ELIGIBLE
       AND SNPP.RESET_ELIGIBLE <> 0
LEFT JOIN HELPER_TABLE HT5 ON HT5.HELPER_TABLE_SID = SNPP.RESET_TYPE
       AND SNPP.RESET_TYPE <> 0
LEFT JOIN HELPER_TABLE HT6 ON HT6.HELPER_TABLE_SID = SNPP.RESET_INTERVAL
       AND SNPP.RESET_INTERVAL <> 0
LEFT JOIN HELPER_TABLE HT7 ON HT7.HELPER_TABLE_SID = SNPP.RESET_FREQUENCY
       AND SNPP.RESET_FREQUENCY <> 0
LEFT JOIN HELPER_TABLE HT8 ON HT8.HELPER_TABLE_SID = SNPP.NET_PRICE_TYPE
       AND SNPP.NET_PRICE_TYPE <> 0
LEFT JOIN NET_SALES_FORMULA_MASTER NSFM ON NSFM.NET_SALES_FORMULA_MASTER_SID=SNPP.NET_PRICE_TYPE_FORMULA
JOIN projection_details pd ON pd.PROJECTION_DETAILS_SID = snpp.PROJECTION_DETAILS_SID
JOIN ccp_details cd ON cd.ccp_details_sid = pd.ccp_details_sid
JOIN period p ON p.period_sid = snpp.period_sid
WHERE  pd.projection_master_sid = @projid
      AND cd.contract_master_sid = @contractsid
      AND cd.COMPANY_MASTER_SID = @compsid
      AND cd.ITEM_MASTER_SID = @itemsid 
      AND p.PERIOD_SID between @from and @to ORDER BY p.year @order ,p.MONTH @order OFFSET @start ROWS FETCH NEXT @end ROWS ONLY
      
      
      
      
        
    ]]> </query>
</entity>
<entity id="ppa-details-count">
<query> <![CDATA[
        
        
        SELECT count(*)
 FROM ST_NM_PPA_PROJECTION snpp
 LEFT JOIN ITEM_PRICING_QUALIFIER ipq ON ipq.ITEM_PRICING_QUALIFIER_SID = snpp.ITEM_PRICING_QUALIFIER_SID
 JOIN projection_details pd ON pd.PROJECTION_DETAILS_SID = snpp.PROJECTION_DETAILS_SID
 JOIN ccp_details cd ON cd.ccp_details_sid = pd.ccp_details_sid
 JOIN period p ON p.period_sid = snpp.period_sid
 WHERE pd.projection_master_sid = @projid
      AND cd.contract_master_sid = @contractsid
      AND cd.COMPANY_MASTER_SID = @compsid
      AND cd.ITEM_MASTER_SID = @itemsid
      AND p.PERIOD_SID between @from and @to
      
        
    ]]> </query>
</entity>
<entity id="contract-ddlb">
<query> <![CDATA[
        
        
       SELECT    C.CONTRACT_MASTER_SID,
          CM.CONTRACT_NO
FROM      PROJECTION_MASTER A
JOIN      PROJECTION_DETAILS B ON A.PROJECTION_MASTER_SID = B.PROJECTION_MASTER_SID
JOIN      CCP_DETAILS C ON C.CCP_DETAILS_SID = B.CCP_DETAILS_SID
JOIN      CONTRACT_MASTER CM ON CM.CONTRACT_MASTER_SID = C.CONTRACT_MASTER_SID
JOIN      COMPANY_MASTER COM ON COM.COMPANY_MASTER_SID = C.COMPANY_MASTER_SID
JOIN      ITEM_MASTER IM ON IM.ITEM_MASTER_SID = C.ITEM_MASTER_SID
LEFT JOIN BRAND_MASTER BM ON BM.BRAND_MASTER_SID = IM.BRAND_MASTER_SID
WHERE     A.PROJECTION_MASTER_SID = @projid AND CM.CONTRACT_NO LIKE @FILTER
GROUP     BY C.CONTRACT_MASTER_SID,
             CM.CONTRACT_NO ORDER BY CM.CONTRACT_NO
      
        
    ]]> </query>
</entity>
<entity id="customer-ddlb">
<query> <![CDATA[
        
        
       SELECT    C.COMPANY_MASTER_SID,
          COM.COMPANY_NO
FROM      PROJECTION_MASTER A
JOIN      PROJECTION_DETAILS B ON A.PROJECTION_MASTER_SID = B.PROJECTION_MASTER_SID
JOIN      CCP_DETAILS C ON C.CCP_DETAILS_SID = B.CCP_DETAILS_SID
JOIN      CONTRACT_MASTER CM ON CM.CONTRACT_MASTER_SID = C.CONTRACT_MASTER_SID
JOIN      COMPANY_MASTER COM ON COM.COMPANY_MASTER_SID = C.COMPANY_MASTER_SID
JOIN      ITEM_MASTER IM ON IM.ITEM_MASTER_SID = C.ITEM_MASTER_SID
LEFT JOIN BRAND_MASTER BM ON BM.BRAND_MASTER_SID = IM.BRAND_MASTER_SID
WHERE     A.PROJECTION_MASTER_SID = @projid 
          AND CM.CONTRACT_MASTER_SID = @contractsid AND COM.COMPANY_NO LIKE @FILTER GROUP BY C.COMPANY_MASTER_SID,
             COM.COMPANY_NO ORDER BY COM.COMPANY_NO  
      
        
    ]]> </query>
</entity>
<entity id="brand-ddlb">
<query> <![CDATA[
        
        
      SELECT    IM.BRAND_MASTER_SID,
          BM.BRAND_NAME
FROM      PROJECTION_MASTER A
JOIN      PROJECTION_DETAILS B ON A.PROJECTION_MASTER_SID = B.PROJECTION_MASTER_SID
JOIN      CCP_DETAILS C ON C.CCP_DETAILS_SID = B.CCP_DETAILS_SID
JOIN      CONTRACT_MASTER CM ON CM.CONTRACT_MASTER_SID = C.CONTRACT_MASTER_SID
JOIN      COMPANY_MASTER COM ON COM.COMPANY_MASTER_SID = C.COMPANY_MASTER_SID
JOIN      ITEM_MASTER IM ON IM.ITEM_MASTER_SID = C.ITEM_MASTER_SID
LEFT JOIN BRAND_MASTER BM ON BM.BRAND_MASTER_SID = IM.BRAND_MASTER_SID
WHERE     A.PROJECTION_MASTER_SID = @projid
          AND CM.CONTRACT_MASTER_SID= @contractsid           AND COM.COMPANY_MASTER_SID = @compsid 
            AND BM.BRAND_NAME LIKE @FILTER
            GROUP BY IM.BRAND_MASTER_SID,
             BM.BRAND_NAME ORDER BY BM.BRAND_NAME  
      
        
    ]]> </query>
</entity>
<entity id="itemno-ddlb">
<query> <![CDATA[
        
        
         SELECT    IM.ITEM_MASTER_SID,
           ITEM_NO , ITEM_NAME
 FROM      PROJECTION_MASTER A
 JOIN      PROJECTION_DETAILS B ON A.PROJECTION_MASTER_SID = B.PROJECTION_MASTER_SID
 JOIN      CCP_DETAILS C ON C.CCP_DETAILS_SID = B.CCP_DETAILS_SID
 JOIN      CONTRACT_MASTER CM ON CM.CONTRACT_MASTER_SID = C.CONTRACT_MASTER_SID
 JOIN      COMPANY_MASTER COM ON COM.COMPANY_MASTER_SID = C.COMPANY_MASTER_SID
 JOIN      ITEM_MASTER IM ON IM.ITEM_MASTER_SID = C.ITEM_MASTER_SID
 LEFT JOIN BRAND_MASTER BM ON BM.BRAND_MASTER_SID = IM.BRAND_MASTER_SID
 WHERE     A.PROJECTION_MASTER_SID = @projid
           AND CM.CONTRACT_MASTER_SID =@contractsid           AND COM.COMPANY_MASTER_SID =  @compsid    
       AND BM.BRAND_MASTER_SID =  @brandsid AND IM.ITEM_MASTER_SID NOT IN (@itemsid) AND IM.ITEM_NO LIKE @FILTER AND IM.ITEM_NAME LIKE @FILTER
GROUP     BY IM.ITEM_MASTER_SID,
              ITEM_NO ,ITEM_NAME ORDER BY IM.ITEM_MASTER_SID 
      
        
    ]]> </query>
</entity>
<entity id="itemname-ddlb">
<query> <![CDATA[
        
        SELECT    IM.ITEM_MASTER_SID,
           ITEM_NAME
 FROM      PROJECTION_MASTER A
 JOIN      PROJECTION_DETAILS B ON A.PROJECTION_MASTER_SID = B.PROJECTION_MASTER_SID
 JOIN      CCP_DETAILS C ON C.CCP_DETAILS_SID = B.CCP_DETAILS_SID
 JOIN      CONTRACT_MASTER CM ON CM.CONTRACT_MASTER_SID = C.CONTRACT_MASTER_SID
 JOIN      COMPANY_MASTER COM ON COM.COMPANY_MASTER_SID = C.COMPANY_MASTER_SID
 JOIN      ITEM_MASTER IM ON IM.ITEM_MASTER_SID = C.ITEM_MASTER_SID
 LEFT JOIN BRAND_MASTER BM ON BM.BRAND_MASTER_SID = IM.BRAND_MASTER_SID
 WHERE     A.PROJECTION_MASTER_SID = @projid
           AND CM.CONTRACT_MASTER_SID =@contractsid           AND COM.COMPANY_MASTER_SID =  @compsid    
       AND BM.BRAND_MASTER_SID =  @brandsid @itemno GROUP     BY IM.ITEM_MASTER_SID,
              ITEM_NAME ORDER BY IM.ITEM_MASTER_SID
      
        
    ]]> </query>
</entity>
<entity id="PPAResults.CustomCCPQuary2">
<query> <![CDATA[
        
         	
                
    DECLARE @CCP TABLE
  (
     RELATIONSHIP_LEVEL_SID INT,
     CCP_DETAILS_SID        INT,
     HIERARCHY_NO           VARCHAR(50)
  )
  
INSERT INTO @CCP
            (RELATIONSHIP_LEVEL_SID,
             CCP_DETAILS_SID,
             HIERARCHY_NO)
      SELECT DISTINCT coalesce(HLDp.RELATIONSHIP_LEVEL_SID,HLDc.RELATIONSHIP_LEVEL_SID),
				CCPMAPp.CCP_DETAILS_SID,
				coalesce(HLDp.HIERARCHY_NO,HLDc.HIERARCHY_NO)
        FROM   (SELECT DISTINCT RLD.RELATIONSHIP_LEVEL_VALUES,
               RLD.HIERARCHY_NO,
               CCP.CCP_DETAILS_SID
        FROM   RELATIONSHIP_LEVEL_DEFINITION RLD
               JOIN CCP_MAP CCP
                 ON RLD.RELATIONSHIP_LEVEL_SID = CCP.RELATIONSHIP_LEVEL_SID
               JOIN PROJECTION_DETAILS PD
                 ON PD.CCP_DETAILS_SID = CCP.CCP_DETAILS_SID
                    AND PD.PROJECTION_MASTER_SID = ?
               JOIN ST_NM_PPA_PROJECTION_MASTER S
                 ON S.PROJECTION_DETAILS_SID = PD.PROJECTION_DETAILS_SID
        WHERE  S.USER_GROUP LIKE '?'
               AND S.USER_ID = ?
               AND S.SESSION_ID = ?) CCPMAPC
       JOIN (SELECT DISTINCT RLD.RELATIONSHIP_LEVEL_VALUES,
                    RLD.HIERARCHY_NO,
                    CCP.CCP_DETAILS_SID
             FROM   RELATIONSHIP_LEVEL_DEFINITION RLD
                    JOIN CCP_MAP CCP
                      ON RLD.RELATIONSHIP_LEVEL_SID = CCP.RELATIONSHIP_LEVEL_SID
                    JOIN PROJECTION_DETAILS PD
                      ON PD.CCP_DETAILS_SID = CCP.CCP_DETAILS_SID
                         AND PD.PROJECTION_MASTER_SID = ?
                    JOIN ST_NM_PPA_PROJECTION_MASTER S
                      ON S.PROJECTION_DETAILS_SID = PD.PROJECTION_DETAILS_SID
             WHERE  S.USER_GROUP LIKE '?'
                    AND S.USER_ID = ?
                    AND S.SESSION_ID = ?) CCPMAPP
         ON CCPMAPC.CCP_DETAILS_SID = CCPMAPP.CCP_DETAILS_SID
      LEFT JOIN (SELECT DISTINCT RLD2.HIERARCHY_NO,
                    RLD2.RELATIONSHIP_LEVEL_SID,
                    CVD.LEVEL_NO,
                     RLD2.RELATIONSHIP_LEVEL_VALUES
             FROM   CUSTOM_VIEW_DETAILS CVD
                    JOIN CUSTOM_VIEW_MASTER CVM
                      ON CVD.CUSTOM_VIEW_MASTER_SID = ?
                         AND CVD.LEVEL_NO LIKE '?%'
                    JOIN HIERARCHY_LEVEL_DEFINITION HLD
                      ON CVD.HIERARCHY_ID = HLD.HIERARCHY_LEVEL_DEFINITION_SID
                    JOIN RELATIONSHIP_LEVEL_DEFINITION RLD2
                      ON HLD.HIERARCHY_LEVEL_DEFINITION_SID = RLD2.HIERARCHY_LEVEL_DEFINITION_SID
                    JOIN PROJECTION_CUST_HIERARCHY PCH2
                      ON PCH2.RELATIONSHIP_LEVEL_SID = RLD2.RELATIONSHIP_LEVEL_SID
                         AND PCH2.PROJECTION_MASTER_SID = ?
             WHERE  RLD2.HIERARCHY_NO LIKE '?%') HLDC
         ON CCPMAPC.HIERARCHY_NO LIKE HLDC.HIERARCHY_NO + '%'
      LEFT JOIN (SELECT DISTINCT RLD2.HIERARCHY_NO,
                    RLD2.RELATIONSHIP_LEVEL_SID,
                    CVD.LEVEL_NO,
                    RLD2.RELATIONSHIP_LEVEL_VALUES
             FROM   CUSTOM_VIEW_DETAILS CVD
                    JOIN CUSTOM_VIEW_MASTER CVM
                      ON CVD.CUSTOM_VIEW_MASTER_SID = ?
                         AND CVD.LEVEL_NO LIKE '?%'
                    JOIN HIERARCHY_LEVEL_DEFINITION HLD
                      ON CVD.HIERARCHY_ID = HLD.HIERARCHY_LEVEL_DEFINITION_SID
                    JOIN RELATIONSHIP_LEVEL_DEFINITION RLD2
                      ON HLD.HIERARCHY_LEVEL_DEFINITION_SID = RLD2.HIERARCHY_LEVEL_DEFINITION_SID
                    JOIN PROJECTION_PROD_HIERARCHY PCH2
                      ON PCH2.RELATIONSHIP_LEVEL_SID = RLD2.RELATIONSHIP_LEVEL_SID
                         AND PCH2.PROJECTION_MASTER_SID = ?
                          WHERE  RLD2.HIERARCHY_NO LIKE '?%') HLDP
         ON CCPMAPP.HIERARCHY_NO LIKE HLDP.HIERARCHY_NO + '%'
           where exists 
       (select C.CCP_DETAILS_SID from ccP_details c where c.CCP_DETAILS_SID=CCPMAPp.CCP_DETAILS_SID and
       c.COMPANY_MASTER_SID=HLDC.RELATIONSHIP_LEVEL_VALUES and c.ITEM_MASTER_SID=HLDP.RELATIONSHIP_LEVEL_VALUES)
 and coalesce(HLDp.RELATIONSHIP_LEVEL_SID,HLDc.RELATIONSHIP_LEVEL_SID) is not null; 
		
          
    ]]> </query>
</entity>
<entity id="PPAResults.dataForTableLoad-Quaterly1-View">
<query> <![CDATA[
                        

           DECLARE @RELATIONSHIPBUILDERSHIPSID INT =?,
                @PROJECTIONMASTERSID    INT =?,
                        @HIERARCHY_NO VARCHAR(100)= '?%',
                        @LEVEL_NO INT=?,
                        @USER_GROUP VARCHAR(50)='?',
                        @START_DATE VARCHAR(50)='?',
                        @END_DATE VARCHAR(50)='?'

        DECLARE @CCP TABLE
          (
             PROJECTION_DETAILS_SID INT
            
          )

        INSERT INTO @CCP
                    (PROJECTION_DETAILS_SID
                     )
        SELECT distinct PD.PROJECTION_DETAILS_SID AS PROJECTION_DETAILS_SID
              
        FROM   RELATIONSHIP_LEVEL_DEFINITION RLD
               JOIN PROJECTION_CUST_HIERARCHY PCH
                 ON PCH.PROJECTION_MASTER_SID = @PROJECTIONMASTERSID
                    AND RLD.RELATIONSHIP_LEVEL_SID = PCH.RELATIONSHIP_LEVEL_SID
                    AND RLD.RELATIONSHIP_BUILDER_SID = @RELATIONSHIPBUILDERSHIPSID
               JOIN RELATIONSHIP_LEVEL_DEFINITION RLD1
                 ON RLD1.HIERARCHY_NO LIKE @HIERARCHY_NO
                    AND RLD.RELATIONSHIP_BUILDER_SID = RLD1.RELATIONSHIP_BUILDER_SID
                    AND RLD.HIERARCHY_NO LIKE RLD1.HIERARCHY_NO + '%'
                    AND RLD1.LEVEL_NO = @LEVEL_NO
               JOIN CCP_MAP CCPMAP
                 ON CCPMAP.RELATIONSHIP_LEVEL_SID = RLD.RELATIONSHIP_LEVEL_SID
               JOIN PROJECTION_DETAILS PD
                 ON PD.CCP_DETAILS_SID = CCPMAP.CCP_DETAILS_SID
               JOIN NM_PPA_PROJECTION_MASTER A
                 ON pd.PROJECTION_DETAILS_SID = A.PROJECTION_DETAILS_SID
                    
                    AND Isnull(A.USER_GROUP, '0') LIKE @USER_GROUP
                           AND EXISTS (
              SELECT 1
              FROM PROJECTION_DETAILS PR
              WHERE PR.PROJECTION_MASTER_SID = @PROJECTIONMASTERSID
                     AND PR.PROJECTION_DETAILS_SID = PD.PROJECTION_DETAILS_SID
              );


        SELECT QUARTER
               ,YEAR
               ,SUM(DOLLAR) ACTUAL_DISCOUNT_DOLLAR
               ,SUM(DOLLAR)/NULLIF(SUM(SALE),0) RATE
               ,SUM(UNIT) PROJECTION_DISCOUNT_UNITS1
               ,SUM(DOLLAR)/NULLIF(SUM(UNIT),0) DISCOUNT
               ,0 ACTUALS
                   FROM (
        SELECT QUARTER,YEAR,SUM(DOLLAR) DOLLAR,MIN(NULLIF(UNIT,0)) UNIT,MIN(NULLIF(SALES,0)) SALE,SUM(UNIT) UNITS,SUM(SALES) SALES,PROJECTION_DETAILS_SID FROM (
               SELECT SUM(ACTUAL_DISCOUNT_DOLLAR) DOLLAR
                      ,SUM(SP.ACTUAL_UNITS) UNIT
                      ,SUM(SP.ACTUAL_SALES) SALES
                      ,S.RS_MODEL_SID
                      ,P.QUARTER 
                      ,P.YEAR
                                  ,S.PROJECTION_DETAILS_SID
                FROM NM_ACTUAL_PPA S
                        LEFT JOIN NM_ACTUAL_SALES SP ON SP.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                              
                                AND SP.PERIOD_SID = S.PERIOD_SID
                        JOIN PERIOD P ON P.PERIOD_SID = S.PERIOD_SID
                        JOIN @CCP C ON C.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                                
                        GROUP BY S.PROJECTION_DETAILS_SID
                                ,S.RS_MODEL_SID
                                ,P.QUARTER
                                ,P.YEAR ) A
                                  GROUP BY PROJECTION_DETAILS_SID,YEAR
               ,QUARTER) B 
        GROUP BY YEAR
               ,QUARTER

        UNION

        SELECT QUARTER
               ,YEAR
               ,SUM(DOLLAR) PROJECTION_DISCOUNT_DOLLAR1
               ,SUM(DOLLAR)/NULLIF(SUM(SALES),0)
               ,SUM(UNIT) PROJECTION_DISCOUNT_UNITS1
               ,SUM(DOLLAR)/NULLIF(SUM(UNIT),0) 
               ,1 ACTUALS
                   FROM
                   (
        SELECT PROJECTION_DETAILS_SID,MIN(NULLIF(UNIT,0)) UNIT,MIN(NULLIF(SALES,0)) SALES,SUM(UNIT) UNITS ,SUM(DOLLAR) DOLLAR,SUM(SALES) SALE,QUARTER,YEAR FROM (
               SELECT SUM(PROJECTION_DISCOUNT_DOLLAR) DOLLAR
                      ,SUM(SP.PROJECTION_UNITS) UNIT
                      ,SUM(SP.PROJECTION_SALES) SALES
                      ,S.RS_MODEL_SID
                      ,P.QUARTER 
                      ,P.YEAR
                                  ,S.PROJECTION_DETAILS_SID
              FROM NM_PPA_PROJECTION S
                        LEFT JOIN NM_SALES_PROJECTION SP ON SP.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                                
                                AND SP.PERIOD_SID = S.PERIOD_SID
                        JOIN PERIOD P ON P.PERIOD_SID = S.PERIOD_SID
                        JOIN @CCP C ON C.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                               
                        GROUP BY S.PROJECTION_DETAILS_SID
                                ,S.RS_MODEL_SID
                                ,P.QUARTER
                                ,P.YEAR
               ) A
                   GROUP BY PROJECTION_DETAILS_SID,QUARTER,YEAR) B
                   GROUP BY YEAR
               ,QUARTER
        ORDER BY YEAR
               ,QUARTER

                        
            ]]> </query>
</entity>
<entity id="PPAResults.dataForTableLoad-Annually-View">
<query> <![CDATA[
                            

                 DECLARE @RELATIONSHIPBUILDERSHIPSID INT =?,
                    @PROJECTIONMASTERSID    INT =?,
                            @HIERARCHY_NO VARCHAR(100)= '?%',
                            @LEVEL_NO INT=?,
                            @USER_GROUP VARCHAR(50)='?',
                            @START_DATE VARCHAR(50)='?',
                            @END_DATE VARCHAR(50)='?'

            DECLARE @CCP TABLE
              (
                 PROJECTION_DETAILS_SID INT
              )

            INSERT INTO @CCP
                        (PROJECTION_DETAILS_SID)
            SELECT distinct PD.PROJECTION_DETAILS_SID AS PROJECTION_DETAILS_SID
            FROM   RELATIONSHIP_LEVEL_DEFINITION RLD
                   JOIN PROJECTION_CUST_HIERARCHY PCH
                     ON PCH.PROJECTION_MASTER_SID = @PROJECTIONMASTERSID
                        AND RLD.RELATIONSHIP_LEVEL_SID = PCH.RELATIONSHIP_LEVEL_SID
                        AND RLD.RELATIONSHIP_BUILDER_SID = @RELATIONSHIPBUILDERSHIPSID
                   JOIN RELATIONSHIP_LEVEL_DEFINITION RLD1
                     ON RLD1.HIERARCHY_NO LIKE @HIERARCHY_NO
                        AND RLD.RELATIONSHIP_BUILDER_SID = RLD1.RELATIONSHIP_BUILDER_SID
                        AND RLD.HIERARCHY_NO LIKE RLD1.HIERARCHY_NO + '%'
                        AND RLD1.LEVEL_NO = @LEVEL_NO
                   JOIN CCP_MAP CCPMAP
                     ON CCPMAP.RELATIONSHIP_LEVEL_SID = RLD.RELATIONSHIP_LEVEL_SID
                   JOIN PROJECTION_DETAILS PD
                     ON PD.CCP_DETAILS_SID = CCPMAP.CCP_DETAILS_SID
                   JOIN  NM_PPA_PROJECTION_MASTER A
                     ON pd.PROJECTION_DETAILS_SID = A.PROJECTION_DETAILS_SID
                       
                        AND Isnull(A.USER_GROUP, '0') LIKE @USER_GROUP
                               AND EXISTS (
              SELECT 1
              FROM PROJECTION_DETAILS PR
              WHERE PR.PROJECTION_MASTER_SID = @PROJECTIONMASTERSID
                     AND PR.PROJECTION_DETAILS_SID = PD.PROJECTION_DETAILS_SID
              );


            SELECT YEAR1
                   ,YEAR
                   ,SUM(DOLLAR) ACTUAL_DISCOUNT_DOLLAR
                   ,SUM(DOLLAR)/NULLIF(SUM(SALE),0) RATE
                   ,SUM(UNIT) PROJECTION_DISCOUNT_UNITS1
                   ,SUM(DOLLAR)/NULLIF(SUM(UNIT),0) DISCOUNT
                   ,0 ACTUALS
                       FROM (
            SELECT YEAR1,YEAR,SUM(DOLLAR) DOLLAR,MIN(NULLIF(UNIT,0)) UNIT,MIN(NULLIF(SALES,0)) SALE,SUM(UNIT) UNITS,SUM(SALES) SALES,PROJECTION_DETAILS_SID FROM (
                   SELECT SUM(ACTUAL_DISCOUNT_DOLLAR) DOLLAR
                          ,SUM(SP.ACTUAL_UNITS) UNIT
                          ,SUM(SP.ACTUAL_SALES) SALES
                          ,S.RS_MODEL_SID
                          ,P.YEAR YEAR1 
                          ,P.YEAR
                                      ,S.PROJECTION_DETAILS_SID
                    FROM  NM_ACTUAL_PPA S
                            LEFT JOIN  NM_ACTUAL_SALES SP ON SP.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                                 
                                    AND SP.PERIOD_SID = S.PERIOD_SID
                            JOIN PERIOD P ON P.PERIOD_SID = S.PERIOD_SID
                            JOIN @CCP C ON C.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                                  
                            GROUP BY S.PROJECTION_DETAILS_SID
                                    ,S.RS_MODEL_SID
                                    ,P.YEAR ) A
                                      GROUP BY PROJECTION_DETAILS_SID,YEAR
                   ,YEAR1) B 
            GROUP BY YEAR
                   ,YEAR1

            UNION

            SELECT YEAR1
                   ,YEAR
                   ,SUM(DOLLAR) PROJECTION_DISCOUNT_DOLLAR1
                   ,SUM(DOLLAR)/NULLIF(SUM(SALES),0)
                   ,SUM(UNIT) PROJECTION_DISCOUNT_UNITS1
                   ,SUM(DOLLAR)/NULLIF(SUM(UNIT),0) 
                   ,1 ACTUALS
                       FROM
                       (
            SELECT PROJECTION_DETAILS_SID,MIN(NULLIF(UNIT,0)) UNIT,MIN(NULLIF(SALES,0)) SALES,SUM(UNIT) UNITS ,SUM(DOLLAR) DOLLAR,SUM(SALES) SALE,YEAR1,YEAR FROM (
                   SELECT SUM(PROJECTION_DISCOUNT_DOLLAR) DOLLAR
                          ,SUM(SP.PROJECTION_UNITS) UNIT
                          ,SUM(SP.PROJECTION_SALES) SALES
                          ,S.RS_MODEL_SID
                          ,P.YEAR YEAR1 
                          ,P.YEAR
                                      ,S.PROJECTION_DETAILS_SID
                  FROM  NM_PPA_PROJECTION S
                            LEFT JOIN  NM_SALES_PROJECTION SP ON SP.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                                    
                                    AND SP.PERIOD_SID = S.PERIOD_SID
                            JOIN PERIOD P ON P.PERIOD_SID = S.PERIOD_SID
                            JOIN @CCP C ON C.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                                    
                            GROUP BY S.PROJECTION_DETAILS_SID
                                    ,S.RS_MODEL_SID
                                    ,P.YEAR
                   ) A
                       GROUP BY PROJECTION_DETAILS_SID,YEAR1,YEAR) B
                       GROUP BY YEAR
                   ,YEAR1
            ORDER BY YEAR
                   ,YEAR1;

                            
                ]]> </query>
</entity>
<entity id="PPAResults.Customer-Semi-Annual-View">
<query> <![CDATA[
                        

            DECLARE @RELATIONSHIPBUILDERSHIPSID INT =?,
                @PROJECTIONMASTERSID    INT =?,
                        @HIERARCHY_NO VARCHAR(100)= '?%',
                        @LEVEL_NO INT=?,
                        @USER_GROUP VARCHAR(50)='?',
                        @START_DATE VARCHAR(50)='?',
                        @END_DATE VARCHAR(50)='?'

        DECLARE @CCP TABLE
          (
             PROJECTION_DETAILS_SID INT
          )

        INSERT INTO @CCP
                    (PROJECTION_DETAILS_SID)
        SELECT distinct PD.PROJECTION_DETAILS_SID AS PROJECTION_DETAILS_SID
        FROM   RELATIONSHIP_LEVEL_DEFINITION RLD
               JOIN PROJECTION_CUST_HIERARCHY PCH
                 ON PCH.PROJECTION_MASTER_SID = @PROJECTIONMASTERSID
                    AND RLD.RELATIONSHIP_LEVEL_SID = PCH.RELATIONSHIP_LEVEL_SID
                    AND RLD.RELATIONSHIP_BUILDER_SID = @RELATIONSHIPBUILDERSHIPSID
               JOIN RELATIONSHIP_LEVEL_DEFINITION RLD1
                 ON RLD1.HIERARCHY_NO LIKE @HIERARCHY_NO
                    AND RLD.RELATIONSHIP_BUILDER_SID = RLD1.RELATIONSHIP_BUILDER_SID
                    AND RLD.HIERARCHY_NO LIKE RLD1.HIERARCHY_NO + '%'
                    AND RLD1.LEVEL_NO = @LEVEL_NO
               JOIN CCP_MAP CCPMAP
                 ON CCPMAP.RELATIONSHIP_LEVEL_SID = RLD.RELATIONSHIP_LEVEL_SID
               JOIN PROJECTION_DETAILS PD
                 ON PD.CCP_DETAILS_SID = CCPMAP.CCP_DETAILS_SID
               JOIN NM_PPA_PROJECTION_MASTER A
                 ON pd.PROJECTION_DETAILS_SID = A.PROJECTION_DETAILS_SID
                   
                    AND Isnull(A.USER_GROUP, '0') LIKE @USER_GROUP
                           AND EXISTS (
              SELECT 1
              FROM PROJECTION_DETAILS PR
              WHERE PR.PROJECTION_MASTER_SID = @PROJECTIONMASTERSID
                     AND PR.PROJECTION_DETAILS_SID = PD.PROJECTION_DETAILS_SID
              );


        SELECT SEMI_ANNUAL
               ,YEAR
               ,SUM(DOLLAR) ACTUAL_DISCOUNT_DOLLAR
               ,SUM(DOLLAR)/NULLIF(SUM(SALE),0) RATE
               ,SUM(UNIT) PROJECTION_DISCOUNT_UNITS1
               ,SUM(DOLLAR)/NULLIF(SUM(UNIT),0) DISCOUNT
               ,0 ACTUALS
                   FROM (
        SELECT SEMI_ANNUAL,YEAR,SUM(DOLLAR) DOLLAR,MIN(NULLIF(UNIT,0)) UNIT,MIN(NULLIF(SALES,0)) SALE,SUM(UNIT) UNITS,SUM(SALES) SALES,PROJECTION_DETAILS_SID FROM (
               SELECT SUM(ACTUAL_DISCOUNT_DOLLAR) DOLLAR
                      ,SUM(SP.ACTUAL_UNITS) UNIT
                      ,SUM(SP.ACTUAL_SALES) SALES
                      ,S.RS_MODEL_SID
                      ,P.SEMI_ANNUAL 
                      ,P.YEAR
                                  ,S.PROJECTION_DETAILS_SID
                FROM NM_ACTUAL_PPA S
                        LEFT JOIN NM_ACTUAL_SALES SP ON SP.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                                
                                AND SP.PERIOD_SID = S.PERIOD_SID
                        JOIN PERIOD P ON P.PERIOD_SID = S.PERIOD_SID
                        JOIN @CCP C ON C.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                                
                        GROUP BY S.PROJECTION_DETAILS_SID
                                ,S.RS_MODEL_SID
                                ,P.SEMI_ANNUAL
                                ,P.YEAR ) A
                                  GROUP BY PROJECTION_DETAILS_SID,YEAR
               ,SEMI_ANNUAL) B 
        GROUP BY YEAR
               ,SEMI_ANNUAL

        UNION

        SELECT SEMI_ANNUAL
               ,YEAR
               ,SUM(DOLLAR) PROJECTION_DISCOUNT_DOLLAR1
               ,SUM(DOLLAR)/NULLIF(SUM(SALES),0)
               ,SUM(UNIT) PROJECTION_DISCOUNT_UNITS1
               ,SUM(DOLLAR)/NULLIF(SUM(UNIT),0) 
               ,1 ACTUALS
                   FROM
                   (
        SELECT PROJECTION_DETAILS_SID,MIN(NULLIF(UNIT,0)) UNIT,MIN(NULLIF(SALES,0)) SALES,SUM(UNIT) UNITS ,SUM(DOLLAR) DOLLAR,SUM(SALES) SALE,SEMI_ANNUAL,YEAR FROM (
               SELECT SUM(PROJECTION_DISCOUNT_DOLLAR) DOLLAR
                      ,SUM(SP.PROJECTION_UNITS) UNIT
                      ,SUM(SP.PROJECTION_SALES) SALES
                      ,S.RS_MODEL_SID
                      ,P.SEMI_ANNUAL 
                      ,P.YEAR
                                  ,S.PROJECTION_DETAILS_SID
              FROM NM_PPA_PROJECTION S
                        LEFT JOIN NM_SALES_PROJECTION SP ON SP.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                                
                                AND SP.PERIOD_SID = S.PERIOD_SID
                        JOIN PERIOD P ON P.PERIOD_SID = S.PERIOD_SID
                        JOIN @CCP C ON C.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                                
                        GROUP BY S.PROJECTION_DETAILS_SID
                                ,S.RS_MODEL_SID
                                ,P.SEMI_ANNUAL
                                ,P.YEAR
               ) A
                   GROUP BY PROJECTION_DETAILS_SID,SEMI_ANNUAL,YEAR) B
                   GROUP BY YEAR
               ,SEMI_ANNUAL
        ORDER BY YEAR
               ,SEMI_ANNUAL

                        
            ]]> </query>
</entity>
<entity id="PPAResults.Monthly-Customer-View">
<query> <![CDATA[
		
               

      DECLARE @RELATIONSHIPBUILDERSHIPSID INT =?,
        @PROJECTIONMASTERSID    INT =?,
		@HIERARCHY_NO VARCHAR(100)= '?%',
		@LEVEL_NO INT=?,
		@USER_GROUP VARCHAR(50)='?',
		@START_DATE VARCHAR(50)='?',
		@END_DATE VARCHAR(50)='?'

DECLARE @CCP TABLE
  (
     PROJECTION_DETAILS_SID INT
    
  )

INSERT INTO @CCP
            (PROJECTION_DETAILS_SID
             )
SELECT distinct PD.PROJECTION_DETAILS_SID AS PROJECTION_DETAILS_SID
     
FROM   RELATIONSHIP_LEVEL_DEFINITION RLD
       JOIN PROJECTION_CUST_HIERARCHY PCH
         ON PCH.PROJECTION_MASTER_SID = @PROJECTIONMASTERSID
            AND RLD.RELATIONSHIP_LEVEL_SID = PCH.RELATIONSHIP_LEVEL_SID
            AND RLD.RELATIONSHIP_BUILDER_SID = @RELATIONSHIPBUILDERSHIPSID
       JOIN RELATIONSHIP_LEVEL_DEFINITION RLD1
         ON RLD1.HIERARCHY_NO LIKE @HIERARCHY_NO
            AND RLD.RELATIONSHIP_BUILDER_SID = RLD1.RELATIONSHIP_BUILDER_SID
            AND RLD.HIERARCHY_NO LIKE RLD1.HIERARCHY_NO + '%'
            AND RLD1.LEVEL_NO = @LEVEL_NO
       JOIN CCP_MAP CCPMAP
         ON CCPMAP.RELATIONSHIP_LEVEL_SID = RLD.RELATIONSHIP_LEVEL_SID
       JOIN PROJECTION_DETAILS PD
         ON PD.CCP_DETAILS_SID = CCPMAP.CCP_DETAILS_SID
       JOIN   NM_PPA_PROJECTION_MASTER A
         ON pd.PROJECTION_DETAILS_SID = A.PROJECTION_DETAILS_SID
           
            AND Isnull(A.USER_GROUP, '0') LIKE @USER_GROUP
                   AND EXISTS (
              SELECT 1
              FROM PROJECTION_DETAILS PR
              WHERE PR.PROJECTION_MASTER_SID = @PROJECTIONMASTERSID
                     AND PR.PROJECTION_DETAILS_SID = PD.PROJECTION_DETAILS_SID
              );


SELECT MONTH
       ,YEAR
       ,SUM(DOLLAR) ACTUAL_DISCOUNT_DOLLAR
       ,SUM(DOLLAR)/NULLIF(SUM(SALE),0) RATE
       ,SUM(UNIT) PROJECTION_DISCOUNT_UNITS1
       ,SUM(DOLLAR)/NULLIF(SUM(UNIT),0) DISCOUNT
       ,0 ACTUALS
	   FROM (
SELECT MONTH,YEAR,SUM(DOLLAR) DOLLAR,MIN(NULLIF(UNIT,0)) UNIT,MIN(NULLIF(SALES,0)) SALE,SUM(UNIT) UNITS,SUM(SALES) SALES,PROJECTION_DETAILS_SID FROM (
       SELECT SUM(ACTUAL_DISCOUNT_DOLLAR) DOLLAR
              ,SUM(SP.ACTUAL_UNITS) UNIT
              ,SUM(SP.ACTUAL_SALES) SALES
              ,S.RS_MODEL_SID
              ,P.MONTH 
              ,P.YEAR
			  ,S.PROJECTION_DETAILS_SID
      	FROM   NM_ACTUAL_PPA S
		LEFT JOIN   NM_ACTUAL_SALES SP ON SP.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
			AND SP.PERIOD_SID = S.PERIOD_SID
			
		JOIN PERIOD P ON P.PERIOD_SID = S.PERIOD_SID
		JOIN @CCP C ON C.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
			
		GROUP BY S.PROJECTION_DETAILS_SID
			,S.RS_MODEL_SID
			,P.MONTH
			,P.YEAR ) A
			  GROUP BY PROJECTION_DETAILS_SID,YEAR
       ,MONTH) B 
GROUP BY YEAR
       ,MONTH

UNION

SELECT MONTH
       ,YEAR
       ,SUM(DOLLAR) PROJECTION_DISCOUNT_DOLLAR1
       ,SUM(DOLLAR)/NULLIF(SUM(SALES),0)
       ,SUM(UNIT) PROJECTION_DISCOUNT_UNITS1
       ,SUM(DOLLAR)/NULLIF(SUM(UNIT),0) 
       ,1 ACTUALS
	   FROM
	   (
SELECT PROJECTION_DETAILS_SID,MIN(NULLIF(UNIT,0)) UNIT,MIN(NULLIF(SALES,0)) SALES,SUM(UNIT) UNITS ,SUM(DOLLAR) DOLLAR,SUM(SALES) SALE,MONTH,YEAR FROM (
       SELECT SUM(PROJECTION_DISCOUNT_DOLLAR) DOLLAR
              ,SUM(SP.PROJECTION_UNITS) UNIT
              ,SUM(SP.PROJECTION_SALES) SALES
              ,S.RS_MODEL_SID
              ,P.MONTH 
              ,P.YEAR
			  ,S.PROJECTION_DETAILS_SID
      FROM   NM_PPA_PROJECTION S
		LEFT JOIN   NM_SALES_PROJECTION SP ON SP.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
			
			AND SP.PERIOD_SID = S.PERIOD_SID
		JOIN PERIOD P ON P.PERIOD_SID = S.PERIOD_SID
		JOIN @CCP C ON C.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
			
		GROUP BY S.PROJECTION_DETAILS_SID
			,S.RS_MODEL_SID
			,P.MONTH
			,P.YEAR
       ) A
	   GROUP BY PROJECTION_DETAILS_SID,MONTH,YEAR) B
	   GROUP BY YEAR
       ,MONTH
ORDER BY YEAR
       ,MONTH
		
    ]]> </query>
</entity>
<entity id="PPAResults.Monthly-Product-View">
<query> <![CDATA[
                        


            DECLARE @RELATIONSHIPBUILDERSHIPSID INT =?,
                @PROJECTIONMASTERSID    INT =?,
                        @HIERARCHY_NO VARCHAR(100)= '?%',
                        @LEVEL_NO INT=?,
                        @START_DATE VARCHAR(50)='?',
                        @END_DATE VARCHAR(50)='?'

        DECLARE @CCP TABLE
          (
             PROJECTION_DETAILS_SID INT
            
          )

        INSERT INTO @CCP
                    (PROJECTION_DETAILS_SID
                     )
        SELECT distinct PD.PROJECTION_DETAILS_SID AS PROJECTION_DETAILS_SID
             
        FROM   RELATIONSHIP_LEVEL_DEFINITION RLD
               JOIN PROJECTION_PROD_HIERARCHY PCH
                 ON PCH.PROJECTION_MASTER_SID = @PROJECTIONMASTERSID
                    AND RLD.RELATIONSHIP_LEVEL_SID = PCH.RELATIONSHIP_LEVEL_SID
                    AND RLD.RELATIONSHIP_BUILDER_SID = @RELATIONSHIPBUILDERSHIPSID
               JOIN RELATIONSHIP_LEVEL_DEFINITION RLD1
                 ON RLD1.HIERARCHY_NO LIKE @HIERARCHY_NO
                    AND RLD.RELATIONSHIP_BUILDER_SID = RLD1.RELATIONSHIP_BUILDER_SID
                    AND RLD.HIERARCHY_NO LIKE RLD1.HIERARCHY_NO + '%'
                    AND RLD1.LEVEL_NO = @LEVEL_NO
               JOIN CCP_MAP CCPMAP
                 ON CCPMAP.RELATIONSHIP_LEVEL_SID = RLD.RELATIONSHIP_LEVEL_SID
               JOIN PROJECTION_DETAILS PD
                 ON PD.CCP_DETAILS_SID = CCPMAP.CCP_DETAILS_SID
               JOIN NM_PPA_PROJECTION_MASTER A
                 ON pd.PROJECTION_DETAILS_SID = A.PROJECTION_DETAILS_SID
AND EXISTS (
              SELECT 1
              FROM PROJECTION_DETAILS PR
              WHERE PR.PROJECTION_MASTER_SID = @PROJECTIONMASTERSID
                     AND PR.PROJECTION_DETAILS_SID = PD.PROJECTION_DETAILS_SID
              );

                  SELECT MONTH
               ,YEAR
               ,SUM(DOLLAR) ACTUAL_DISCOUNT_DOLLAR
               ,SUM(DOLLAR)/NULLIF(SUM(SALE),0) RATE
               ,SUM(UNIT) PROJECTION_DISCOUNT_UNITS1
               ,SUM(DOLLAR)/NULLIF(SUM(UNIT),0) DISCOUNT
               ,0 ACTUALS
                   FROM (
        SELECT MONTH,YEAR,SUM(DOLLAR) DOLLAR,MIN(NULLIF(UNIT,0)) UNIT,MIN(NULLIF(SALES,0)) SALE,SUM(UNIT) UNITS,SUM(SALES) SALES,PROJECTION_DETAILS_SID FROM (
               SELECT SUM(ACTUAL_DISCOUNT_DOLLAR) DOLLAR
                      ,SUM(SP.ACTUAL_UNITS) UNIT
                      ,SUM(SP.ACTUAL_SALES) SALES
                      ,S.RS_MODEL_SID
                      ,P.MONTH 
                      ,P.YEAR
                                  ,S.PROJECTION_DETAILS_SID
                FROM NM_ACTUAL_PPA S
                        LEFT JOIN NM_ACTUAL_SALES SP ON SP.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                                AND SP.PERIOD_SID = S.PERIOD_SID
                        JOIN PERIOD P ON P.PERIOD_SID = S.PERIOD_SID
                        JOIN @CCP C ON C.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                        GROUP BY S.PROJECTION_DETAILS_SID
                                ,S.RS_MODEL_SID
                                ,P.MONTH
                                ,P.YEAR ) A
                                  GROUP BY PROJECTION_DETAILS_SID,YEAR
               ,MONTH) B 
        GROUP BY YEAR
               ,MONTH

        UNION

        SELECT MONTH
               ,YEAR
               ,SUM(DOLLAR) PROJECTION_DISCOUNT_DOLLAR1
               ,SUM(DOLLAR)/NULLIF(SUM(SALES),0)
               ,SUM(UNIT) PROJECTION_DISCOUNT_UNITS1
               ,SUM(DOLLAR)/NULLIF(SUM(UNIT),0) 
               ,1 ACTUALS
                   FROM
                   (
        SELECT PROJECTION_DETAILS_SID,MIN(NULLIF(UNIT,0)) UNIT,MIN(NULLIF(SALES,0)) SALES,SUM(UNIT) UNITS ,SUM(DOLLAR) DOLLAR,SUM(SALES) SALE,MONTH,YEAR FROM (
               SELECT SUM(PROJECTION_DISCOUNT_DOLLAR) DOLLAR
                      ,SUM(SP.PROJECTION_UNITS) UNIT
                      ,SUM(SP.PROJECTION_SALES) SALES
                      ,S.RS_MODEL_SID
                      ,P.MONTH 
                      ,P.YEAR
                                  ,S.PROJECTION_DETAILS_SID
              FROM NM_PPA_PROJECTION S
                        LEFT JOIN NM_SALES_PROJECTION SP ON SP.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                                AND SP.PERIOD_SID = S.PERIOD_SID
                        JOIN PERIOD P ON P.PERIOD_SID = S.PERIOD_SID
                        JOIN @CCP C ON C.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                        GROUP BY S.PROJECTION_DETAILS_SID
                                ,S.RS_MODEL_SID
                                ,P.MONTH
                                ,P.YEAR
               ) A
                   GROUP BY PROJECTION_DETAILS_SID,MONTH,YEAR) B
                   GROUP BY YEAR
               ,MONTH
        ORDER BY YEAR
               ,MONTH;
                        
            ]]> </query>
</entity>
<entity id="PPAResults.dataForTableLoad-Quaterly-Product-View">
<query> <![CDATA[
                        

           DECLARE @RELATIONSHIPBUILDERSHIPSID INT =?,
                @PROJECTIONMASTERSID    INT =?,
                        @HIERARCHY_NO VARCHAR(100)= '?%',
                        @LEVEL_NO INT=?,
                        @START_DATE VARCHAR(50)='?',
                        @END_DATE VARCHAR(50)='?'

        DECLARE @CCP TABLE
          (
             PROJECTION_DETAILS_SID INT
            
          )

        INSERT INTO @CCP
                    (PROJECTION_DETAILS_SID
                     )
        SELECT distinct PD.PROJECTION_DETAILS_SID AS PROJECTION_DETAILS_SID
             
        FROM   RELATIONSHIP_LEVEL_DEFINITION RLD
               JOIN PROJECTION_PROD_HIERARCHY PCH
                 ON PCH.PROJECTION_MASTER_SID = @PROJECTIONMASTERSID
                    AND RLD.RELATIONSHIP_LEVEL_SID = PCH.RELATIONSHIP_LEVEL_SID
                    AND RLD.RELATIONSHIP_BUILDER_SID = @RELATIONSHIPBUILDERSHIPSID
               JOIN RELATIONSHIP_LEVEL_DEFINITION RLD1
                 ON RLD1.HIERARCHY_NO LIKE @HIERARCHY_NO
                    AND RLD.RELATIONSHIP_BUILDER_SID = RLD1.RELATIONSHIP_BUILDER_SID
                    AND RLD.HIERARCHY_NO LIKE RLD1.HIERARCHY_NO + '%'
                    AND RLD1.LEVEL_NO = @LEVEL_NO
               JOIN CCP_MAP CCPMAP
                 ON CCPMAP.RELATIONSHIP_LEVEL_SID = RLD.RELATIONSHIP_LEVEL_SID
               JOIN PROJECTION_DETAILS PD
                 ON PD.CCP_DETAILS_SID = CCPMAP.CCP_DETAILS_SID
               JOIN NM_PPA_PROJECTION_MASTER A
                 ON pd.PROJECTION_DETAILS_SID = A.PROJECTION_DETAILS_SID
AND EXISTS (
              SELECT 1
              FROM PROJECTION_DETAILS PR
              WHERE PR.PROJECTION_MASTER_SID = @PROJECTIONMASTERSID
                     AND PR.PROJECTION_DETAILS_SID = PD.PROJECTION_DETAILS_SID
              );

           SELECT QUARTER
               ,YEAR
               ,SUM(DOLLAR) ACTUAL_DISCOUNT_DOLLAR
               ,SUM(DOLLAR)/NULLIF(SUM(SALE),0) RATE
               ,SUM(UNIT) PROJECTION_DISCOUNT_UNITS1
               ,SUM(DOLLAR)/NULLIF(SUM(UNIT),0) DISCOUNT
               ,0 ACTUALS
                   FROM (
        SELECT QUARTER,YEAR,SUM(DOLLAR) DOLLAR,MIN(NULLIF(UNIT,0)) UNIT,MIN(NULLIF(SALES,0)) SALE,SUM(UNIT) UNITS,SUM(SALES) SALES,PROJECTION_DETAILS_SID FROM (
               SELECT SUM(ACTUAL_DISCOUNT_DOLLAR) DOLLAR
                      ,SUM(SP.ACTUAL_UNITS) UNIT
                      ,SUM(SP.ACTUAL_SALES) SALES
                      ,S.RS_MODEL_SID
                      ,P.QUARTER 
                      ,P.YEAR
                                  ,S.PROJECTION_DETAILS_SID
                FROM NM_ACTUAL_PPA S
                        LEFT JOIN NM_ACTUAL_SALES SP ON SP.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                              
                                AND SP.PERIOD_SID = S.PERIOD_SID
                        JOIN PERIOD P ON P.PERIOD_SID = S.PERIOD_SID
                        JOIN @CCP C ON C.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                                
                        GROUP BY S.PROJECTION_DETAILS_SID
                                ,S.RS_MODEL_SID
                                ,P.QUARTER
                                ,P.YEAR ) A
                                  GROUP BY PROJECTION_DETAILS_SID,YEAR
               ,QUARTER) B 
        GROUP BY YEAR
               ,QUARTER

        UNION

        SELECT QUARTER
               ,YEAR
               ,SUM(DOLLAR) PROJECTION_DISCOUNT_DOLLAR1
               ,SUM(DOLLAR)/NULLIF(SUM(SALES),0)
               ,SUM(UNIT) PROJECTION_DISCOUNT_UNITS1
               ,SUM(DOLLAR)/NULLIF(SUM(UNIT),0) 
               ,1 ACTUALS
                   FROM
                   (
        SELECT PROJECTION_DETAILS_SID,MIN(NULLIF(UNIT,0)) UNIT,MIN(NULLIF(SALES,0)) SALES,SUM(UNIT) UNITS ,SUM(DOLLAR) DOLLAR,SUM(SALES) SALE,QUARTER,YEAR FROM (
               SELECT SUM(PROJECTION_DISCOUNT_DOLLAR) DOLLAR
                      ,SUM(SP.PROJECTION_UNITS) UNIT
                      ,SUM(SP.PROJECTION_SALES) SALES
                      ,S.RS_MODEL_SID
                      ,P.QUARTER 
                      ,P.YEAR
                                  ,S.PROJECTION_DETAILS_SID
              FROM NM_PPA_PROJECTION S
                        LEFT JOIN NM_SALES_PROJECTION SP ON SP.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                                
                                AND SP.PERIOD_SID = S.PERIOD_SID
                        JOIN PERIOD P ON P.PERIOD_SID = S.PERIOD_SID
                        JOIN @CCP C ON C.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                                
                        GROUP BY S.PROJECTION_DETAILS_SID
                                ,S.RS_MODEL_SID
                                ,P.QUARTER
                                ,P.YEAR
               ) A
                   GROUP BY PROJECTION_DETAILS_SID,QUARTER,YEAR) B
                   GROUP BY YEAR
               ,QUARTER
        ORDER BY YEAR
               ,QUARTER

                        
            ]]> </query>
</entity>
<entity id="PPAResults.dataForTableLoad-Annually_Product-View">
<query> <![CDATA[
                        

             DECLARE @RELATIONSHIPBUILDERSHIPSID INT =?,
                @PROJECTIONMASTERSID    INT =?,
                        @HIERARCHY_NO VARCHAR(100)= '?%',
                        @LEVEL_NO INT=?,
                        @START_DATE VARCHAR(50)='?',
                        @END_DATE VARCHAR(50)='?'

        DECLARE @CCP TABLE
          (
             PROJECTION_DETAILS_SID INT
          )

        INSERT INTO @CCP
                    (PROJECTION_DETAILS_SID)
        SELECT distinct PD.PROJECTION_DETAILS_SID AS PROJECTION_DETAILS_SID
        FROM   RELATIONSHIP_LEVEL_DEFINITION RLD
               JOIN PROJECTION_PROD_HIERARCHY PCH
                 ON PCH.PROJECTION_MASTER_SID = @PROJECTIONMASTERSID
                    AND RLD.RELATIONSHIP_LEVEL_SID = PCH.RELATIONSHIP_LEVEL_SID
                    AND RLD.RELATIONSHIP_BUILDER_SID = @RELATIONSHIPBUILDERSHIPSID
               JOIN RELATIONSHIP_LEVEL_DEFINITION RLD1
                 ON RLD1.HIERARCHY_NO LIKE @HIERARCHY_NO
                    AND RLD.RELATIONSHIP_BUILDER_SID = RLD1.RELATIONSHIP_BUILDER_SID
                    AND RLD.HIERARCHY_NO LIKE RLD1.HIERARCHY_NO + '%'
                    AND RLD1.LEVEL_NO = @LEVEL_NO
               JOIN CCP_MAP CCPMAP
                 ON CCPMAP.RELATIONSHIP_LEVEL_SID = RLD.RELATIONSHIP_LEVEL_SID
               JOIN PROJECTION_DETAILS PD
                 ON PD.CCP_DETAILS_SID = CCPMAP.CCP_DETAILS_SID
               JOIN NM_PPA_PROJECTION_MASTER A
                 ON pd.PROJECTION_DETAILS_SID = A.PROJECTION_DETAILS_SID
                AND EXISTS (
              SELECT 1
              FROM PROJECTION_DETAILS PR
              WHERE PR.PROJECTION_MASTER_SID = @PROJECTIONMASTERSID
                     AND PR.PROJECTION_DETAILS_SID = PD.PROJECTION_DETAILS_SID
              );
   

          SELECT YEAR1
               ,YEAR
               ,SUM(DOLLAR) ACTUAL_DISCOUNT_DOLLAR
               ,SUM(DOLLAR)/NULLIF(SUM(SALE),0) RATE
               ,SUM(UNIT) PROJECTION_DISCOUNT_UNITS1
               ,SUM(DOLLAR)/NULLIF(SUM(UNIT),0) DISCOUNT
               ,0 ACTUALS
                   FROM (
        SELECT YEAR1,YEAR,SUM(DOLLAR) DOLLAR,MIN(NULLIF(UNIT,0)) UNIT,MIN(NULLIF(SALES,0)) SALE,SUM(UNIT) UNITS,SUM(SALES) SALES,PROJECTION_DETAILS_SID FROM (
               SELECT SUM(ACTUAL_DISCOUNT_DOLLAR) DOLLAR
                      ,SUM(SP.ACTUAL_UNITS) UNIT
                      ,SUM(SP.ACTUAL_SALES) SALES
                      ,S.RS_MODEL_SID
                      ,P.YEAR YEAR1 
                      ,P.YEAR
                                  ,S.PROJECTION_DETAILS_SID
                FROM NM_ACTUAL_PPA S
                        LEFT JOIN NM_ACTUAL_SALES SP ON SP.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                                
                                AND SP.PERIOD_SID = S.PERIOD_SID
                        JOIN PERIOD P ON P.PERIOD_SID = S.PERIOD_SID
                        JOIN @CCP C ON C.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                               
                        GROUP BY S.PROJECTION_DETAILS_SID
                                ,S.RS_MODEL_SID
                                ,P.YEAR ) A
                                  GROUP BY PROJECTION_DETAILS_SID,YEAR
               ,YEAR1) B 
        GROUP BY YEAR
               ,YEAR1

        UNION

        SELECT YEAR1
               ,YEAR
               ,SUM(DOLLAR) PROJECTION_DISCOUNT_DOLLAR1
               ,SUM(DOLLAR)/NULLIF(SUM(SALES),0)
               ,SUM(UNIT) PROJECTION_DISCOUNT_UNITS1
               ,SUM(DOLLAR)/NULLIF(SUM(UNIT),0) 
               ,1 ACTUALS
                   FROM
                   (
        SELECT PROJECTION_DETAILS_SID,MIN(NULLIF(UNIT,0)) UNIT,MIN(NULLIF(SALES,0)) SALES,SUM(UNIT) UNITS ,SUM(DOLLAR) DOLLAR,SUM(SALES) SALE,YEAR1,YEAR FROM (
               SELECT SUM(PROJECTION_DISCOUNT_DOLLAR) DOLLAR
                      ,SUM(SP.PROJECTION_UNITS) UNIT
                      ,SUM(SP.PROJECTION_SALES) SALES
                      ,S.RS_MODEL_SID
                      ,P.YEAR YEAR1 
                      ,P.YEAR
                                  ,S.PROJECTION_DETAILS_SID
              FROM NM_PPA_PROJECTION S
                        LEFT JOIN NM_SALES_PROJECTION SP ON SP.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                                AND SP.PERIOD_SID = S.PERIOD_SID
                        JOIN PERIOD P ON P.PERIOD_SID = S.PERIOD_SID
                        JOIN @CCP C ON C.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                        GROUP BY S.PROJECTION_DETAILS_SID
                                ,S.RS_MODEL_SID
                                ,P.YEAR
               ) A
                   GROUP BY PROJECTION_DETAILS_SID,YEAR1,YEAR) B
                   GROUP BY YEAR
               ,YEAR1
        ORDER BY YEAR
               ,YEAR1

                        
            ]]> </query>
</entity>
<entity id="PPAResults.countData-Semi-Annual-Product-View">
<query> <![CDATA[
                        

            DECLARE @RELATIONSHIPBUILDERSHIPSID INT =?,
                @PROJECTIONMASTERSID    INT =?,
                        @HIERARCHY_NO VARCHAR(100)= '?%',
                        @LEVEL_NO INT=?,
                        @START_DATE VARCHAR(50)='?',
                        @END_DATE VARCHAR(50)='?'

        DECLARE @CCP TABLE
          (
             PROJECTION_DETAILS_SID INT
          )

        INSERT INTO @CCP
                    (PROJECTION_DETAILS_SID)
        SELECT distinct PD.PROJECTION_DETAILS_SID AS PROJECTION_DETAILS_SID
        FROM   RELATIONSHIP_LEVEL_DEFINITION RLD
               JOIN PROJECTION_PROD_HIERARCHY PCH
                 ON PCH.PROJECTION_MASTER_SID = @PROJECTIONMASTERSID
                    AND RLD.RELATIONSHIP_LEVEL_SID = PCH.RELATIONSHIP_LEVEL_SID
                    AND RLD.RELATIONSHIP_BUILDER_SID = @RELATIONSHIPBUILDERSHIPSID
               JOIN RELATIONSHIP_LEVEL_DEFINITION RLD1
                 ON RLD1.HIERARCHY_NO LIKE @HIERARCHY_NO
                    AND RLD.RELATIONSHIP_BUILDER_SID = RLD1.RELATIONSHIP_BUILDER_SID
                    AND RLD.HIERARCHY_NO LIKE RLD1.HIERARCHY_NO + '%'
                    AND RLD1.LEVEL_NO = @LEVEL_NO
               JOIN CCP_MAP CCPMAP
                 ON CCPMAP.RELATIONSHIP_LEVEL_SID = RLD.RELATIONSHIP_LEVEL_SID
               JOIN PROJECTION_DETAILS PD
                 ON PD.CCP_DETAILS_SID = CCPMAP.CCP_DETAILS_SID
               JOIN NM_PPA_PROJECTION_MASTER A
                 ON pd.PROJECTION_DETAILS_SID = A.PROJECTION_DETAILS_SID
              AND EXISTS (
              SELECT 1
              FROM PROJECTION_DETAILS PR
              WHERE PR.PROJECTION_MASTER_SID = @PROJECTIONMASTERSID
                     AND PR.PROJECTION_DETAILS_SID = PD.PROJECTION_DETAILS_SID
              );
     


        SELECT SEMI_ANNUAL
               ,YEAR
               ,SUM(DOLLAR) ACTUAL_DISCOUNT_DOLLAR
               ,SUM(DOLLAR)/NULLIF(SUM(SALE),0) RATE
               ,SUM(UNIT) PROJECTION_DISCOUNT_UNITS1
               ,SUM(DOLLAR)/NULLIF(SUM(UNIT),0) DISCOUNT
               ,0 ACTUALS
                   FROM (
        SELECT SEMI_ANNUAL,YEAR,SUM(DOLLAR) DOLLAR,MIN(NULLIF(UNIT,0)) UNIT,MIN(NULLIF(SALES,0)) SALE,SUM(UNIT) UNITS,SUM(SALES) SALES,PROJECTION_DETAILS_SID FROM (
               SELECT SUM(ACTUAL_DISCOUNT_DOLLAR) DOLLAR
                      ,SUM(SP.ACTUAL_UNITS) UNIT
                      ,SUM(SP.ACTUAL_SALES) SALES
                      ,S.RS_MODEL_SID
                      ,P.SEMI_ANNUAL 
                      ,P.YEAR
                                  ,S.PROJECTION_DETAILS_SID
                FROM NM_ACTUAL_PPA S
                        LEFT JOIN NM_ACTUAL_SALES SP ON SP.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                                
                                AND SP.PERIOD_SID = S.PERIOD_SID
                        JOIN PERIOD P ON P.PERIOD_SID = S.PERIOD_SID
                        JOIN @CCP C ON C.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                                
                        GROUP BY S.PROJECTION_DETAILS_SID
                                ,S.RS_MODEL_SID
                                ,P.SEMI_ANNUAL
                                ,P.YEAR ) A
                                  GROUP BY PROJECTION_DETAILS_SID,YEAR
               ,SEMI_ANNUAL) B 
        GROUP BY YEAR
               ,SEMI_ANNUAL

        UNION

        SELECT SEMI_ANNUAL
               ,YEAR
               ,SUM(DOLLAR) PROJECTION_DISCOUNT_DOLLAR1
               ,SUM(DOLLAR)/NULLIF(SUM(SALES),0)
               ,SUM(UNIT) PROJECTION_DISCOUNT_UNITS1
               ,SUM(DOLLAR)/NULLIF(SUM(UNIT),0) 
               ,1 ACTUALS
                   FROM
                   (
        SELECT PROJECTION_DETAILS_SID,MIN(NULLIF(UNIT,0)) UNIT,MIN(NULLIF(SALES,0)) SALES,SUM(UNIT) UNITS ,SUM(DOLLAR) DOLLAR,SUM(SALES) SALE,SEMI_ANNUAL,YEAR FROM (
               SELECT SUM(PROJECTION_DISCOUNT_DOLLAR) DOLLAR
                      ,SUM(SP.PROJECTION_UNITS) UNIT
                      ,SUM(SP.PROJECTION_SALES) SALES
                      ,S.RS_MODEL_SID
                      ,P.SEMI_ANNUAL 
                      ,P.YEAR
                                  ,S.PROJECTION_DETAILS_SID
              FROM NM_PPA_PROJECTION S
                        LEFT JOIN NM_SALES_PROJECTION SP ON SP.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                                
                                AND SP.PERIOD_SID = S.PERIOD_SID
                        JOIN PERIOD P ON P.PERIOD_SID = S.PERIOD_SID
                        JOIN @CCP C ON C.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                                
                        GROUP BY S.PROJECTION_DETAILS_SID
                                ,S.RS_MODEL_SID
                                ,P.SEMI_ANNUAL
                                ,P.YEAR
               ) A
                   GROUP BY PROJECTION_DETAILS_SID,SEMI_ANNUAL,YEAR) B
                   GROUP BY YEAR
               ,SEMI_ANNUAL
        ORDER BY YEAR
               ,SEMI_ANNUAL
                        
            ]]> </query>
</entity>
<entity id="PPAResults.dataForTableLoad-Annually-Total-View">
<query> <![CDATA[
                        
                 SELECT      YEAR1
               ,YEAR,SUM(DOLLAR) DOLLAR
               ,SUM(DOLLAR)/NULLIF(SUM(SALE),0) RATE
               ,SUM(PROJECTION_DISCOUNT_UNITS1) UNIT
               ,SUM(DOLLAR)/NULLIF(SUM(PROJECTION_DISCOUNT_UNITS1),0) RPU
                   ,0 ACTUALS
        FROM (
               SELECT PROJECTION_DETAILS_SID
                      ,YEAR1
                      ,YEAR
                      ,SUM(DOLLAR) DOLLAR
                      ,MIN(NULLIF(UNIT, 0)) PROJECTION_DISCOUNT_UNITS1
                                  ,SUM(SALES) SALES
                                  ,SUM(UNIT) UNITS
                                  ,MIN(NULLIF(SALES, 0)) SALE
               FROM (
                      SELECT S.PROJECTION_DETAILS_SID
                             ,SUM(ACTUAL_DISCOUNT_DOLLAR) DOLLAR
                             ,SUM(SP.ACTUAL_UNITS) UNIT
                             ,SUM(SP.ACTUAL_SALES) SALES 
                             ,S.RS_MODEL_SID
                             ,P.YEAR YEAR1
                             ,P.YEAR
                      FROM  NM_ACTUAL_PPA S
                      JOIN PROJECTION_DETAILS PD ON PD.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                      LEFT JOIN  NM_ACTUAL_SALES SP ON SP.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                             AND SP.PERIOD_SID = S.PERIOD_SID
                      JOIN PERIOD P ON P.PERIOD_SID = S.PERIOD_SID
                      JOIN  NM_PPA_PROJECTION_MASTER C ON C.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                             AND C.RS_MODEL_SID = S.RS_MODEL_SID
                      WHERE PD.PROJECTION_MASTER_SID = ?
                             AND ISNULL(C.USER_GROUP, '0') LIKE '?'
                             AND PERIOD_DATE BETWEEN CONVERT(DATE, '?')
                                   AND CONVERT(DATE, '?')
                      GROUP BY S.PROJECTION_DETAILS_SID
                             ,S.RS_MODEL_SID
                             ,P.YEAR
                      ) G
               GROUP BY PROJECTION_DETAILS_SID
                      ,YEAR1
                      ,YEAR
               ) Y
        GROUP BY YEAR1
               ,YEAR

        UNION

        SELECT YEAR1
               ,YEAR,SUM(DOLLAR)
               ,SUM(DOLLAR)/NULLIF(SUM(SALES),0) RATE
                          ,SUM(UNITS)
                   ,SUM(DOLLAR)/NULLIF(SUM(UNITS),0) RPU
                   ,1
        FROM (
               SELECT PROJECTION_DETAILS_SID
                      ,SUM(DOLLAR) DOLLAR
                      ,MIN(NULLIF(UNI,0)) UNITS
                                  ,SUM(UNIT) UNIT
                                  ,SUM(SALES) SALE
                      ,YEAR1
                      ,YEAR
                                  ,MIN(NULLIF(SALES, 0)) SALES
               FROM (
                      SELECT S.PROJECTION_DETAILS_SID
                             ,SUM(SP.PROJECTION_SALES) SALES
                             ,SUM(SP.PROJECTION_UNITS) UNI
                             ,SUM(PROJECTION_DISCOUNT_DOLLAR) DOLLAR
                             ,SUM(SP.PROJECTION_UNITS) UNIT 
                             ,S.RS_MODEL_SID
                             ,P.YEAR YEAR1
                             ,P.YEAR
                      FROM  NM_PPA_PROJECTION S
                      JOIN PROJECTION_DETAILS PD ON PD.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                      LEFT JOIN  NM_SALES_PROJECTION SP ON SP.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                             AND SP.PERIOD_SID = S.PERIOD_SID
                      JOIN PERIOD P ON P.PERIOD_SID = S.PERIOD_SID
                      JOIN  NM_PPA_PROJECTION_MASTER C ON C.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                             AND C.RS_MODEL_SID = S.RS_MODEL_SID
                      WHERE PD.PROJECTION_MASTER_SID = ?
                             AND ISNULL(C.USER_GROUP, '0') LIKE '?'
                             AND PERIOD_DATE BETWEEN CONVERT(DATE, '?')
                                   AND CONVERT(DATE, '?')
                      GROUP BY S.PROJECTION_DETAILS_SID
                             ,S.RS_MODEL_SID
                             ,P.YEAR
                      ) G
               GROUP BY PROJECTION_DETAILS_SID
                      ,YEAR1
                      ,YEAR
               ) Y
        GROUP BY YEAR1
               ,YEAR
                   ORDER BY YEAR,YEAR1
                        
            ]]> </query>
</entity>
<entity id="PPAResults.Monthly-Total-View">
<query> <![CDATA[
                        
                   SELECT      MONTH
               ,YEAR,SUM(DOLLAR) DOLLAR
               ,SUM(DOLLAR)/NULLIF(SUM(SALE),0) RATE
               ,SUM(PROJECTION_DISCOUNT_UNITS1) UNIT
               ,SUM(DOLLAR)/NULLIF(SUM(PROJECTION_DISCOUNT_UNITS1),0) RPU
                   ,0 ACTUALS
        FROM (
               SELECT PROJECTION_DETAILS_SID
                      ,MONTH
                      ,YEAR
                      ,SUM(DOLLAR) DOLLAR
                      ,MIN(NULLIF(UNIT, 0)) PROJECTION_DISCOUNT_UNITS1
                                  ,SUM(SALES) SALES
                                  ,SUM(UNIT) UNITS
                                  ,MIN(NULLIF(SALES, 0)) SALE
               FROM (
                      SELECT S.PROJECTION_DETAILS_SID
                             ,SUM(ACTUAL_DISCOUNT_DOLLAR) DOLLAR
                             ,SUM(SP.ACTUAL_UNITS) UNIT
                             ,SUM(SP.ACTUAL_SALES) SALES 
                             ,S.RS_MODEL_SID
                             ,P.MONTH
                             ,P.YEAR
                      FROM  NM_ACTUAL_PPA S
                      JOIN PROJECTION_DETAILS PD ON PD.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                      LEFT JOIN  NM_ACTUAL_SALES SP ON SP.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                             AND SP.PERIOD_SID = S.PERIOD_SID
                      JOIN PERIOD P ON P.PERIOD_SID = S.PERIOD_SID
                      JOIN  NM_PPA_PROJECTION_MASTER C ON C.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                             
                             AND C.RS_MODEL_SID = S.RS_MODEL_SID
                      WHERE PD.PROJECTION_MASTER_SID = ?
                             
                             AND ISNULL(C.USER_GROUP, '0') LIKE '?'
                             AND PERIOD_DATE BETWEEN CONVERT(DATE, '?')
                                   AND CONVERT(DATE, '?')
                      GROUP BY S.PROJECTION_DETAILS_SID
                             ,S.RS_MODEL_SID
                             ,P.MONTH
                             ,P.YEAR
                      ) G
               GROUP BY PROJECTION_DETAILS_SID
                      ,MONTH
                      ,YEAR
               ) Y
        GROUP BY MONTH
               ,YEAR

        UNION

        SELECT MONTH
               ,YEAR,SUM(DOLLAR)
               ,SUM(DOLLAR)/NULLIF(SUM(SALES),0) RATE
                          ,SUM(UNITS)
                   ,SUM(DOLLAR)/NULLIF(SUM(UNITS),0) RPU
                   ,1
        FROM (
               SELECT PROJECTION_DETAILS_SID
                      ,SUM(DOLLAR) DOLLAR
                      ,MIN(NULLIF(UNI,0)) UNITS
                                  ,SUM(UNIT) UNIT
                                  ,SUM(SALES) SALE
                      ,MONTH
                      ,YEAR
                                  ,MIN(NULLIF(SALES, 0)) SALES
               FROM (
                      SELECT S.PROJECTION_DETAILS_SID
                             ,SUM(SP.PROJECTION_SALES) SALES
                             ,SUM(SP.PROJECTION_UNITS) UNI
                             ,SUM(PROJECTION_DISCOUNT_DOLLAR) DOLLAR
                             ,SUM(SP.PROJECTION_UNITS) UNIT 
                             ,S.RS_MODEL_SID
                             ,P.MONTH
                             ,P.YEAR
                      FROM  NM_PPA_PROJECTION S
                      JOIN PROJECTION_DETAILS PD ON PD.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                      LEFT JOIN  NM_SALES_PROJECTION SP ON SP.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                              AND C.RS_MODEL_SID = S.RS_MODEL_SID
                             
                      JOIN PERIOD P ON P.PERIOD_SID = S.PERIOD_SID
                      JOIN  NM_PPA_PROJECTION_MASTER C ON C.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                             
                             AND C.RS_MODEL_SID = S.RS_MODEL_SID
                      WHERE PD.PROJECTION_MASTER_SID = ?
                             
                             AND ISNULL(C.USER_GROUP, '0') LIKE '?'
                             AND PERIOD_DATE BETWEEN CONVERT(DATE, '?')
                                   AND CONVERT(DATE, '?')
                      GROUP BY S.PROJECTION_DETAILS_SID
                             ,S.RS_MODEL_SID
                             ,P.MONTH
                             ,P.YEAR
                      ) G
               GROUP BY PROJECTION_DETAILS_SID
                      ,MONTH
                      ,YEAR
               ) Y
        GROUP BY MONTH
               ,YEAR
                   ORDER BY YEAR,MONTH
                        
            ]]> </query>
</entity>
<entity id="PPAResults.dataForTableLoad-Quaterly-Total-View">
<query> <![CDATA[
		
              SELECT      QUARTER
       ,YEAR,SUM(DOLLAR) DOLLAR
       ,SUM(DOLLAR)/NULLIF(SUM(SALE),0) RATE
       ,SUM(PROJECTION_DISCOUNT_UNITS1) UNIT
       ,SUM(DOLLAR)/NULLIF(SUM(PROJECTION_DISCOUNT_UNITS1),0) RPU
	   ,0 ACTUALS
FROM (
       SELECT PROJECTION_DETAILS_SID
              ,QUARTER
              ,YEAR
              ,SUM(DOLLAR) DOLLAR
              ,MIN(NULLIF(UNIT, 0)) PROJECTION_DISCOUNT_UNITS1
			  ,SUM(SALES) SALES
			  ,SUM(UNIT) UNITS
			  ,MIN(NULLIF(SALES, 0)) SALE
       FROM (
              SELECT S.PROJECTION_DETAILS_SID
                     ,SUM(ACTUAL_DISCOUNT_DOLLAR) DOLLAR
                     ,SUM(SP.ACTUAL_UNITS) UNIT
                     ,SUM(SP.ACTUAL_SALES) SALES 
                     ,S.RS_MODEL_SID
                     ,P.QUARTER
                     ,P.YEAR
              FROM  NM_ACTUAL_PPA S
              JOIN PROJECTION_DETAILS PD ON PD.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
              LEFT JOIN  NM_ACTUAL_SALES SP ON SP.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                     AND SP.PERIOD_SID = S.PERIOD_SID
              JOIN PERIOD P ON P.PERIOD_SID = S.PERIOD_SID
              JOIN  NM_PPA_PROJECTION_MASTER C ON C.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                     AND C.RS_MODEL_SID = S.RS_MODEL_SID
              WHERE PD.PROJECTION_MASTER_SID = ?
                     AND ISNULL(C.USER_GROUP, '0') LIKE '?'
                     AND PERIOD_DATE BETWEEN CONVERT(DATE, '?')
                           AND CONVERT(DATE, '?')
              GROUP BY S.PROJECTION_DETAILS_SID
                     ,S.RS_MODEL_SID
                     ,P.QUARTER
                     ,P.YEAR
              ) G
       GROUP BY PROJECTION_DETAILS_SID
              ,QUARTER
              ,YEAR
       ) Y
GROUP BY QUARTER
       ,YEAR

UNION

SELECT QUARTER
       ,YEAR,SUM(DOLLAR)
       ,SUM(DOLLAR)/NULLIF(SUM(SALES),0) RATE
	          ,SUM(UNITS)
	   ,SUM(DOLLAR)/NULLIF(SUM(UNITS),0) RPU
	   ,1
FROM (
       SELECT PROJECTION_DETAILS_SID
              ,SUM(DOLLAR) DOLLAR
              ,MIN(NULLIF(UNI,0)) UNITS
			  ,SUM(UNIT) UNIT
			  ,SUM(SALES) SALE
              ,QUARTER
              ,YEAR
			  ,MIN(NULLIF(SALES, 0)) SALES
       FROM (
              SELECT S.PROJECTION_DETAILS_SID
                     ,SUM(SP.PROJECTION_SALES) SALES
                     ,SUM(SP.PROJECTION_UNITS) UNI
                     ,SUM(PROJECTION_DISCOUNT_DOLLAR) DOLLAR
                     ,SUM(SP.PROJECTION_UNITS) UNIT 
                     ,S.RS_MODEL_SID
                     ,P.QUARTER
                     ,P.YEAR
              FROM  NM_PPA_PROJECTION S
              JOIN PROJECTION_DETAILS PD ON PD.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
              LEFT JOIN  NM_SALES_PROJECTION SP ON SP.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                     AND SP.PERIOD_SID = S.PERIOD_SID
              JOIN PERIOD P ON P.PERIOD_SID = S.PERIOD_SID
              JOIN  NM_PPA_PROJECTION_MASTER C ON C.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                     AND C.RS_MODEL_SID = S.RS_MODEL_SID
              WHERE PD.PROJECTION_MASTER_SID = ?
                     AND ISNULL(C.USER_GROUP, '0') LIKE '?'
                     AND PERIOD_DATE BETWEEN CONVERT(DATE, '?')
                           AND CONVERT(DATE, '?')
              GROUP BY S.PROJECTION_DETAILS_SID
                     ,S.RS_MODEL_SID
                     ,P.QUARTER
                     ,P.YEAR
              ) G
       GROUP BY PROJECTION_DETAILS_SID
              ,QUARTER
              ,YEAR
       ) Y
GROUP BY QUARTER
       ,YEAR
	   ORDER BY YEAR,QUARTER
		
    ]]> </query>
</entity>
<entity id="PPAResults.Semi-Annual-Total-View">
<query> <![CDATA[
                            
                     SELECT      SEMI_ANNUAL
                   ,YEAR,SUM(DOLLAR) DOLLAR
                   ,SUM(DOLLAR)/NULLIF(SUM(SALE),0) RATE
                   ,SUM(PROJECTION_DISCOUNT_UNITS1) UNIT
                   ,SUM(DOLLAR)/NULLIF(SUM(PROJECTION_DISCOUNT_UNITS1),0) RPU
                       ,0 ACTUALS
            FROM (
                   SELECT PROJECTION_DETAILS_SID
                          ,SEMI_ANNUAL
                          ,YEAR
                          ,SUM(DOLLAR) DOLLAR
                          ,MIN(NULLIF(UNIT, 0)) PROJECTION_DISCOUNT_UNITS1
                                      ,SUM(SALES) SALES
                                      ,SUM(UNIT) UNITS
                                      ,MIN(NULLIF(SALES, 0)) SALE
                   FROM (
                          SELECT S.PROJECTION_DETAILS_SID
                                 ,SUM(ACTUAL_DISCOUNT_DOLLAR) DOLLAR
                                 ,SUM(SP.ACTUAL_UNITS) UNIT
                                 ,SUM(SP.ACTUAL_SALES) SALES 
                                 ,S.RS_MODEL_SID
                                 ,P.SEMI_ANNUAL
                                 ,P.YEAR
                          FROM NM_ACTUAL_PPA S
                          JOIN PROJECTION_DETAILS PD ON PD.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                          LEFT JOIN NM_ACTUAL_SALES SP ON SP.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                                 AND SP.PERIOD_SID = S.PERIOD_SID
                          JOIN PERIOD P ON P.PERIOD_SID = S.PERIOD_SID
                          JOIN NM_PPA_PROJECTION_MASTER C ON C.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                                 AND C.RS_MODEL_SID = S.RS_MODEL_SID
                          WHERE PD.PROJECTION_MASTER_SID = ?
                                 AND ISNULL(C.USER_GROUP, '0') LIKE '?'
                                 AND PERIOD_DATE BETWEEN CONVERT(DATE, '?')
                                       AND CONVERT(DATE, '?')
                          GROUP BY S.PROJECTION_DETAILS_SID
                                 ,S.RS_MODEL_SID
                                 ,P.SEMI_ANNUAL
                                 ,P.YEAR
                          ) G
                   GROUP BY PROJECTION_DETAILS_SID
                          ,SEMI_ANNUAL
                          ,YEAR
                   ) Y
            GROUP BY SEMI_ANNUAL
                   ,YEAR

            UNION

            SELECT SEMI_ANNUAL
                   ,YEAR,SUM(DOLLAR)
                   ,SUM(DOLLAR)/NULLIF(SUM(SALES),0) RATE
                              ,SUM(UNITS)
                       ,SUM(DOLLAR)/NULLIF(SUM(UNITS),0) RPU
                       ,1
            FROM (
                   SELECT PROJECTION_DETAILS_SID
                          ,SUM(DOLLAR) DOLLAR
                          ,MIN(NULLIF(UNI,0)) UNITS
                                      ,SUM(UNIT) UNIT
                                      ,SUM(SALES) SALE
                          ,SEMI_ANNUAL
                          ,YEAR
                                      ,MIN(NULLIF(SALES, 0)) SALES
                   FROM (
                          SELECT S.PROJECTION_DETAILS_SID
                                 ,SUM(SP.PROJECTION_SALES) SALES
                                 ,SUM(SP.PROJECTION_UNITS) UNI
                                 ,SUM(PROJECTION_DISCOUNT_DOLLAR) DOLLAR
                                 ,SUM(SP.PROJECTION_UNITS) UNIT 
                                 ,S.RS_MODEL_SID
                                 ,P.SEMI_ANNUAL
                                 ,P.YEAR
                          FROM NM_PPA_PROJECTION S
                          JOIN PROJECTION_DETAILS PD ON PD.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                          LEFT JOIN NM_SALES_PROJECTION SP ON SP.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                                 AND SP.PERIOD_SID = S.PERIOD_SID
                          JOIN PERIOD P ON P.PERIOD_SID = S.PERIOD_SID
                          JOIN NM_PPA_PROJECTION_MASTER C ON C.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                                 AND C.RS_MODEL_SID = S.RS_MODEL_SID
                          WHERE PD.PROJECTION_MASTER_SID = ?
                                 AND ISNULL(C.USER_GROUP, '0') LIKE '?'
                                 AND PERIOD_DATE BETWEEN CONVERT(DATE, '?')
                                       AND CONVERT(DATE, '?')
                          GROUP BY S.PROJECTION_DETAILS_SID
                                 ,S.RS_MODEL_SID
                                 ,P.SEMI_ANNUAL
                                 ,P.YEAR
                          ) G
                   GROUP BY PROJECTION_DETAILS_SID
                          ,SEMI_ANNUAL
                          ,YEAR
                   ) Y
            GROUP BY SEMI_ANNUAL
                   ,YEAR
                       ORDER BY YEAR,SEMI_ANNUAL
                            
                ]]> </query>
</entity>
<entity id="PPAResults.dataForTableLoad-Custom-Quaterly-View">
<query> <![CDATA[
		
     SELECT QUARTER
       ,YEAR
       ,SUM(DOLLAR) ACTUAL_DISCOUNT_DOLLAR
       ,SUM(DOLLAR)/NULLIF(SUM(SALE),0) RATE
       ,SUM(UNIT) PROJECTION_DISCOUNT_UNITS1
       ,SUM(DOLLAR)/NULLIF(SUM(UNIT),0) DISCOUNT
       ,0 ACTUALS FROM (
SELECT PROJECTION_DETAILS_SID,QUARTER,YEAR, SUM(DOLLAR) DOLLAR, SUM(UNIT) UNITS, MIN(UNIT) UNIT,SUM(SALES) SALES,MIN(NULLIF(SALES,0)) SALE FROM (
       SELECT SUM(ACTUAL_DISCOUNT_DOLLAR) DOLLAR
              ,SUM(SP.ACTUAL_UNITS) UNIT
              ,SUM(SP.ACTUAL_SALES) SALES
              ,S.RS_MODEL_SID
              ,P.QUARTER
              ,P.YEAR
			 , S.PROJECTION_DETAILS_SID
       FROM NM_ACTUAL_PPA S
          LEFT JOIN NM_ACTUAL_SALES SP ON SP.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
              AND SP.PERIOD_SID = S.PERIOD_SID
       JOIN PERIOD P ON P.PERIOD_SID = S.PERIOD_SID
          JOIN PROJECTION_DETAILS PD ON PD.PROJECTION_DETAILS_SID=S.PROJECTION_DETAILS_SID
       JOIN @CCP C ON C.CCP_DETAILS_SID= PD.CCP_DETAILS_SID
                     WHERE PD.PROJECTION_MASTER_SID = ?
              AND PERIOD_DATE BETWEEN CONVERT(DATE, '?')
                     AND CONVERT(DATE, '?')


       GROUP BY  S.PROJECTION_DETAILS_SID,S.RS_MODEL_SID
              ,P.QUARTER
              ,P.YEAR
       ) A
	   GROUP BY  PROJECTION_DETAILS_SID,YEAR
       ,QUARTER
	   )B
GROUP BY  YEAR
       ,QUARTER

UNION

SELECT QUARTER
       ,YEAR
       ,SUM(DOLLAR) PROJECTION_DISCOUNT_DOLLAR1
       ,SUM(DOLLAR)/NULLIF(SUM(SALE),0) RATE
       ,SUM(UNIT) PROJECTION_DISCOUNT_UNITS1
       ,SUM(DOLLAR)/NULLIF(SUM(UNIT),0) DISCOUNT
       ,1 ACTUALS
FROM (
SELECT PROJECTION_DETAILS_SID,QUARTER,YEAR, SUM(DOLLAR) DOLLAR, SUM(UNIT) UNITS, MIN(NULLIF(UNIT,0)) UNIT,SUM(SALES) SALES,MIN(NULLIF(SALES,0)) SALE FROM (
       SELECT SUM(PROJECTION_DISCOUNT_DOLLAR) DOLLAR
              ,SUM(SP.PROJECTION_UNITS) UNIT
              ,SUM(SP.PROJECTION_SALES) SALES
              ,S.RS_MODEL_SID
              ,P.QUARTER
              ,P.YEAR
			  ,S.PROJECTION_DETAILS_SID
       FROM NM_PPA_PROJECTION S
          JOIN PERIOD P ON P.PERIOD_SID=S.PERIOD_SID
       LEFT JOIN NM_SALES_PROJECTION SP ON SP.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
              AND SP.PERIOD_SID = S.PERIOD_SID
       JOIN PROJECTION_DETAILS PD ON PD.PROJECTION_DETAILS_SID=S.PROJECTION_DETAILS_SID
       JOIN @CCP C ON C.CCP_DETAILS_SID= PD.CCP_DETAILS_SID
      WHERE PD.PROJECTION_MASTER_SID = ?
              AND PERIOD_DATE BETWEEN CONVERT(DATE, '?')
                     AND CONVERT(DATE, '?')
       GROUP BY S.PROJECTION_DETAILS_SID,S.RS_MODEL_SID
              ,P.QUARTER
              ,P.YEAR
       ) A
  GROUP BY  PROJECTION_DETAILS_SID,YEAR
       ,QUARTER
	   )B
GROUP BY  YEAR
       ,QUARTER

ORDER BY YEAR
       ,QUARTER
		
    ]]> </query>
</entity>
<entity id="PPAResults.dataForTableLoad-Custom-Monthly-View">
<query> <![CDATA[
                        
          SELECT MONTH
               ,YEAR
               ,SUM(DOLLAR) ACTUAL_DISCOUNT_DOLLAR
               ,SUM(DOLLAR)/NULLIF(SUM(SALE),0) RATE
               ,SUM(UNIT) PROJECTION_DISCOUNT_UNITS1
               ,SUM(DOLLAR)/NULLIF(SUM(UNIT),0) DISCOUNT
               ,0 ACTUALS FROM (
        SELECT PROJECTION_DETAILS_SID,MONTH,YEAR, SUM(DOLLAR) DOLLAR, SUM(UNIT) UNITS, MIN(UNIT) UNIT,SUM(SALES) SALES,MIN(NULLIF(SALES,0)) SALE FROM (
               SELECT SUM(ACTUAL_DISCOUNT_DOLLAR) DOLLAR
                      ,SUM(SP.ACTUAL_UNITS) UNIT
                      ,SUM(SP.ACTUAL_SALES) SALES
                      ,S.RS_MODEL_SID
                      ,P.MONTH
                      ,P.YEAR
                                 , S.PROJECTION_DETAILS_SID
               FROM   NM_ACTUAL_PPA S
                  LEFT JOIN   NM_ACTUAL_SALES SP ON SP.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                      AND SP.PERIOD_SID = S.PERIOD_SID
               JOIN PERIOD P ON P.PERIOD_SID = S.PERIOD_SID
                  JOIN PROJECTION_DETAILS PD ON PD.PROJECTION_DETAILS_SID=S.PROJECTION_DETAILS_SID
               JOIN @CCP C ON C.CCP_DETAILS_SID= PD.CCP_DETAILS_SID
                             WHERE PD.PROJECTION_MASTER_SID = ?
                      AND PERIOD_DATE BETWEEN CONVERT(DATE, '?')
                             AND CONVERT(DATE, '?')


               GROUP BY  S.PROJECTION_DETAILS_SID,S.RS_MODEL_SID
                      ,P.MONTH
                      ,P.YEAR
               ) A
                   GROUP BY  PROJECTION_DETAILS_SID,YEAR
               ,MONTH
                   )B
        GROUP BY  YEAR
               ,MONTH

        UNION

        SELECT MONTH
               ,YEAR
               ,SUM(DOLLAR) PROJECTION_DISCOUNT_DOLLAR1
               ,SUM(DOLLAR)/NULLIF(SUM(SALE),0) RATE
               ,SUM(UNIT) PROJECTION_DISCOUNT_UNITS1
               ,SUM(DOLLAR)/NULLIF(SUM(UNIT),0) DISCOUNT
               ,1 ACTUALS
        FROM (
        SELECT PROJECTION_DETAILS_SID,MONTH,YEAR, SUM(DOLLAR) DOLLAR, SUM(UNIT) UNITS, MIN(NULLIF(UNIT,0)) UNIT,SUM(SALES) SALES,MIN(NULLIF(SALES,0)) SALE FROM (
               SELECT SUM(PROJECTION_DISCOUNT_DOLLAR) DOLLAR
                      ,SUM(SP.PROJECTION_UNITS) UNIT
                      ,SUM(SP.PROJECTION_SALES) SALES
                      ,S.RS_MODEL_SID
                      ,P.MONTH
                      ,P.YEAR
                                  ,S.PROJECTION_DETAILS_SID
               FROM   NM_PPA_PROJECTION S
                  JOIN PERIOD P ON P.PERIOD_SID=S.PERIOD_SID
               LEFT JOIN   NM_SALES_PROJECTION SP ON SP.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                      AND SP.PERIOD_SID = S.PERIOD_SID
               JOIN PROJECTION_DETAILS PD ON PD.PROJECTION_DETAILS_SID=S.PROJECTION_DETAILS_SID
               JOIN @CCP C ON C.CCP_DETAILS_SID= PD.CCP_DETAILS_SID
              WHERE PD.PROJECTION_MASTER_SID = ?
                      AND PERIOD_DATE BETWEEN CONVERT(DATE, '?')
                             AND CONVERT(DATE, '?')
               GROUP BY S.PROJECTION_DETAILS_SID,S.RS_MODEL_SID
                      ,P.MONTH
                      ,P.YEAR
               ) A
          GROUP BY  PROJECTION_DETAILS_SID,YEAR
               ,MONTH
                   )B
        GROUP BY  YEAR
               ,MONTH

        ORDER BY YEAR
               ,MONTH;
                        
            ]]> </query>
</entity>
<entity id="PPAResults.dataForTableLoad-Custom-semiannually-View">
<query> <![CDATA[
		
     SELECT SEMI_ANNUAL
       ,YEAR
       ,SUM(DOLLAR) ACTUAL_DISCOUNT_DOLLAR
       ,SUM(DOLLAR)/NULLIF(SUM(SALE),0) RATE
       ,SUM(UNIT) PROJECTION_DISCOUNT_UNITS1
       ,SUM(DOLLAR)/NULLIF(SUM(UNIT),0) DISCOUNT
       ,0 ACTUALS FROM (
SELECT PROJECTION_DETAILS_SID,SEMI_ANNUAL,YEAR, SUM(DOLLAR) DOLLAR, SUM(UNIT) UNITS, MIN(UNIT) UNIT,SUM(SALES) SALES,MIN(NULLIF(SALES,0)) SALE FROM (
       SELECT SUM(ACTUAL_DISCOUNT_DOLLAR) DOLLAR
              ,SUM(SP.ACTUAL_UNITS) UNIT
              ,SUM(SP.ACTUAL_SALES) SALES
              ,S.RS_MODEL_SID
              ,P.SEMI_ANNUAL
              ,P.YEAR
			 , S.PROJECTION_DETAILS_SID
       FROM NM_ACTUAL_PPA S
          LEFT JOIN NM_ACTUAL_SALES SP ON SP.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
           
              AND SP.PERIOD_SID = S.PERIOD_SID
       JOIN PERIOD P ON P.PERIOD_SID = S.PERIOD_SID
          JOIN PROJECTION_DETAILS PD ON PD.PROJECTION_DETAILS_SID=S.PROJECTION_DETAILS_SID
       JOIN @CCP C ON C.CCP_DETAILS_SID= PD.CCP_DETAILS_SID
                     WHERE PD.PROJECTION_MASTER_SID = ?
              
              AND PERIOD_DATE BETWEEN CONVERT(DATE, '?')
                     AND CONVERT(DATE, '?')


       GROUP BY  S.PROJECTION_DETAILS_SID,S.RS_MODEL_SID
              ,P.SEMI_ANNUAL
              ,P.YEAR
       ) A
	   GROUP BY  PROJECTION_DETAILS_SID,YEAR
       ,SEMI_ANNUAL
	   )B
GROUP BY  YEAR
       ,SEMI_ANNUAL

UNION

SELECT SEMI_ANNUAL
       ,YEAR
       ,SUM(DOLLAR) PROJECTION_DISCOUNT_DOLLAR1
       ,SUM(DOLLAR)/NULLIF(SUM(SALE),0) RATE
       ,SUM(UNIT) PROJECTION_DISCOUNT_UNITS1
       ,SUM(DOLLAR)/NULLIF(SUM(UNIT),0) DISCOUNT
       ,1 ACTUALS
FROM (
SELECT PROJECTION_DETAILS_SID,SEMI_ANNUAL,YEAR, SUM(DOLLAR) DOLLAR, SUM(UNIT) UNITS, MIN(NULLIF(UNIT,0)) UNIT,SUM(SALES) SALES,MIN(NULLIF(SALES,0)) SALE FROM (
       SELECT SUM(PROJECTION_DISCOUNT_DOLLAR) DOLLAR
              ,SUM(SP.PROJECTION_UNITS) UNIT
              ,SUM(SP.PROJECTION_SALES) SALES
              ,S.RS_MODEL_SID
              ,P.SEMI_ANNUAL
              ,P.YEAR
			  ,S.PROJECTION_DETAILS_SID
       FROM NM_PPA_PROJECTION S
          JOIN PERIOD P ON P.PERIOD_SID=S.PERIOD_SID
       LEFT JOIN NM_SALES_PROJECTION SP ON SP.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
             
              AND SP.PERIOD_SID = S.PERIOD_SID
       JOIN PROJECTION_DETAILS PD ON PD.PROJECTION_DETAILS_SID=S.PROJECTION_DETAILS_SID
       JOIN @CCP C ON C.CCP_DETAILS_SID= PD.CCP_DETAILS_SID
      WHERE PD.PROJECTION_MASTER_SID = ?
              
              AND PERIOD_DATE BETWEEN CONVERT(DATE, '?')
                     AND CONVERT(DATE, '?')
       GROUP BY S.PROJECTION_DETAILS_SID,S.RS_MODEL_SID
              ,P.SEMI_ANNUAL
              ,P.YEAR
       ) A
  GROUP BY  PROJECTION_DETAILS_SID,YEAR
       ,SEMI_ANNUAL
	   )B
GROUP BY  YEAR
       ,SEMI_ANNUAL

ORDER BY YEAR
       ,SEMI_ANNUAL;

		
    ]]> </query>
</entity>
<entity id="PPAResults.dataForTableLoad-Custom-annually-View">
<query> <![CDATA[
                            
                    SELECT YEAR1
                   ,YEAR
                   ,SUM(DOLLAR) ACTUAL_DISCOUNT_DOLLAR
                   ,SUM(DOLLAR)/NULLIF(SUM(SALE),0) RATE
                   ,SUM(UNIT) PROJECTION_DISCOUNT_UNITS1
                   ,SUM(DOLLAR)/NULLIF(SUM(UNIT),0) DISCOUNT
                   ,0 ACTUALS FROM (
            SELECT PROJECTION_DETAILS_SID,YEAR1,YEAR, SUM(DOLLAR) DOLLAR, SUM(UNIT) UNITS, MIN(UNIT) UNIT,SUM(SALES) SALES,MIN(NULLIF(SALES,0)) SALE FROM (
                   SELECT SUM(ACTUAL_DISCOUNT_DOLLAR) DOLLAR
                          ,SUM(SP.ACTUAL_UNITS) UNIT
                          ,SUM(SP.ACTUAL_SALES) SALES
                          ,S.RS_MODEL_SID
                          ,P.YEAR YEAR1
                          ,P.YEAR
                                     , S.PROJECTION_DETAILS_SID
                   FROM  NM_ACTUAL_PPA S
                      LEFT JOIN  NM_ACTUAL_SALES SP ON SP.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                          AND SP.PERIOD_SID = S.PERIOD_SID
                   JOIN PERIOD P ON P.PERIOD_SID = S.PERIOD_SID
                      JOIN PROJECTION_DETAILS PD ON PD.PROJECTION_DETAILS_SID=S.PROJECTION_DETAILS_SID
                   JOIN @CCP C ON C.CCP_DETAILS_SID= PD.CCP_DETAILS_SID
                                 WHERE PD.PROJECTION_MASTER_SID = ?
                          AND PERIOD_DATE BETWEEN CONVERT(DATE, '?')
                                 AND CONVERT(DATE, '?')


                   GROUP BY  S.PROJECTION_DETAILS_SID,S.RS_MODEL_SID
                          ,P.YEAR
                   ) A
                       GROUP BY  PROJECTION_DETAILS_SID,YEAR
                   ,YEAR1
                       )B
            GROUP BY  YEAR
                   ,YEAR1

            UNION

            SELECT YEAR1
                   ,YEAR
                   ,SUM(DOLLAR) PROJECTION_DISCOUNT_DOLLAR1
                   ,SUM(DOLLAR)/NULLIF(SUM(SALE),0) RATE
                   ,SUM(UNIT) PROJECTION_DISCOUNT_UNITS1
                   ,SUM(DOLLAR)/NULLIF(SUM(UNIT),0) DISCOUNT
                   ,1 ACTUALS
            FROM (
            SELECT PROJECTION_DETAILS_SID,YEAR1,YEAR, SUM(DOLLAR) DOLLAR, SUM(UNIT) UNITS, MIN(NULLIF(UNIT,0)) UNIT,SUM(SALES) SALES,MIN(NULLIF(SALES,0)) SALE FROM (
                   SELECT SUM(PROJECTION_DISCOUNT_DOLLAR) DOLLAR
                          ,SUM(SP.PROJECTION_UNITS) UNIT
                          ,SUM(SP.PROJECTION_SALES) SALES
                          ,S.RS_MODEL_SID
                          ,P.YEAR YEAR1
                          ,P.YEAR
                                      ,S.PROJECTION_DETAILS_SID
                   FROM  NM_PPA_PROJECTION S
                      JOIN PERIOD P ON P.PERIOD_SID=S.PERIOD_SID
                   LEFT JOIN  NM_SALES_PROJECTION SP ON SP.PROJECTION_DETAILS_SID = S.PROJECTION_DETAILS_SID
                          AND SP.PERIOD_SID = S.PERIOD_SID
                   JOIN PROJECTION_DETAILS PD ON PD.PROJECTION_DETAILS_SID=S.PROJECTION_DETAILS_SID
                   JOIN @CCP C ON C.CCP_DETAILS_SID= PD.CCP_DETAILS_SID
                  WHERE PD.PROJECTION_MASTER_SID = ?
                          AND PERIOD_DATE BETWEEN CONVERT(DATE, '?')
                                 AND CONVERT(DATE, '?')
                   GROUP BY S.PROJECTION_DETAILS_SID,S.RS_MODEL_SID
                          ,P.YEAR
                   ) A
              GROUP BY  PROJECTION_DETAILS_SID,YEAR
                   ,YEAR1
                       )B
            GROUP BY  YEAR
                   ,YEAR1

            ORDER BY YEAR
                   ,YEAR1
                            
                ]]> </query>
</entity>
</sql>
