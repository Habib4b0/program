<?xml version="1.0" encoding="UTF-8"?>
<custom-sql>
    <sql id="nm.dleteTemp">
		<![CDATA[
		DELETE FROM dbo.ST_NM_SALES_PROJECTION WHERE USER_ID=?UID AND SESSION_ID=?SID;
		DELETE FROM dbo.ST_NM_ACTUAL_SALES WHERE USER_ID=?UID AND SESSION_ID=?SID;
                DELETE FROM dbo.ST_NM_SALES_PROJECTION_MASTER WHERE USER_ID=?UID AND SESSION_ID=?SID;
		DELETE FROM dbo.ST_NM_PPA_PROJECTION WHERE USER_ID=?UID AND SESSION_ID=?SID;
		DELETE FROM dbo.ST_NM_ACTUAL_PPA WHERE USER_ID=?UID AND SESSION_ID=?SID;
		DELETE FROM dbo.ST_NM_PPA_PROJECTION_MASTER WHERE USER_ID=?UID AND SESSION_ID=?SID;
		DELETE FROM dbo.ST_NM_DISCOUNT_PROJECTION WHERE USER_ID=?UID AND SESSION_ID=?SID;
		DELETE FROM dbo.ST_NM_ACTUAL_DISCOUNT WHERE USER_ID=?UID AND SESSION_ID=?SID;
		DELETE FROM dbo.ST_NM_DISCOUNT_PROJ_MASTER WHERE USER_ID=?UID AND SESSION_ID=?SID;
		DELETE FROM dbo.ST_NM_ASSUMPTIONS WHERE USER_ID=?UID AND SESSION_ID=?SID;
		]]>
    </sql>
    
    <sql id="m.dleteTemp">
		<![CDATA[
		DELETE FROM dbo.ST_M_SALES_PROJECTION WHERE USER_ID=?UID AND SESSION_ID=?SID;
		DELETE FROM dbo.ST_M_ACTUAL_SALES WHERE USER_ID=?UID AND SESSION_ID=?SID;
                DELETE FROM dbo.ST_M_SALES_PROJECTION_MASTER WHERE USER_ID=?UID AND SESSION_ID=?SID;
		DELETE FROM dbo.ST_M_SUPPLEMENTAL_DISC_ACTUALS WHERE USER_ID=?UID AND SESSION_ID=?SID;
		DELETE FROM dbo.ST_M_SUPPLEMENTAL_DISC_MASTER WHERE USER_ID=?UID AND SESSION_ID=?SID;
		DELETE FROM dbo.ST_M_SUPPLEMENTAL_DISC_PROJ WHERE USER_ID=?UID AND SESSION_ID=?SID;
		DELETE FROM dbo.ST_M_ASSUMPTIONS WHERE USER_ID=?UID AND SESSION_ID=?SID;
		]]>
    </sql>
    
    <sql id="returns.dleteTemp">
	<![CDATA[
		DELETE FROM dbo.ST_RETURNS_PROJ_MASTER WHERE USER_ID=?UID AND SESSION_ID=?SID;
		DELETE FROM dbo.ST_RETURNS_PROJ_DETAILS WHERE USER_ID=?UID AND SESSION_ID=?SID;
                DELETE FROM dbo.ST_RETURNS_ACTUALS WHERE USER_ID=?UID AND SESSION_ID=?SID;
	]]>
    </sql>
    <sql id="accural.dleteTemp">
	<![CDATA[
		DELETE FROM dbo.ST_RETURNS_PROJ_MASTER WHERE USER_ID=?UID AND SESSION_ID=?SID;
		DELETE FROM dbo.ST_RETURNS_PROJ_DETAILS WHERE USER_ID=?UID AND SESSION_ID=?SID;
                DELETE FROM dbo.ST_RETURNS_ACTUALS WHERE USER_ID=?UID AND SESSION_ID=?SID;
                DELETE FROM dbo.ST_ACCRUAL_DETAILS_ACTUALS WHERE USER_ID=?UID AND SESSION_ID=?SID;
                DELETE FROM dbo.ST_ACCRUAL_DETAILS_INFO WHERE USER_ID=?UID AND SESSION_ID=?SID;
                DELETE FROM dbo.ST_ACCRUAL_SALES_ACTUALS WHERE USER_ID=?UID AND SESSION_ID=?SID;
                DELETE FROM dbo.ST_ACCRUAL_SALES_DETAILS WHERE USER_ID=?UID AND SESSION_ID=?SID;
                DELETE FROM dbo.ST_EXCLUSION_DETAILS WHERE USER_ID=?UID AND SESSION_ID=?SID;
	]]>
    </sql>
   
    <sql id="nm.dleteMasterTables">
		<![CDATA[
		DELETE FROM dbo.NM_SALES_PROJECTION WHERE PROJECTION_DETAILS_SID in 
		(SELECT PROJECTION_DETAILS_SID FROM dbo.PROJECTION_DETAILS WHERE PROJECTION_MASTER_SID=?PID);
		DELETE FROM dbo.NM_ACTUAL_SALES WHERE PROJECTION_DETAILS_SID in 
		(SELECT PROJECTION_DETAILS_SID FROM dbo.PROJECTION_DETAILS WHERE PROJECTION_MASTER_SID=?PID);
	    DELETE FROM dbo.NM_SALES_PROJECTION_MASTER WHERE PROJECTION_DETAILS_SID in 
		(SELECT PROJECTION_DETAILS_SID FROM dbo.PROJECTION_DETAILS WHERE PROJECTION_MASTER_SID=?PID);
		
		DELETE FROM dbo.NM_DISCOUNT_PROJECTION WHERE PROJECTION_DETAILS_SID in 
		(SELECT PROJECTION_DETAILS_SID FROM dbo.PROJECTION_DETAILS WHERE PROJECTION_MASTER_SID=?PID);
		DELETE FROM dbo.NM_ACTUAL_DISCOUNT WHERE PROJECTION_DETAILS_SID in 
		(SELECT PROJECTION_DETAILS_SID FROM dbo.PROJECTION_DETAILS WHERE PROJECTION_MASTER_SID=?PID);
		DELETE FROM dbo.NM_DISCOUNT_PROJ_MASTER WHERE PROJECTION_DETAILS_SID in 
		(SELECT PROJECTION_DETAILS_SID FROM dbo.PROJECTION_DETAILS WHERE PROJECTION_MASTER_SID=?PID);
		
		DELETE FROM dbo.NM_PPA_PROJECTION WHERE PROJECTION_DETAILS_SID in 
		(SELECT PROJECTION_DETAILS_SID FROM dbo.PROJECTION_DETAILS WHERE PROJECTION_MASTER_SID=?PID);
		DELETE FROM dbo.NM_ACTUAL_PPA WHERE PROJECTION_DETAILS_SID in 
		(SELECT PROJECTION_DETAILS_SID FROM dbo.PROJECTION_DETAILS WHERE PROJECTION_MASTER_SID=?PID);
		DELETE FROM dbo.NM_PPA_PROJECTION_MASTER WHERE PROJECTION_DETAILS_SID in 
		(SELECT PROJECTION_DETAILS_SID FROM dbo.PROJECTION_DETAILS WHERE PROJECTION_MASTER_SID=?PID);
		
		DELETE FROM dbo.NM_ASSUMPTIONS WHERE PROJECTION_DETAILS_SID in 
		(SELECT PROJECTION_DETAILS_SID FROM dbo.PROJECTION_DETAILS WHERE PROJECTION_MASTER_SID=?PID);
		]]>
    </sql>
    
    <sql id="nm.dleteTempProjectionTables">
		<![CDATA[
		DELETE FROM dbo.ST_NM_SALES_PROJECTION WHERE PROJECTION_DETAILS_SID in 
		(SELECT PROJECTION_DETAILS_SID FROM dbo.PROJECTION_DETAILS WHERE PROJECTION_MASTER_SID=?PID);
		DELETE FROM dbo.ST_NM_ACTUAL_SALES WHERE PROJECTION_DETAILS_SID in 
		(SELECT PROJECTION_DETAILS_SID FROM dbo.PROJECTION_DETAILS WHERE PROJECTION_MASTER_SID=?PID);
	    DELETE FROM dbo.ST_NM_SALES_PROJECTION_MASTER WHERE PROJECTION_DETAILS_SID in 
		(SELECT PROJECTION_DETAILS_SID FROM dbo.PROJECTION_DETAILS WHERE PROJECTION_MASTER_SID=?PID);
		
		DELETE FROM dbo.ST_NM_DISCOUNT_PROJECTION WHERE PROJECTION_DETAILS_SID in 
		(SELECT PROJECTION_DETAILS_SID FROM dbo.PROJECTION_DETAILS WHERE PROJECTION_MASTER_SID=?PID);
		DELETE FROM dbo.ST_NM_ACTUAL_DISCOUNT WHERE PROJECTION_DETAILS_SID in 
		(SELECT PROJECTION_DETAILS_SID FROM dbo.PROJECTION_DETAILS WHERE PROJECTION_MASTER_SID=?PID);
		DELETE FROM dbo.ST_NM_DISCOUNT_PROJ_MASTER WHERE PROJECTION_DETAILS_SID in 
		(SELECT PROJECTION_DETAILS_SID FROM dbo.PROJECTION_DETAILS WHERE PROJECTION_MASTER_SID=?PID);
		
		DELETE FROM dbo.ST_NM_PPA_PROJECTION WHERE PROJECTION_DETAILS_SID in 
		(SELECT PROJECTION_DETAILS_SID FROM dbo.PROJECTION_DETAILS WHERE PROJECTION_MASTER_SID=?PID);
		DELETE FROM dbo.ST_NM_ACTUAL_PPA WHERE PROJECTION_DETAILS_SID in 
		(SELECT PROJECTION_DETAILS_SID FROM dbo.PROJECTION_DETAILS WHERE PROJECTION_MASTER_SID=?PID);
		DELETE FROM dbo.ST_NM_PPA_PROJECTION_MASTER WHERE PROJECTION_DETAILS_SID in 
		(SELECT PROJECTION_DETAILS_SID FROM dbo.PROJECTION_DETAILS WHERE PROJECTION_MASTER_SID=?PID);
		
		DELETE FROM dbo.ST_NM_ASSUMPTIONS WHERE PROJECTION_DETAILS_SID in 
		(SELECT PROJECTION_DETAILS_SID FROM dbo.PROJECTION_DETAILS WHERE PROJECTION_MASTER_SID=?PID);
		]]>
    </sql>
    
    <sql id="nm.deleteCustomViewTables">
		<![CDATA[
		DELETE FROM dbo.CUSTOM_VIEW_DETAILS WHERE CUSTOM_VIEW_MASTER_SID in 
		(SELECT CUSTOM_VIEW_MASTER_SID FROM CUSTOM_VIEW_MASTER WHERE PROJECTION_MASTER_SID=?PID);
		DELETE FROM dbo.CUSTOM_VIEW_MASTER WHERE PROJECTION_MASTER_SID =?PID;
		]]>
    </sql>
    
    
    <sql id="nm.deleteProjectionSelection">
		<![CDATA[
		DELETE FROM dbo.NM_PROJECTION_SELECTION WHERE PROJECTION_MASTER_SID =?PID;
		]]>
    </sql>
    
    
    <sql id="getProjectionIds">
		<![CDATA[
                    SELECT PROJECTION_MASTER_SID FROM PROJECTION_MASTER WHERE SAVE_FLAG = 'false' 
		]]>
    </sql>
    
    <sql id="nm.clearTemp">
		<![CDATA[
		DELETE FROM dbo.ST_NM_SALES_PROJECTION WHERE LAST_MODIFIED_DATE<'?LD';
		DELETE FROM dbo.ST_NM_ACTUAL_SALES WHERE LAST_MODIFIED_DATE<'?LD';
	    DELETE FROM dbo.ST_NM_SALES_PROJECTION_MASTER WHERE LAST_MODIFIED_DATE<'?LD';
		
		DELETE FROM dbo.ST_NM_PPA_PROJECTION WHERE LAST_MODIFIED_DATE<'?LD';
		DELETE FROM dbo.ST_NM_ACTUAL_PPA WHERE LAST_MODIFIED_DATE<'?LD';
		DELETE FROM dbo.ST_NM_PPA_PROJECTION_MASTER WHERE LAST_MODIFIED_DATE<'?LD';
		
		DELETE FROM dbo.ST_NM_ACTUAL_DISCOUNT WHERE LAST_MODIFIED_DATE<'?LD';
		DELETE FROM dbo.ST_NM_DISCOUNT_PROJ_MASTER WHERE LAST_MODIFIED_DATE<'?LD';
		DELETE FROM dbo.ST_NM_DISCOUNT_PROJECTION WHERE LAST_MODIFIED_DATE<'?LD';
		
		DELETE FROM dbo.ST_NM_ASSUMPTIONS WHERE LAST_MODIFIED_DATE<'?LD';
		]]>
    </sql>
    
     <sql id="nm.tempInsert">
		<![CDATA[
	    INSERT INTO ST_NM_SALES_PROJECTION_MASTER(
			PROJECTION_DETAILS_SID,
			METHODOLOGY,
			USER_GROUP,
			CALCULATION_PERIODS,
			CALCULATION_BASED,
			CHECK_RECORD, 
                        FORECAST_START_PERIOD_SID,
                        FORECAST_END_PERIOD_SID,
                        ALLOCATION_BASIS)
		SELECT A.PROJECTION_DETAILS_SID,
			A.METHODOLOGY,
			A.USER_GROUP,
			A.CALCULATION_PERIODS,
			A.CALCULATION_BASED,
			A.CHECK_RECORD, 
                        A.FORECAST_START_PERIOD_SID,
                        A.FORECAST_END_PERIOD_SID,
                        A.ALLOCATION_BASIS
		FROM dbo.NM_SALES_PROJECTION_MASTER A,
			dbo.PROJECTION_DETAILS B
		WHERE A.PROJECTION_DETAILS_SID=B.PROJECTION_DETAILS_SID
			AND B.PROJECTION_MASTER_SID=?PID;	
				]]>
    </sql>
    
     <sql id="nm.tempInsert1">
		<![CDATA[
		INSERT INTO dbo.ST_NM_SALES_PROJECTION(
			PROJECTION_DETAILS_SID,
			ACCOUNT_GROWTH,
			PRODUCT_GROWTH,
			PROJECTION_SALES,
			PROJECTION_UNITS,
			PERIOD_SID,
			ADJUSTMENT_TYPE,
			ADJUSTMENT_BASIS,
			ADJUSTMENT_VARIABLE,
			ADJUSTMENT_METHODOLOGY,
			ADJUSTMENT_VALUES )
		SELECT A.PROJECTION_DETAILS_SID,
			A.ACCOUNT_GROWTH,
			A.PRODUCT_GROWTH,
			A.PROJECTION_SALES,
			A.PROJECTION_UNITS,
			A.PERIOD_SID,
			A.ADJUSTMENT_TYPE,
			A.ADJUSTMENT_BASIS,
			A.ADJUSTMENT_VARIABLE,
			A.ADJUSTMENT_METHODOLOGY,
			A.ADJUSTMENT_VALUES
		FROM dbo.NM_SALES_PROJECTION A,
			dbo.PROJECTION_DETAILS B
		WHERE A.PROJECTION_DETAILS_SID=B.PROJECTION_DETAILS_SID
			AND B.PROJECTION_MASTER_SID=?PID;
				]]>
    </sql>
    
     <sql id="nm.tempInsert2">
		<![CDATA[
		INSERT INTO dbo.ST_NM_ACTUAL_SALES(
			PROJECTION_DETAILS_SID,
			PERIOD_SID,
			ACTUAL_SALES,
			ACTUAL_UNITS,
			HISTORY_PROJECTION_SALES,
			HISTORY_PROJECTION_UNITS)
		SELECT A.PROJECTION_DETAILS_SID,
			A.PERIOD_SID,
			A.ACTUAL_SALES,
			A.ACTUAL_UNITS,
			A.HISTORY_PROJECTION_SALES,
			A.HISTORY_PROJECTION_UNITS
		FROM dbo.NM_ACTUAL_SALES A,
			dbo.PROJECTION_DETAILS B
		WHERE A.PROJECTION_DETAILS_SID=B.PROJECTION_DETAILS_SID
			AND B.PROJECTION_MASTER_SID=?PID;		
				]]>
    </sql>
    
     <sql id="nm.tempInsert3">
		<![CDATA[
		INSERT INTO dbo.ST_NM_DISCOUNT_PROJ_MASTER(
			PROJECTION_DETAILS_SID,
			RS_MODEL_SID,
			METHODOLOGY,
			PRICE_GROUP_TYPE,
			NET_FLAG,
			USER_GROUP,
			CHECK_RECORD,
			BASELINE_PERIODS,
			SELECTED_PERIODS,
                        CALCULATION_PERIODS,
                        CALCULATION_BASED,
                        FORECAST_START_PERIOD_SID,
                        FORECAST_END_PERIOD_SID)
		SELECT A.PROJECTION_DETAILS_SID,
			A.RS_MODEL_SID,
			A.METHODOLOGY,
			A.PRICE_GROUP_TYPE,
			A.NET_FLAG,
			A.USER_GROUP,
			A.CHECK_RECORD,
			A.BASELINE_PERIODS,
			A.SELECTED_PERIODS,
                        A.CALCULATION_PERIODS,
                        A.CALCULATION_BASED,
                        A.FORECAST_START_PERIOD_SID,
                        A.FORECAST_END_PERIOD_SID
		FROM dbo.NM_DISCOUNT_PROJ_MASTER A,
			dbo.PROJECTION_DETAILS B
		WHERE A.PROJECTION_DETAILS_SID=B.PROJECTION_DETAILS_SID
			AND B.PROJECTION_MASTER_SID=?PID;
				]]>
    </sql>
    
     <sql id="nm.tempInsert4">
		<![CDATA[
		INSERT INTO dbo.ST_NM_DISCOUNT_PROJECTION(
			PROJECTION_DETAILS_SID,
			RS_MODEL_SID,
                        PERIOD_SID,
			PROJECTION_SALES,
			PROJECTION_RATE,
			ADJUSTMENT_TYPE,
			ADJUSTMENT_BASIS,
			ADJUSTMENT_VALUE,
			ADJUSTMENT_METHODOLOGY,
                        PROJECTION_RPU,
                        GROWTH,
                        REFRESHED_NAME,
                        REFRESHED_VALUE,
                        DISCOUNT_RATE)
		SELECT A.PROJECTION_DETAILS_SID,
			A.RS_MODEL_SID,
			A.PERIOD_SID,
			A.PROJECTION_SALES,
			A.PROJECTION_RATE,
			A.ADJUSTMENT_TYPE,
			A.ADJUSTMENT_BASIS,
			A.ADJUSTMENT_VALUE,
			A.ADJUSTMENT_METHODOLOGY,
                        A.PROJECTION_RPU,
                        A.GROWTH,
                        A.REFRESHED_NAME,
                        A.REFRESHED_VALUE,
                        A.DISCOUNT_RATE 
		FROM dbo.NM_DISCOUNT_PROJECTION A,
			dbo.PROJECTION_DETAILS B
		WHERE A.PROJECTION_DETAILS_SID=B.PROJECTION_DETAILS_SID
			AND B.PROJECTION_MASTER_SID=?PID;	
				]]>
    </sql>
    
     <sql id="nm.tempInsert5">
		<![CDATA[
		INSERT INTO dbo.ST_NM_ACTUAL_DISCOUNT(
			PROJECTION_DETAILS_SID,
			RS_MODEL_SID,
			PERIOD_SID,
			ACTUAL_SALES,
			ACTUAL_RATE,
			ACTUAL_PROJECTION_SALES,
			ACTUAL_PROJECTION_RATE,
                        ACTUAL_RPU)
		SELECT A.PROJECTION_DETAILS_SID,
			A.RS_MODEL_SID,
			A.PERIOD_SID,
			A.ACTUAL_SALES,
			A.ACTUAL_RATE,
			A.ACTUAL_PROJECTION_SALES,
			A.ACTUAL_PROJECTION_RATE,
                        A.ACTUAL_RPU 
		FROM dbo.NM_ACTUAL_DISCOUNT A,
			dbo.PROJECTION_DETAILS B
		WHERE A.PROJECTION_DETAILS_SID=B.PROJECTION_DETAILS_SID
			AND B.PROJECTION_MASTER_SID=?PID;	
				]]>
    </sql>
    
     <sql id="nm.tempInsert6">
		<![CDATA[
		INSERT INTO dbo.ST_NM_PPA_PROJECTION_MASTER (
       PROJECTION_DETAILS_SID
       ,ACTUAL_PRICE_CAP
       ,PRICE_BASIS
       ,USER_GROUP
       ,PRICE_PROTECTION_START_DATE
       ,PRICE_PROTECTION_END_DATE
       ,PRICE_PROTECTION_STATUS
       ,CHECK_RECORD
       ,RS_MODEL_SID
       ,REBATE_FREQUENCY
       )
SELECT A.PROJECTION_DETAILS_SID
       ,A.ACTUAL_PRICE_CAP
       ,A.PRICE_BASIS
       ,A.USER_GROUP
       ,A.PRICE_PROTECTION_START_DATE
       ,A.PRICE_PROTECTION_END_DATE
       ,a.PRICE_PROTECTION_STATUS
       ,A.CHECK_RECORD
       ,A.RS_MODEL_SID
       ,A.REBATE_FREQUENCY
FROM dbo.NM_PPA_PROJECTION_MASTER A
       ,dbo.PROJECTION_DETAILS B
WHERE A.PROJECTION_DETAILS_SID = B.PROJECTION_DETAILS_SID
       AND B.PROJECTION_MASTER_SID = ?PID;
		]]>
    </sql>
    
     <sql id="nm.tempInsert7">
		<![CDATA[
			
		INSERT INTO dbo.ST_NM_PPA_PROJECTION (
       PROJECTION_DETAILS_SID
       ,PRICE_CAP
       ,RESET
       ,PERIOD_SID
       ,RESET_PRICE_CAP
       ,PROJECTION_MAP
       ,PROJECTION_RATE
       ,PROJECTION_SALES
       ,PROJECTION_DISCOUNT_DOLLAR
       ,PROJECTION_DISCOUNT_UNITS
       ,ITEM_PRICING_QUALIFIER_SID
       ,NEP
       ,NEP_FORMULA
       ,BASE_PRICE_TYPE
       ,BASE_PRICE_MANUAL
       ,BASE_PRICE_DATE
       ,BASE_PRICE_PRICE_TYPE
       ,NET_BASE_PRICE
       ,NET_BASE_PRICE_FORMULA
       ,SUBSEQUENT_PERIOD_PRICE_TYPE
       ,NET_SUBSEQUENT_PERIOD_PRICE
       ,NET_SUBSEQUENT_PERIOD_PRICE_FORMULA
       ,PRICE_TOLERANCE_INTERVAL
       ,PRICE_TOLERANCE_FREQUENCY
       ,PRICE_TOLERANCE_TYPE
       ,PRICE_TOLERANCE
       ,MAX_INCREMENTAL_CHANGE
       ,RESET_ELIGIBLE
       ,RESET_TYPE
       ,RESET_DATE
       ,RESET_INTERVAL
       ,RESET_FREQUENCY
       ,RESET_PRICE_TYPE
       ,NET_RESET_PRICE_TYPE
       ,NET_RESET_PRICE_FORMULA
       ,NET_PRICE_TYPE
       ,NET_PRICE_TYPE_FORMULA
       ,ATTACHED_DATE
       ,Price
       ,PriceChange
       ,TotalDeductions
       ,NetPrice
       ,NetMap
       ,PriceProtectionAmountPerUnit
       ,PriceProtectionPercentage
       ,TotalPriceProtectionDeduction
       ,DEDUCTION_PER_UNIT
       ,RS_MODEL_SID
       )
SELECT A.PROJECTION_DETAILS_SID
       ,A.PRICE_CAP
       ,A.RESET
       ,A.PERIOD_SID
       ,A.RESET_PRICE_CAP
       ,A.PROJECTION_MAP
       ,A.PROJECTION_RATE
       ,A.PROJECTION_SALES
       ,A.PROJECTION_DISCOUNT_DOLLAR
       ,A.PROJECTION_DISCOUNT_UNITS
       ,a.ITEM_PRICING_QUALIFIER_SID
       ,a.NEP
       ,a.NEP_FORMULA
       ,a.BASE_PRICE_TYPE
       ,a.BASE_PRICE_MANUAL
       ,a.BASE_PRICE_DATE
       ,a.BASE_PRICE_PRICE_TYPE
       ,a.NET_BASE_PRICE
       ,a.NET_BASE_PRICE_FORMULA
       ,a.SUBSEQUENT_PERIOD_PRICE_TYPE
       ,a.NET_SUBSEQUENT_PERIOD_PRICE
       ,a.NET_SUBSEQUENT_PERIOD_PRICE_FORMULA
       ,a.PRICE_TOLERANCE_INTERVAL
       ,a.PRICE_TOLERANCE_FREQUENCY
       ,a.PRICE_TOLERANCE_TYPE
       ,a.PRICE_TOLERANCE
       ,a.MAX_INCREMENTAL_CHANGE
       ,a.RESET_ELIGIBLE
       ,a.RESET_TYPE
       ,a.RESET_DATE
       ,a.RESET_INTERVAL
       ,a.RESET_FREQUENCY
       ,a.RESET_PRICE_TYPE
       ,a.NET_RESET_PRICE_TYPE
       ,a.NET_RESET_PRICE_FORMULA
       ,a.NET_PRICE_TYPE
       ,a.NET_PRICE_TYPE_FORMULA
       ,a.ATTACHED_DATE
       ,a.Price
       ,a.PriceChange
       ,a.TotalDeductions
       ,a.NetPrice
       ,a.NetMap
       ,a.PriceProtectionAmountPerUnit
       ,a.PriceProtectionPercentage
       ,a.TotalPriceProtectionDeduction
       ,a.DEDUCTION_PER_UNIT
       ,A.RS_MODEL_SID
FROM dbo.NM_PPA_PROJECTION A
       ,dbo.PROJECTION_DETAILS B
WHERE A.PROJECTION_DETAILS_SID = B.PROJECTION_DETAILS_SID
       AND B.PROJECTION_MASTER_SID = ?PID;

		]]>
    </sql>
    
     <sql id="nm.tempInsert8">
		<![CDATA[		
		INSERT INTO dbo.ST_NM_ACTUAL_PPA (
       PROJECTION_DETAILS_SID
       ,PERIOD_SID
       ,ACTUAL_RATE
       ,ACTUAL_SALES
       ,ACTUAL_DISCOUNT_DOLLAR
       ,ACTUAL_DISCOUNT_UNITS
       ,ACTUAL_PROJECTION_SALES
       ,ACTUAL_PROJECTION_RATE
       ,ACTUAL_PROJ_DISCOUNT_DOLLAR
       ,ACTUAL_PROJ_DISCOUNT_UNITS
       ,ITEM_PRICING_QUALIFIER_SID
       ,NEP
       ,NEP_FORMULA
       ,BASE_PRICE_TYPE
       ,BASE_PRICE_MANUAL
       ,BASE_PRICE_DATE
       ,BASE_PRICE_PRICE_TYPE
       ,NET_BASE_PRICE
       ,NET_BASE_PRICE_FORMULA
       ,SUBSEQUENT_PERIOD_PRICE_TYPE
       ,NET_SUBSEQUENT_PERIOD_PRICE
       ,NET_SUBSEQUENT_PERIOD_PRICE_FORMULA
       ,PRICE_TOLERANCE_INTERVAL
       ,PRICE_TOLERANCE_FREQUENCY
       ,PRICE_TOLERANCE_TYPE
       ,PRICE_TOLERANCE
       ,MAX_INCREMENTAL_CHANGE
       ,RESET_ELIGIBLE
       ,RESET_TYPE
       ,RESET_DATE
       ,RESET_INTERVAL
       ,RESET_FREQUENCY
       ,RESET_PRICE_TYPE
       ,NET_RESET_PRICE_TYPE
       ,NET_RESET_PRICE_FORMULA
       ,NET_PRICE_TYPE
       ,NET_PRICE_TYPE_FORMULA
       ,ATTACHED_DATE
       ,Price
       ,PriceChange
       ,TotalDeductions
       ,NetPrice
       ,NetMap
       ,PriceProtectionAmountPerUnit
       ,PriceProtectionPercentage
       ,TotalPriceProtectionDeduction
       ,DEDUCTION_PER_UNIT
       ,RS_MODEL_SID
       )
SELECT a.PROJECTION_DETAILS_SID
       ,a.PERIOD_SID
       ,a.ACTUAL_RATE
       ,a.ACTUAL_SALES
       ,a.ACTUAL_DISCOUNT_DOLLAR
       ,a.ACTUAL_DISCOUNT_UNITS
       ,a.ACTUAL_PROJECTION_SALES
       ,a.ACTUAL_PROJECTION_RATE
       ,a.ACTUAL_PROJ_DISCOUNT_DOLLAR
       ,a.ACTUAL_PROJ_DISCOUNT_UNITS
       ,a.ITEM_PRICING_QUALIFIER_SID
       ,a.NEP
       ,a.NEP_FORMULA
       ,a.BASE_PRICE_TYPE
       ,a.BASE_PRICE_MANUAL
       ,a.BASE_PRICE_DATE
       ,a.BASE_PRICE_PRICE_TYPE
       ,a.NET_BASE_PRICE
       ,a.NET_BASE_PRICE_FORMULA
       ,a.SUBSEQUENT_PERIOD_PRICE_TYPE
       ,a.NET_SUBSEQUENT_PERIOD_PRICE
       ,a.NET_SUBSEQUENT_PERIOD_PRICE_FORMULA
       ,a.PRICE_TOLERANCE_INTERVAL
       ,a.PRICE_TOLERANCE_FREQUENCY
       ,a.PRICE_TOLERANCE_TYPE
       ,a.PRICE_TOLERANCE
       ,a.MAX_INCREMENTAL_CHANGE
       ,a.RESET_ELIGIBLE
       ,a.RESET_TYPE
       ,a.RESET_DATE
       ,a.RESET_INTERVAL
       ,a.RESET_FREQUENCY
       ,a.RESET_PRICE_TYPE
       ,a.NET_RESET_PRICE_TYPE
       ,a.NET_RESET_PRICE_FORMULA
       ,a.NET_PRICE_TYPE
       ,a.NET_PRICE_TYPE_FORMULA
       ,a.ATTACHED_DATE
       ,a.Price
       ,a.PriceChange
       ,a.TotalDeductions
       ,a.NetPrice
       ,a.NetMap
       ,a.PriceProtectionAmountPerUnit
       ,a.PriceProtectionPercentage
       ,a.TotalPriceProtectionDeduction
       ,a.DEDUCTION_PER_UNIT
       ,A.RS_MODEL_SID
FROM dbo.NM_ACTUAL_PPA A
       ,dbo.PROJECTION_DETAILS B
WHERE A.PROJECTION_DETAILS_SID = B.PROJECTION_DETAILS_SID
       AND B.PROJECTION_MASTER_SID = ?PID;
	
		]]>
    </sql>
    
     <sql id="nm.tempInsert9">
		<![CDATA[		
		INSERT INTO dbo.ST_NM_ASSUMPTIONS(
                        NM_ASSUMPTIONS_SID,
			PROJECTION_DETAILS_SID,
			PROJECTION_PERIOD,
			SEGMENT,
			GROSS_SALES_PRIOR,
			GROSS_SALES_PROJECTED,
			GROSS_SALES_PERCENT_CHANGE,
			TOTAL_DISCOUNT_PERCENT_PRIOR,
			TOTAL_DISCOUNT_PERCENT_PROJECTED,
			TOTAL_DISCOUNT_PERCENT_CHANGE,
			NET_SALES_PRIOR,
			NET_SALES_PROJECTED,
			NET_SALES_PERCENT_CHANGE,
			REASON_CODES,
			COMMENTARY,
			CAM_ID,
			PARENT,
			IS_CHECKED)
		SELECT A.NM_ASSUMPTIONS_SID, A.PROJECTION_DETAILS_SID,
			A.PROJECTION_PERIOD,
			A.SEGMENT,
			A.GROSS_SALES_PRIOR,
			A.GROSS_SALES_PROJECTED,
			A.GROSS_SALES_PERCENT_CHANGE,
			A.TOTAL_DISCOUNT_PERCENT_PRIOR,
			A.TOTAL_DISCOUNT_PERCENT_PROJECTED,
			A.TOTAL_DISCOUNT_PERCENT_CHANGE,
			A.NET_SALES_PRIOR,
			A.NET_SALES_PROJECTED,
			A.NET_SALES_PERCENT_CHANGE,
			A.REASON_CODES,
			A.COMMENTARY,
			A.CAM_ID,
			A.PARENT,
			0 IS_CHECKED
		FROM dbo.NM_ASSUMPTIONS A,
			dbo.PROJECTION_DETAILS B
		WHERE A.PROJECTION_DETAILS_SID=B.PROJECTION_DETAILS_SID
			AND B.PROJECTION_MASTER_SID=?PID
			AND A.PROJECTION_PERIOD>=?PSY
			AND A.PROJECTION_PERIOD<=?PEY;	
		]]>
    </sql>
    
</custom-sql>