<?xml version="1.0" encoding="UTF-8"?>
<sql>
    <entity id="SU-CH Count">
        <query>
		<![CDATA[
        SELECT Count(DISTINCT CONTRACT_MASTER_SID)
FROM   CONTRACT_MASTER
WHERE  CONTRACT_MASTER_SID = ?
		]]>
        </query>
    </entity>
    <entity id="SU-CH">
        <query>
		<![CDATA[
        SELECT DISTINCT 'Contract Holder' AS CH, 1 AS LEVEL_NO,CM.CONTRACT_ID,
       CM.CONTRACT_NO,
       CM.CONTRACT_NAME,CM.CONTRACT_MASTER_SID,CM.CONTRACT_MASTER_SID
FROM   CONTRACT_MASTER CM
WHERE  CM.CONTRACT_MASTER_SID = ?
		]]>
        </query>
    </entity>
    <entity id="SU-CFP Count">
        <query>
		<![CDATA[
        SELECT Count (DISTINCT CC.CFP_CONTRACT_SID)
FROM   CFP_CONTRACT CC
       JOIN CFP_MODEL CFP
         ON CFP.CFP_MODEL_SID = CC.CFP_MODEL_SID
            AND CC.CFP_CONTRACT_SID = '?'
            AND CC.CONTRACT_MASTER_SID = '?' 
		]]>
        </query>
    </entity>
    <entity id="SU-CFP">
        <query>
		<![CDATA[
        SELECT DISTINCT 'Company Family Plan' AS CH,2 AS LEVEL_NO,CFP.CFP_ID,
       CC.CFP_NO,
       CC.CFP_NAME,CC.CFP_CONTRACT_SID,CC.CONTRACT_MASTER_SID
FROM   CFP_CONTRACT CC
       JOIN CFP_MODEL CFP
         ON CFP.CFP_MODEL_SID = CC.CFP_MODEL_SID
            AND CC.CFP_CONTRACT_SID = '?'
            AND CC.CONTRACT_MASTER_SID = '?' 
		]]>
        </query>
    </entity>
    <entity id="SU-IFP Count">
        <query>
		<![CDATA[
        SELECT Count(DISTINCT IFP_C.IFP_CONTRACT_SID)
FROM   IFP_CONTRACT IFP_C
       JOIN IFP_MODEL IFP_M
         ON IFP_M.IFP_MODEL_SID = IFP_C.IFP_MODEL_SID
            AND IFP_C.IFP_CONTRACT_SID = '?'
            AND IFP_C.CFP_CONTRACT_SID = '?'
            AND IFP_C.CONTRACT_MASTER_SID = '?' 
		]]>
        </query>
    </entity>
    <entity id="SU-IFP">
        <query>
		<![CDATA[
       SELECT DISTINCT 'Item Family Plan' AS CH,3 AS LEVEL_NO,IFP_M.IFP_ID,
       IFP_C.IFP_NO,
       IFP_C.IFP_NAME,IFP_C.IFP_CONTRACT_SID,IFP_C.CONTRACT_MASTER_SID
FROM   IFP_CONTRACT IFP_C
       JOIN IFP_MODEL IFP_M
         ON IFP_M.IFP_MODEL_SID = IFP_C.IFP_MODEL_SID
            AND IFP_C.IFP_CONTRACT_SID = '?'
            AND IFP_C.CFP_CONTRACT_SID = '?'
            AND IFP_C.CONTRACT_MASTER_SID = '?'
		]]>
        </query>
    </entity>
    <entity id="SU-PS Count">
        <query>
		<![CDATA[
       SELECT Count(DISTINCT PS_C.PS_CONTRACT_SID)
FROM   PS_CONTRACT PS_C
       JOIN PS_MODEL PS_M
         ON PS_M.PS_MODEL_SID = PS_C.PS_MODEL_SID
            AND PS_C.PS_CONTRACT_SID = '?'
            AND PS_C.IFP_CONTRACT_SID = '?'
            AND PS_C.CFP_CONTRACT_SID = '?'
            AND PS_C.CONTRACT_MASTER_SID = '?' 

		]]>
        </query>
    </entity>
    <entity id="SU-PS">
        <query>
		<![CDATA[
       SELECT DISTINCT 'Price Schedule' AS CH,4 AS LEVEL_NO,PS_M.PS_ID,
       PS_C.PS_NO,
       PS_C.PS_NAME,PS_C.PS_CONTRACT_SID,PS_C.CONTRACT_MASTER_SID
FROM   PS_CONTRACT PS_C
       JOIN PS_MODEL PS_M
         ON PS_M.PS_MODEL_SID = PS_C.PS_MODEL_SID
            AND PS_C.PS_CONTRACT_SID = '?'
            AND PS_C.IFP_CONTRACT_SID = '?'
            AND PS_C.CFP_CONTRACT_SID = '?'
            AND PS_C.CONTRACT_MASTER_SID = '?'
		]]>
        </query>
    </entity>
    <entity id="SU-RS Count">
        <query>
		<![CDATA[
       SELECT Count(DISTINCT PS_C.RS_CONTRACT_SID)
FROM   RS_CONTRACT PS_C
       JOIN RS_MODEL PS_M
         ON PS_M.RS_MODEL_SID = PS_C.RS_MODEL_SID
            AND PS_C.RS_CONTRACT_SID = '?'
            AND PS_C.PS_CONTRACT_SID = '?'
            AND PS_C.IFP_CONTRACT_SID = '?'
            AND PS_C.CFP_CONTRACT_SID = '?'
            AND PS_C.CONTRACT_MASTER_SID = '?'

		]]>
        </query>
    </entity>
    <entity id="SU-RS">
        <query>
		<![CDATA[
      SELECT DISTINCT 'Rebate Schedule' AS CH,5 AS LEVEL_NO,PS_M.RS_ID,
       PS_C.RS_NO,
       PS_C.RS_NAME,PS_C.RS_CONTRACT_SID,PS_C.CONTRACT_MASTER_SID
FROM   RS_CONTRACT PS_C
       JOIN RS_MODEL PS_M
         ON PS_M.RS_MODEL_SID = PS_C.RS_MODEL_SID
            AND PS_C.RS_CONTRACT_SID = '?'
            AND PS_C.PS_CONTRACT_SID = '?'
            AND PS_C.IFP_CONTRACT_SID = '?'
            AND PS_C.CFP_CONTRACT_SID = '?'
            AND PS_C.CONTRACT_MASTER_SID = '?'
		]]>
        </query>
    </entity>
    <entity id="SU-Contracts Count">
        <query>
		<![CDATA[
        SELECT Count (*)
FROM   (SELECT DISTINCT COMP.COMPANY_NAME,
                        CM.contract_no,
                        CM.CONTRACT_NAME,
                        Market_Type.DESCRIPTION,
                        CM.START_DATE,
                        CM.END_DATE,
                        CFP.CFP_NAME,
                        IFP.IFP_NAME,
                        PS.PS_NAME,
                        RS.RS_NAME,
                        CM.CONTRACT_MASTER_SID,
                        CFP.CFP_CONTRACT_SID,
                        IFP.IFP_CONTRACT_SID,
                        PS.PS_CONTRACT_SID,
                        RS.RS_CONTRACT_SID
        FROM   GCM_GLOBAL_DETAILS Temp
               JOIN CONTRACT_MASTER CM
                 ON Temp.CONTRACT_MASTER_SID = CM.CONTRACT_MASTER_SID
                    AND SESSION_ID = '?'
                    AND MODULE_NAME = 'ITEM_MANAGEMENT'
                    AND OPERATION ='?'
               LEFT JOIN COMPANY_MASTER COMP
                      ON CM.CONT_HOLD_COMPANY_MASTER_SID = COMP.COMPANY_MASTER_SID
               LEFT JOIN HELPER_TABLE Market_Type
                      ON CM.CONTRACT_TYPE = Market_Type.HELPER_TABLE_SID
               JOIN CFP_CONTRACT CFP
                 ON Temp.CFP_CONTRACT_SID = CFP.CFP_CONTRACT_SID
               JOIN IFP_CONTRACT IFP
                 ON Temp. IFP_CONTRACT_SID = IFP.IFP_CONTRACT_SID
               JOIN PS_CONTRACT PS
                 ON Temp.PS_CONTRACT_SID = PS.PS_CONTRACT_SID
               JOIN RS_CONTRACT RS
                 ON Temp.RS_CONTRACT_SID = RS.RS_CONTRACT_SID ?) cont 

		]]>
        </query>
    </entity>
    <entity id="SU-Contracts">
        <query>
		<![CDATA[
      SELECT DISTINCT COMP.COMPANY_NAME,
                CM.contract_no,
                CM.CONTRACT_NAME,
                Market_Type.DESCRIPTION,
                CM.START_DATE,
                CM.END_DATE,
                CFP.CFP_NAME,
                IFP.IFP_NAME,
                PS.PS_NAME,
                RS.RS_NAME,
                'RAR Category' AS RAR_CAT,
                Status.DESCRIPTION,
                Temp.Start_date,
                Temp.END_DATE,
                CM.CONTRACT_MASTER_SID,
                CFP.CFP_CONTRACT_SID,
                IFP.IFP_CONTRACT_SID,
                PS.PS_CONTRACT_SID,
                RS.RS_CONTRACT_SID
FROM   GCM_GLOBAL_DETAILS Temp
       JOIN CONTRACT_MASTER CM
         ON Temp.CONTRACT_MASTER_SID = CM.CONTRACT_MASTER_SID
            AND SESSION_ID = '?'
            AND MODULE_NAME = 'ITEM_MANAGEMENT'
            AND OPERATION = '?'
       LEFT JOIN COMPANY_MASTER COMP
              ON CM.CONT_HOLD_COMPANY_MASTER_SID = COMP.COMPANY_MASTER_SID
       LEFT JOIN HELPER_TABLE Market_Type
              ON CM.CONTRACT_TYPE = Market_Type.HELPER_TABLE_SID
       LEFT JOIN HELPER_TABLE Status
         ON Status.HELPER_TABLE_SID = Temp.ITEM_STATUS
       JOIN CFP_CONTRACT CFP
         ON Temp.CFP_CONTRACT_SID = CFP.CFP_CONTRACT_SID
       JOIN IFP_CONTRACT IFP
         ON Temp. IFP_CONTRACT_SID = IFP.IFP_CONTRACT_SID
       JOIN PS_CONTRACT PS
         ON Temp.PS_CONTRACT_SID = PS.PS_CONTRACT_SID
       JOIN RS_CONTRACT RS
         ON Temp.RS_CONTRACT_SID = RS.RS_CONTRACT_SID ?
ORDER  BY CM.CONTRACT_MASTER_SID 
 
  OFFSET ? ROWS FETCH NEXT ? ROWS ONLY;

		]]>
        </query>
    </entity>
    <entity id="SU-Delete Dashboard Tree">
        <query>
		<![CDATA[
      DELETE FROM GCM_GLOBAL_DETAILS
WHERE  SESSION_ID = '?'
       AND MODULE_NAME = 'ITEM_MANAGEMENT'
       AND OPERATION = 'SUMMARY'
       AND CONTRACT_MASTER_SID = ?
		]]>
        </query>
    </entity>
    
    <entity id="Add Insert query">
        <query>
		<![CDATA[
     INSERT INTO GCM_GLOBAL_DETAILS
            (ITEM_STATUS,
             START_DATE,
             END_DATE,
             CONTRACT_PRICE_START_DATE,
             CONTRACT_PRICE_END_DATE,
             CONTRACT_PRICE,
             PRICE,
             PRICE_PROTECTION_START_DATE,
             PRICE_PROTECTION_END_DATE,
             PRICE_TOLERANCE_TYPE,
             PRICE_TOLERANCE,
             PRICE_TOLERANCE_FREQUENCY,
             PRICE_TOLERANCE_INTERVAL,
             BASE_PRICE,
             ITEM_REBATE_START_DATE,
             ITEM_REBATE_END_DATE,
             FORMULA_ID,
             FORMULA_METHOD_ID,
             REBATE_AMOUNT,
             CONTRACT_MASTER_SID,
             CFP_CONTRACT_SID,
              IFP_CONTRACT_SID,
             PS_CONTRACT_SID,
             RS_CONTRACT_SID,
              ITEM_MASTER_SID,
             SESSION_ID,
             OPERATION,
             MODULE_NAME)
(SELECT DISTINCT CM.CONTRACT_STATUS  AS CONTRACT_STATUS,
                 ICD.ITEM_START_DATE AS ITEM_START_DATE,
                 ICD.ITEM_END_DATE   AS END_DAITEM_END_DATETE,
                 PSCD.CONTRACT_PRICE_START_DATE,
                 PSCD.CONTRACT_PRICE_END_DATE,
                 PSCD.CONTRACT_PRICE,
                 PSCD.PRICE,
                 PSCD.PRICE_PROTECTION_START_DATE,
                 PSCD.PRICE_PROTECTION_END_DATE,
                 PSCD.PRICE_TOLERANCE_TYPE,
                 PSCD.PRICE_TOLERANCE,
                 PSCD.PRICE_TOLERANCE_FREQUENCY,
                 PSCD.PRICE_TOLERANCE_INTERVAL,
                 PSCD.BASE_PRICE,
                 RSC.RS_START_DATE,
                 RSC.RS_END_DATE,
                 RSCD.FORMULA_ID,
                 RSCD.FORMULA_METHOD_ID,
                 RSCD.REBATE_AMOUNT,
                 CM.CONTRACT_MASTER_SID,
                 CCT.CFP_CONTRACT_SID,
                 IFP_CONT.IFP_CONTRACT_SID,
                 PSC.PS_CONTRACT_SID,
                 RSC.RS_CONTRACT_SID,
                     ICD.ITEM_MASTER_SID,
                '?',
                 '?',
                 'ITEM_MANAGEMENT'
 FROM   PROJECTION_DETAILS pd
        JOIN PROJECTION_MASTER PM
          ON PD.PROJECTION_MASTER_SID = PM.PROJECTION_MASTER_SID
        JOIN CCP_DETAILS ccp
          ON pd.CCP_DETAILS_SID = ccp.CCP_DETAILS_SID
        INNER JOIN CONTRACT_MASTER CM
                ON cm.CONTRACT_MASTER_SID = ccp.CONTRACT_MASTER_SID
                   AND ( cm.CONTRACT_MASTER_SID LIKE '?' )
                   AND ( cm.CONTRACT_MASTER_SID LIKE '?' )
                ?   ?
                          
        LEFT JOIN COMPANY_MASTER COMP
               ON CM.CONT_HOLD_COMPANY_MASTER_SID = COMP.COMPANY_MASTER_SID
                  AND ( CM.CONT_HOLD_COMPANY_MASTER_SID LIKE '?'
                         OR CM.CONT_HOLD_COMPANY_MASTER_SID IS NULL )
        LEFT JOIN HELPER_TABLE Market_Type
               ON CM.CONTRACT_TYPE = Market_Type.HELPER_TABLE_SID
                  AND ( CM.CONTRACT_TYPE LIKE '?'
                         OR CM.CONTRACT_TYPE IS NULL )
        LEFT JOIN HELPER_TABLE Contract_Status
               ON CM.CONTRACT_STATUS = Contract_Status.HELPER_TABLE_SID
        INNER JOIN CFP_CONTRACT CCT
                ON CM.CONTRACT_MASTER_SID = CCT.CONTRACT_MASTER_SID
                   AND CM.INBOUND_STATUS <> 'D'
                   AND CCT.INBOUND_STATUS <> 'D'
                   AND ( CCT.CFP_CONTRACT_SID LIKE '?' )
        JOIN CFP_COntract_Details CFP_CONT
          ON CFP_CONT.CFP_CONTRACT_SID = CCT.CFP_CONTRACT_SID
             AND CFP_CONT.INBOUND_STATUS <> 'D'
        JOIN company_master COMPANY
          ON COMPANY.COMPANY_MASTER_SID = CFP_CONT.COMPANY_MASTER_SID
             AND ( COMPANY.COMPANY_MASTER_SID LIKE '?' )
             AND ( COMPANY.COMPANY_MASTER_SID LIKE '?' )
        INNER JOIN IFP_CONTRACT IFP_CONT
                ON IFP_CONT.CFP_CONTRACT_SID = CCT.CFP_CONTRACT_SID
                   AND IFP_CONT.INBOUND_STATUS <> 'D'
                   AND CM.CONTRACT_MASTER_SID = IFP_CONT.CONTRACT_MASTER_SID
                   AND ( IFP_CONT.IFP_CONTRACT_SID LIKE '?' )
        INNER JOIN IFP_CONTRACT_DETAILS ICD
                ON IFP_CONT.IFP_CONTRACT_SID = ICD.IFP_CONTRACT_SID
                   AND icd.ITEM_MASTER_SID IN( ? )
        INNER JOIN PS_CONTRACT PSC
                ON PSC.CONTRACT_MASTER_SID = CM.CONTRACT_MASTER_SID
                   AND PSC.IFP_CONTRACT_SID = IFP_CONT.IFP_CONTRACT_SID
                   AND PSC.INBOUND_STATUS <> 'D'
        INNER JOIN PS_CONTRACT_DETAILS PSCD
                ON PSCD.PS_CONTRACT_SID = PSC.PS_CONTRACT_SID
                   AND PSCD.ITEM_MASTER_SID IN( ? )
                   AND ( PSC.PS_CONTRACT_SID LIKE '?' )
        JOIN RS_CONTRACT RSC
          ON RSC.CONTRACT_MASTER_SID = CM.CONTRACT_MASTER_SID
             AND RSC.CFP_CONTRACT_SID = CCT.CFP_CONTRACT_SID
             AND RSC.IFP_CONTRACT_SID = IFP_CONT.IFP_CONTRACT_SID
             AND RSC.PS_CONTRACT_SID = PSC.PS_CONTRACT_SID
             AND RSC.INBOUND_STATUS <> 'D'
             AND ( rsc.RS_CONTRACT_SID LIKE '?'
                    OR rsc.RS_CONTRACT_SID IS NULL )
        JOIN RS_CONTRACT_DETAILS RSCD
          ON RSCD.RS_CONTRACT_SID = RSC.RS_CONTRACT_SID
             AND RSCD.ITEM_MASTER_SID IN( ? )) 

		]]>
        </query>
    </entity>
    
    <entity id="IFP Add Insert">
        <query>
		<![CDATA[
      INSERT INTO IFP_CONTRACT_DETAILS
            (IFP_CONTRACT_SID,
             ITEM_MASTER_SID,
             ITEM_START_DATE,
             ITEM_END_DATE,
             IFP_CONTRACT_ATTACHED_STATUS,
             IFP_CONTRACT_ATTACHED_DATE,
             INBOUND_STATUS,
             CREATED_BY)
(SELECT DISTINCT IFP_C.IFP_CONTRACT_SID,
        TEMP.ITEM_MASTER_SID,
        TEMP.START_DATE,
        TEMP.END_DATE,
        TEMP.IFP_CONTRACT_ATTACHED_STATUS,
        IFP_C.IFP_CONTRACT_ATTACHED_DATE,
        'A',
        '?'
 FROM   IFP_CONTRACT IFP_C
        JOIN GCM_GLOBAL_DETAILS TEMP
          ON IFP_C.CONTRACT_MASTER_SID = TEMP.CONTRACT_MASTER_SID
             AND IFP_C.IFP_CONTRACT_SID = TEMP. IFP_CONTRACT_SID
             AND Temp.session_id = '?'
             AND Temp.OPERATION = 'SUMMARY') 
		]]>
        </query>
    </entity>
    
    
    <entity id="PS Add Insert">
        <query>
		<![CDATA[
      INSERT INTO PS_CONTRACT_DETAILS
            (PS_CONTRACT_SID,
             ITEM_MASTER_SID,
             PS_CONTRACT_ATTACHED_STATUS,
             contract_PRICE_START_DATE,
             CONTRACT_PRICE_END_DATE,
             PRICE,
             PRICE_PROTECTION_START_DATE,
             PRICE_PROTECTION_END_DATE,
             PRICE_TOLERANCE_TYPE,
             PRICE_TOLERANCE,
             PRICE_TOLERANCE_FREQUENCY,
             PRICE_TOLERANCE_INTERVAL,
             BASE_PRICE,
             ITEM_PRICING_QUALIFIER_SID,
             INBOUND_STATUS,
             CREATED_BY)
(SELECT DISTINCT TEMP.PS_CONTRACT_SID,
        TEMP.ITEM_MASTER_SID,
        TEMP.ITEM_STATUS,
        TEMP.CONTRACT_PRICE_START_DATE,
        TEMP.END_DATE,
        TEMP.PRICE,
        TEMP.PRICE_PROTECTION_START_DATE,
        TEMP.PRICE_PROTECTION_END_DATE,
        TEMP.PRICE_TOLERANCE_TYPE,
        TEMP.PRICE_TOLERANCE,
        TEMP.PRICE_TOLERANCE_FREQUENCY,
        TEMP.PRICE_TOLERANCE_INTERVAL,
        TEMP.BASE_PRICE,
        IP.ITEM_PRICING_QUALIFIER_SID ,'A',
        '?'
 FROM   PS_CONTRACT PS_C
        JOIN GCM_GLOBAL_DETAILS TEMP
          ON PS_C.CONTRACT_MASTER_SID = TEMP.CONTRACT_MASTER_SID
          JOIN ITEM_PRICING IP on IP.ITEM_MASTER_SID=temp.ITEM_MASTER_SID
             AND PS_C.PS_CONTRACT_SID = TEMP.PS_CONTRACT_SID
             AND Temp.session_id = '?'
             AND Temp.OPERATION = 'SUMMARY')
		]]>
        </query>
    </entity>
    
    
    <entity id="RS Add Insert">
        <query>
		<![CDATA[
     INSERT INTO RS_CONTRACT_DETAILS
            (RS_CONTRACT_SID,
             ITEM_MASTER_SID,
             RS_CONTRACT_ATTACHED_STATUS,
             ITEM_REBATE_START_DATE,
             ITEM_REBATE_END_DATE,
             FORMULA_ID,
             FORMULA_METHOD_ID,
             REBATE_AMOUNT,
             INBOUND_STATUS,
             CREATED_BY)
SELECT DISTINCT TEMP.RS_CONTRACT_SID,
       TEMP.ITEM_MASTER_SID,
       TEMP.ITEM_STATUS,
       TEMP.ITEM_REBATE_START_DATE,
       TEMP.ITEM_REBATE_END_DATE,
       TEMP.FORMULA_ID,
       TEMP.FORMULA_METHOD_ID,
       TEMP.REBATE_AMOUNT,
       'A',
       '?'
FROM   RS_CONTRACT RS_C
       JOIN GCM_GLOBAL_DETAILS TEMP
         ON RS_C.CONTRACT_MASTER_SID = TEMP.CONTRACT_MASTER_SID
            AND RS_C.RS_CONTRACT_SID = TEMP.RS_CONTRACT_SID
            AND RS_C.PS_CONTRACT_SID = TEMP.PS_CONTRACT_SID
            AND RS_C.IFP_CONTRACT_SID = TEMP. IFP_CONTRACT_SID
            AND RS_C.CFP_CONTRACT_SID = TEMP.CFP_CONTRACT_SID
            AND Temp.session_id = '?'
            AND Temp.OPERATION = 'SUMMARY' 
		]]>
        </query>
    </entity>
    <entity id="Add Temp Insert query">
        <query>
		<![CDATA[
     INSERT INTO GCM_GLOBAL_DETAILS
            (ITEM_STATUS,
             START_DATE,
             END_DATE,
             CONTRACT_PRICE_START_DATE,
             CONTRACT_PRICE_END_DATE,
             CONTRACT_PRICE,
             PRICE,
             PRICE_PROTECTION_START_DATE,
             PRICE_PROTECTION_END_DATE,
             PRICE_TOLERANCE_TYPE,
             PRICE_TOLERANCE,
             PRICE_TOLERANCE_FREQUENCY,
             PRICE_TOLERANCE_INTERVAL,
             BASE_PRICE,
             ITEM_REBATE_START_DATE,
             ITEM_REBATE_END_DATE,
             FORMULA_ID,
             FORMULA_METHOD_ID,
             REBATE_AMOUNT,
             CONTRACT_MASTER_SID,
             CFP_CONTRACT_SID,
              IFP_CONTRACT_SID,
             PS_CONTRACT_SID,
             RS_CONTRACT_SID,
             ITEM_MASTER_SID,
             SESSION_ID,
             OPERATION,
             MODULE_NAME,
             PROJECTION_MASTER_SID)
SELECT DISTINCT CM.CONTRACT_STATUS  AS CONTRACT_STATUS,
                ICD.ITEM_START_DATE AS ITEM_START_DATE,
                ICD.ITEM_END_DATE   AS END_DAITEM_END_DATETE,
                PSCD.CONTRACT_PRICE_START_DATE,
                PSCD.CONTRACT_PRICE_END_DATE,
                PSCD.CONTRACT_PRICE,
                PSCD.PRICE,
                PSCD.PRICE_PROTECTION_START_DATE,
                PSCD.PRICE_PROTECTION_END_DATE,
                PSCD.PRICE_TOLERANCE_TYPE,
                PSCD.PRICE_TOLERANCE,
                PSCD.PRICE_TOLERANCE_FREQUENCY,
                PSCD.PRICE_TOLERANCE_INTERVAL,
                PSCD.BASE_PRICE,
                RSC.RS_START_DATE,
                RSC.RS_END_DATE,
                RSCD.FORMULA_ID,
                RSCD.FORMULA_METHOD_ID,
                RSCD.REBATE_AMOUNT,
                CM.CONTRACT_MASTER_SID,
                CCT.CFP_CONTRACT_SID,
                IFP_CONT.IFP_CONTRACT_SID,
                PSC.PS_CONTRACT_SID,
                RSC.RS_CONTRACT_SID,
                ?,
                '?',
                '?',
                'ITEM_MANAGEMENT',
                PM.PROJECTION_MASTER_SID
FROM   PROJECTION_DETAILS PD
       JOIN PROJECTION_MASTER PM
         ON PD.PROJECTION_MASTER_SID = PM.PROJECTION_MASTER_SID
       JOIN WORKFLOW_MASTER WM
         ON wm.PROJECTION_MASTER_SID = PM.PROJECTION_MASTER_SID
       JOIN CCP_DETAILS CCP
         ON PD.CCP_DETAILS_SID = CCP.CCP_DETAILS_SID
       INNER JOIN CONTRACT_MASTER CM
               ON CM.CONTRACT_MASTER_SID = CCP.CONTRACT_MASTER_SID
                  AND ( CM.CONTRACT_MASTER_SID LIKE '?' )
                  AND ( CM.CONTRACT_MASTER_SID LIKE '?' )
                  ? ?
       INNER JOIN (SELECT CONTRACT_MASTER_SID
                   FROM   IFP_CONTRACT_DETAILS IFP_CD
                          INNER JOIN IFP_CONTRACT IFP_CON
                                  ON IFP_CON.IFP_CONTRACT_SID = IFP_CD.IFP_CONTRACT_SID
                   GROUP  BY CONTRACT_MASTER_SID
                   HAVING Count(CASE
                                  WHEN ITEM_MASTER_SID IN ( ? ) THEN 1
                                END) = 0) F_CON
               ON F_CON.CONTRACT_MASTER_SID = CM.CONTRACT_MASTER_SID
       LEFT JOIN COMPANY_MASTER COMP
              ON CM.CONT_HOLD_COMPANY_MASTER_SID = COMP.COMPANY_MASTER_SID
                 AND ( CM.CONT_HOLD_COMPANY_MASTER_SID LIKE '?'
                        OR CM.CONT_HOLD_COMPANY_MASTER_SID IS NULL )
       LEFT JOIN HELPER_TABLE MARKET_TYPE
              ON CM.CONTRACT_TYPE = MARKET_TYPE.HELPER_TABLE_SID
                 AND ( CM.CONTRACT_TYPE LIKE '?'
                        OR CM.CONTRACT_TYPE IS NULL )
       LEFT JOIN HELPER_TABLE CONTRACT_STATUS
              ON CM.CONTRACT_STATUS = CONTRACT_STATUS.HELPER_TABLE_SID
       INNER JOIN CFP_CONTRACT CCT
               ON CM.CONTRACT_MASTER_SID = CCT.CONTRACT_MASTER_SID
                  AND CM.INBOUND_STATUS <> 'D'
                  AND CCT.INBOUND_STATUS <> 'D'
                  AND ( CCT.CFP_CONTRACT_SID LIKE '?' )
       JOIN CFP_CONTRACT_DETAILS CFP_CONT
         ON CFP_CONT.CFP_CONTRACT_SID = CCT.CFP_CONTRACT_SID
            AND CFP_CONT.COMPANY_MASTER_SID = CCP.COMPANY_MASTER_SID
            AND CFP_CONT.INBOUND_STATUS <> 'D'
       JOIN COMPANY_MASTER COMPANY
         ON COMPANY.COMPANY_MASTER_SID = CFP_CONT.COMPANY_MASTER_SID
            AND ( COMPANY.COMPANY_MASTER_SID LIKE '?' )
            AND ( COMPANY.COMPANY_MASTER_SID LIKE '?' )
       INNER JOIN IFP_CONTRACT IFP_CONT
               ON IFP_CONT.CFP_CONTRACT_SID = CCT.CFP_CONTRACT_SID
                  AND IFP_CONT.INBOUND_STATUS <> 'D'
                  AND CM.CONTRACT_MASTER_SID = IFP_CONT.CONTRACT_MASTER_SID
                  AND ( IFP_CONT.IFP_CONTRACT_SID LIKE '?' )
       INNER JOIN IFP_CONTRACT_DETAILS ICD
               ON IFP_CONT.IFP_CONTRACT_SID = ICD.IFP_CONTRACT_SID
       INNER JOIN PS_CONTRACT PSC
               ON PSC.CONTRACT_MASTER_SID = CM.CONTRACT_MASTER_SID
                  AND PSC.CFP_CONTRACT_SID = CCT.CFP_CONTRACT_SID
                  AND PSC.IFP_CONTRACT_SID = IFP_CONT.IFP_CONTRACT_SID
                  AND PSC.INBOUND_STATUS <> 'D'
       INNER JOIN PS_CONTRACT_DETAILS PSCD
               ON PSCD.PS_CONTRACT_SID = PSC.PS_CONTRACT_SID
                  AND PSCD.ITEM_MASTER_SID = ICD.ITEM_MASTER_SID
                  AND ( PSC.PS_CONTRACT_SID LIKE '?' )
       JOIN RS_CONTRACT RSC
         ON RSC.CONTRACT_MASTER_SID = CM.CONTRACT_MASTER_SID
            AND RSC.CFP_CONTRACT_SID = CCT.CFP_CONTRACT_SID
            AND RSC.IFP_CONTRACT_SID = IFP_CONT.IFP_CONTRACT_SID
            AND RSC.PS_CONTRACT_SID = PSC.PS_CONTRACT_SID
            AND RSC.INBOUND_STATUS <> 'D'
            AND ( RSC.RS_CONTRACT_SID LIKE '?'
                   OR RSC.RS_CONTRACT_SID IS NULL )
       JOIN RS_CONTRACT_DETAILS RSCD
         ON RSCD.RS_CONTRACT_SID = RSC.RS_CONTRACT_SID
            AND RSCD.ITEM_MASTER_SID = ICD.ITEM_MASTER_SID



		]]>
        </query>
    </entity>
    <entity id="IFP Upadte query">
        <query>
		<![CDATA[
   UPDATE IFP_CD
SET    ITEM_START_DATE = TEMP.START_DATE,
       ITEM_END_DATE = TEMP.END_DATE,
       IFP_CONTRACT_ATTACHED_STATUS = TEMP.ITEM_STATUS
FROM   IFP_CONTRACT IFP_C
       JOIN GCM_GLOBAL_DETAILS TEMP
         ON IFP_C.CONTRACT_MASTER_SID = TEMP.CONTRACT_MASTER_SID
       JOIN IFP_CONTRACT_DETAILS IFP_CD
         ON IFP_CD.IFP_CONTRACT_SID = IFP_C.IFP_CONTRACT_SID
            AND IFP_CD.IFP_CONTRACT_SID = TEMP. IFP_CONTRACT_SID
            AND IFP_C.CFP_CONTRACT_SID = TEMP.CFP_CONTRACT_SID
            AND IFP_CD.ITEM_MASTER_SID = TEMP.ITEM_MASTER_SID
       JOIN PS_CONTRACT PS_C
         ON PS_C.IFP_CONTRACT_SID = IFP_C.IFP_CONTRACT_SID
            AND PS_C.PS_CONTRACT_SID = TEMP.PS_CONTRACT_SID
            AND PS_C.CFP_CONTRACT_SID = IFP_C.CFP_CONTRACT_SID
       JOIN RS_CONTRACT RS_C
         ON RS_C.IFP_CONTRACT_SID = IFP_C.IFP_CONTRACT_SID
            AND RS_C.CFP_CONTRACT_SID = IFP_C.CFP_CONTRACT_SID
            AND RS_C.PS_CONTRACT_SID = PS_C.PS_CONTRACT_SID
            AND RS_C.RS_CONTRACT_SID = TEMP.RS_CONTRACT_SID
            AND Temp.session_id = '?'
            AND Temp.OPERATION = 'SUMMARY'
            AND TEMP.MODULE_NAME = 'ITEM_MANAGEMENT'


		]]>
        </query>
    </entity>
    <entity id="PS Upadte query">
        <query>
		<![CDATA[
   UPDATE PS_CD
SET    PS_CONTRACT_ATTACHED_STATUS = TEMP.ITEM_STATUS,
       contract_PRICE_START_DATE = TEMP.CONTRACT_PRICE_START_DATE,
       CONTRACT_PRICE_END_DATE = TEMP.CONTRACT_PRICE_END_DATE,
       PRICE = TEMP.PRICE,
       PRICE_PROTECTION_START_DATE = TEMP.PRICE_PROTECTION_START_DATE,
       PRICE_PROTECTION_END_DATE = TEMP.PRICE_PROTECTION_END_DATE,
       PRICE_TOLERANCE_TYPE = TEMP.PRICE_TOLERANCE_TYPE,
       PRICE_TOLERANCE = TEMP.PRICE_TOLERANCE,
       PRICE_TOLERANCE_FREQUENCY = TEMP.PRICE_TOLERANCE_FREQUENCY,
       PRICE_TOLERANCE_INTERVAL = TEMP.PRICE_TOLERANCE_INTERVAL,
       BASE_PRICE = TEMP.BASE_PRICE
FROM   PS_CONTRACT PS_C
       JOIN GCM_GLOBAL_DETAILS TEMP
         ON PS_C.CONTRACT_MASTER_SID = TEMP.CONTRACT_MASTER_SID
       JOIN PS_CONTRACT_DETAILS PS_CD
         ON PS_CD.PS_CONTRACT_SID = PS_C.PS_CONTRACT_SID
            AND PS_C.PS_CONTRACT_SID = TEMP.PS_CONTRACT_SID
            AND PS_C.IFP_CONTRACT_SID = TEMP. IFP_CONTRACT_SID
            AND PS_C.CFP_CONTRACT_SID = TEMP.CFP_CONTRACT_SID
            AND PS_CD.ITEM_MASTER_SID = TEMP.ITEM_MASTER_SID
       JOIN RS_CONTRACT RS_C
         ON RS_C.IFP_CONTRACT_SID = PS_C.IFP_CONTRACT_SID
            AND RS_C.CFP_CONTRACT_SID = PS_C.CFP_CONTRACT_SID
            AND RS_C.PS_CONTRACT_SID = PS_C.PS_CONTRACT_SID
            AND RS_C.RS_CONTRACT_SID = TEMP.RS_CONTRACT_SID
            AND Temp.session_id = '?'
            AND Temp.OPERATION = 'SUMMARY'
            AND TEMP.MODULE_NAME = 'ITEM_MANAGEMENT' 

 


		]]>
        </query>
    </entity>
    
    <entity id="RS Upadte query">
        <query>
		<![CDATA[
   UPDATE RS_CD
SET    RS_CONTRACT_ATTACHED_STATUS = TEMP.ITEM_STATUS,
       ITEM_REBATE_START_DATE = TEMP.ITEM_REBATE_START_DATE,
       ITEM_REBATE_END_DATE = TEMP.ITEM_REBATE_END_DATE,
       FORMULA_ID = TEMP.FORMULA_ID,
       FORMULA_METHOD_ID = TEMP.FORMULA_METHOD_ID,
       REBATE_AMOUNT = TEMP.REBATE_AMOUNT
FROM   RS_CONTRACT RS_C
       JOIN GCM_GLOBAL_DETAILS TEMP
         ON RS_C.CONTRACT_MASTER_SID = TEMP.CONTRACT_MASTER_SID
       JOIN RS_CONTRACT_DETAILS RS_CD
         ON RS_CD.RS_CONTRACT_SID = RS_C.RS_CONTRACT_SID
            AND RS_C.RS_CONTRACT_SID = TEMP.RS_CONTRACT_SID
            AND RS_C.PS_CONTRACT_SID = TEMP.PS_CONTRACT_SID
            AND RS_C.IFP_CONTRACT_SID = TEMP. IFP_CONTRACT_SID
            AND RS_C.CFP_CONTRACT_SID = TEMP.CFP_CONTRACT_SID
            AND RS_CD.ITEM_MASTER_SID = TEMP.ITEM_MASTER_SID
            AND Temp.session_id = '?'
            AND Temp.OPERATION = 'SUMMARY'
            AND TEMP.MODULE_NAME = 'ITEM_MANAGEMENT' 



		]]>
        </query>
    </entity>
     
    <entity id="Item Remove1">
        <query>
		<![CDATA[
  DECLARE @SESSION_ID VARCHAR(100)='?'


UPDATE PS_CD
SET    CONTRACT_PRICE_END_DATE = Getdate()
FROM   PS_CONTRACT PS_C
       JOIN GCM_GLOBAL_DETAILS TEMP
         ON PS_C.CONTRACT_MASTER_SID = TEMP.CONTRACT_MASTER_SID
       JOIN PS_CONTRACT_DETAILS PS_CD
         ON PS_CD.PS_CONTRACT_SID = PS_C.PS_CONTRACT_SID
            AND PS_C.PS_CONTRACT_SID = TEMP.PS_CONTRACT_SID
            AND PS_C.IFP_CONTRACT_SID = TEMP. IFP_CONTRACT_SID
            AND PS_C.CFP_CONTRACT_SID = TEMP.CFP_CONTRACT_SID
            AND PS_CD.ITEM_MASTER_SID = TEMP.ITEM_MASTER_SID
            AND Temp.session_id = @SESSION_ID
            AND Temp.OPERATION = 'SUMMARY'
            AND TEMP.MODULE_NAME = 'ITEM_MANAGEMENT'

UPDATE IFP_CD
SET    ITEM_END_DATE = Getdate()
FROM   IFP_CONTRACT IFP_C
       JOIN GCM_GLOBAL_DETAILS TEMP
         ON IFP_C.CONTRACT_MASTER_SID = TEMP.CONTRACT_MASTER_SID
       JOIN IFP_CONTRACT_DETAILS IFP_CD
         ON IFP_CD.IFP_CONTRACT_SID = IFP_C.IFP_CONTRACT_SID
            AND IFP_C.IFP_CONTRACT_SID = TEMP. IFP_CONTRACT_SID
            AND IFP_CD.ITEM_MASTER_SID = TEMP.ITEM_MASTER_SID
			AND IFP_C.CFP_CONTRACT_SID=TEMP.CFP_CONTRACT_SID
            AND Temp.session_id = @SESSION_ID
            AND Temp.OPERATION = 'SUMMARY'
            AND TEMP.MODULE_NAME = 'ITEM_MANAGEMENT'

UPDATE RS_CD
SET    ITEM_REBATE_END_DATE = Getdate()
FROM   RS_CONTRACT RS_C
       JOIN GCM_GLOBAL_DETAILS TEMP
         ON RS_C.CONTRACT_MASTER_SID = TEMP.CONTRACT_MASTER_SID
       JOIN RS_CONTRACT_DETAILS RS_CD
         ON RS_CD.RS_CONTRACT_SID = RS_C.RS_CONTRACT_SID
            AND RS_C.IFP_CONTRACT_SID = TEMP. IFP_CONTRACT_SID
            AND RS_CD.ITEM_MASTER_SID = TEMP.ITEM_MASTER_SID
			AND RS_C.RS_CONTRACT_SID=TEMP.RS_CONTRACT_SID
			AND RS_C.PS_CONTRACT_SID=TEMP.PS_CONTRACT_SID
			AND RS_C.CFP_CONTRACT_SID=TEMP.CFP_CONTRACT_SID
            AND Temp.session_id = @SESSION_ID
            AND Temp.OPERATION = 'SUMMARY'
            AND TEMP.MODULE_NAME = 'ITEM_MANAGEMENT' 


		]]>
        </query>
    </entity>
    
    
    <entity id="Item Remove">
        <query>
		<![CDATA[
 SELECT TOP 1 *
FROM   PROJECTION_MASTER PM
       JOIN PROJECTION_DETAILS PD
         ON PD.PROJECTION_MASTER_SID = PM.PROJECTION_MASTER_SID
            AND PM.IS_APPROVED = 'A'
       JOIN CCP_DETAILS CCPT
         ON CCPT.CCP_DETAILS_SID = PD.CCP_DETAILS_SID
       JOIN GCM_GLOBAL_DETAILS IMTD
         ON IMTD.CONTRACT_MASTER_SID = CCPT.CONTRACT_MASTER_SID
            AND IMTD.SESSION_ID = '?'
            AND IMTD.MODULE_NAME = 'ITEM_MANAGEMENT'
            AND IMTD."OPERATION" = '?'
ORDER  BY PM.MODIFIED_DATE DESC 



		]]>
        </query>
    </entity>
    
    
    <entity id="Projection Query-Add">
        <query>
		<![CDATA[
 SELECT
 TOP 1 *
FROM PROJECTION_MASTER PM
JOIN PROJECTION_DETAILS PD ON PD.PROJECTION_MASTER_SID = PM.PROJECTION_MASTER_SID
AND PM.IS_APPROVED = 'A'
JOIN CCP_DETAILS CCPT ON CCPT.CCP_DETAILS_SID = PD.CCP_DETAILS_SID
JOIN GCM_GLOBAL_DETAILS IMTD ON IMTD.CONTRACT_MASTER_SID = CCPT.CONTRACT_MASTER_SID
AND IMTD.SESSION_ID = '?'
AND IMTD.MODULE_NAME = 'ITEM_MANAGEMENT'
AND IMTD.CHECK_RECORD = 1
AND IMTD."OPERATION" = '?'
AND IMTD.ITEM_MASTER_SID IN ( ? )
ORDER BY PM.MODIFIED_DATE DESC 



		]]>
        </query>
    </entity>
    <entity id="Projection Query">
        <query>
		<![CDATA[
SELECT
 TOP 1 *
FROM PROJECTION_MASTER PM
JOIN PROJECTION_DETAILS PD ON PD.PROJECTION_MASTER_SID = PM.PROJECTION_MASTER_SID
AND PM.IS_APPROVED = 'A'
JOIN CCP_DETAILS CCPT ON CCPT.CCP_DETAILS_SID = PD.CCP_DETAILS_SID
JOIN GCM_GLOBAL_DETAILS IMTD ON IMTD.CONTRACT_MASTER_SID = CCPT.CONTRACT_MASTER_SID
AND IMTD.SESSION_ID = '?'
AND IMTD.MODULE_NAME = 'ITEM_MANAGEMENT'
AND IMTD.CHECK_RECORD = 1
AND IMTD."OPERATION" = '?'
and ccpt.ITEM_MASTER_SID IN ( ? )
ORDER BY PM.MODIFIED_DATE DESC
		]]>
        </query>
    </entity>
    <entity id="getBuilderType">
        <query>
		<![CDATA[
SELECT
    RB.BUILD_TYPE,*
FROM
    dbo.PROJECTION_MASTER PM JOIN dbo.RELATIONSHIP_BUILDER RB
        ON RB.RELATIONSHIP_BUILDER_SID = PM.PROD_RELATIONSHIP_BUILDER_SID
    AND PM.PROJECTION_MASTER_SID = ?
		]]>
        </query>
    </entity>
    <entity id="resetContractDetails">
        <query>
		<![CDATA[
UPDATE
    GCM_GLOBAL_DETAILS
SET
    ITEM_STATUS = NULL,
    START_DATE = NULL,
    END_DATE = NULL,
    CONTRACT_PRICE_START_DATE = NULL,
    CONTRACT_PRICE_END_DATE = NULL,
    CONTRACT_PRICE = NULL,
    PRICE = NULL,
    PRICE_PROTECTION_START_DATE = NULL,
    PRICE_PROTECTION_END_DATE = NULL,
    PRICE_TOLERANCE_TYPE = NULL,
    PRICE_TOLERANCE_FREQUENCY = NULL,
    PRICE_TOLERANCE_INTERVAL = NULL,
    BASE_PRICE = NULL,
    ITEM_REBATE_START_DATE = NULL,
    ITEM_REBATE_END_DATE = NULL,
    FORMULA_ID = NULL,
    REBATE_PLAN_NAME = NULL,
    FORMULA_METHOD_ID = NULL,
    REBATE_AMOUNT = NULL
WHERE
    SESSION_ID = '?'
    AND(
        OPERATION = '?'
    )
		]]>
        </query>
    </entity>
    
</sql>