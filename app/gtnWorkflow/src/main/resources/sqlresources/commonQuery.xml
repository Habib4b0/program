<?xml version="1.0" encoding="UTF-8"?>

<sql>
    <entity id="getCompanyQuery">
        <query> 
            <![CDATA[
                SELECT DISTINCT COMPANY_MASTER_SID,COMPANY_ID,COMPANY_NAME FROM COMPANY_MASTER 
                JOIN HELPER_TABLE ON COMPANY_TYPE = HELPER_TABLE_SID
                WHERE LIST_NAME = 'COMPANY_TYPE' AND DESCRIPTION = 'GLCOMP'
            ]]>
        </query>
    </entity>
    
    <entity id="getBusinessQuery">
        <query> 
            <![CDATA[
                SELECT DISTINCT COMPANY_MASTER_SID,COMPANY_ID,COMPANY_NAME FROM COMPANY_MASTER 
                JOIN HELPER_TABLE ON COMPANY_TYPE = HELPER_TABLE_SID
                WHERE LIST_NAME = 'COMPANY_TYPE' AND DESCRIPTION = 'BUSINESS UNIT'
            ]]>
        </query>
    </entity>
    
    <entity id="getDeductionAvailableLevels">
        <query> 
            <![CDATA[
                    SELECT DISTINCT 
                        $$$
                    FROM   RS_CONTRACT A
                     JOIN   HELPER_TABLE H1 ON H1.HELPER_TABLE_SID = A.RS_CATEGORY
                     JOIN   HELPER_TABLE H2 ON H2.HELPER_TABLE_SID = A.RS_TYPE
                     JOIN   HELPER_TABLE H3 ON H3.HELPER_TABLE_SID = A.REBATE_PROGRAM_TYPE
                     JOIN   UDCS U ON U.MASTER_SID=A.RS_CONTRACT_SID AND U.MASTER_TYPE='RS_CONTRACT'
                     JOIN   HELPER_TABLE H5 ON H5.HELPER_TABLE_SID = U.UDC2
                     JOIN   HELPER_TABLE H6 ON H6.HELPER_TABLE_SID = U.UDC3
                     JOIN   HELPER_TABLE H7 ON H7.HELPER_TABLE_SID = U.UDC4
                     JOIN   HELPER_TABLE H8 ON H8.HELPER_TABLE_SID = U.UDC5
                     JOIN   HELPER_TABLE H9 ON H9.HELPER_TABLE_SID = U.UDC6
                     WHERE  H1.DESCRIPTION NOT IN ( '-Select One-' )
                        AND H2.DESCRIPTION NOT IN ( '-Select One-' )
                        AND H3.DESCRIPTION NOT IN ( '-Select One-' )
                        AND H5.DESCRIPTION NOT IN ( '-Select One-' )
                        AND H6.DESCRIPTION NOT IN ( '-Select One-' )
                        AND H7.DESCRIPTION NOT IN ( '-Select One-' )
                        AND H8.DESCRIPTION NOT IN ( '-Select One-' )
                        AND H9.DESCRIPTION NOT IN ( '-Select One-' )
                    ORDER BY 
            ]]>    
        </query>
    </entity>
    
    <entity id="wi.insertViewArm">
        <query> 
           <![CDATA[
            INSERT INTO WORKFLOW_INBOX(
            VIEW_NAME,
            VIEW_TYPE,
            BUSINESS_PROCESS,
            WORKFLOW_ID,
            WORKFLOW_NAME,
            WORKFLOW_DESCRIPTION,
            CREATION_FROM_DATE,
            CREATION_TO_DATE,
            APPROVED_DATE_FROM,
            APPROVED_DATE_TO,
            WF_CREATED_BY,
            APPROVED_BY,
            CONTRACT_ID,
            CONTRACT_NO,
            CONTRACT_NAME,
            CONTRACT_TYPE,
            COMPANY_ID,
            COMPANY_NO,
            COMPANY_NAME,
            ITEM_ID,
            ITEM_NO,
            ITEM_NAME,
            DEDUCTION_LEVEL,
            DEDUCTION_VALUE,
            GL_COMPANY_MASTER_SID,
            BUSINESS_UNIT,
            WORKFLOW_STATUS,
            BRAND_ID,
            BRAND_NAME,
            GL_DATE,
            DEDUCTION_NO,
            DEDUCTION_NAME,
            ADJUSTMENT_TYPE,
            CREATED_BY, 
            CREATED_DATE 
        )
    VALUES('?','?','?','?','?','?',
            ?,?,?,?,
            '?','?','?','?','?','?','?','?','?','?','?','?','?','?',?,'?','?','?','?',?,'?','?','?','?', getDate());
        ]]>
        </query>
    </entity>
    
    <entity id="wi.updateViewArm">
        <query> 
            <![CDATA[
        UPDATE WORKFLOW_INBOX 
        SET VIEW_NAME = '?',
            VIEW_TYPE = '?',
            BUSINESS_PROCESS = '?',
            WORKFLOW_ID = '?',
            WORKFLOW_NAME = '?',
            WORKFLOW_DESCRIPTION = '?',
            CREATION_FROM_DATE = ?,
            CREATION_TO_DATE = ?,
            APPROVED_DATE_FROM = ?,
            APPROVED_DATE_TO = ?,
            WF_CREATED_BY = '?',
            APPROVED_BY = '?',
            CONTRACT_ID = '?',
            CONTRACT_NO = '?',
            CONTRACT_NAME = '?',
            CONTRACT_TYPE = '?',
            COMPANY_ID = '?',
            COMPANY_NO = '?',
            COMPANY_NAME = '?',
            ITEM_ID = '?',
            ITEM_NO = '?',
            ITEM_NAME = '?',
            DEDUCTION_LEVEL = '?',
            DEDUCTION_VALUE = '?',
            GL_COMPANY_MASTER_SID = ?,
            BUSINESS_UNIT = '?',
            WORKFLOW_STATUS = '?',
            BRAND_ID = '?',
            BRAND_NAME = '?',
            GL_DATE = ?,
            DEDUCTION_NO = '?',
            DEDUCTION_NAME = '?',
            ADJUSTMENT_TYPE = '?',
            MODIFIED_DATE = getDate(),
            MODIFIED_BY = '?'
            
        WHERE
            WORKFLOW_INBOX_SID = '?';
        ]]>  
        </query>
    </entity>
    
    <entity id="wi.insertView">
        <query> 
            <![CDATA[
            INSERT INTO WORKFLOW_INBOX(
            VIEW_NAME,
            VIEW_TYPE,
            BUSINESS_PROCESS,
            WORKFLOW_ID,
            WORKFLOW_NAME,
            WORKFLOW_DESCRIPTION,
            CREATION_FROM_DATE,
            CREATION_TO_DATE,
            APPROVED_DATE_FROM,
            APPROVED_DATE_TO,
            WF_CREATED_BY,
            APPROVED_BY,
            CONTRACT_ID,
            CONTRACT_NO,
            CONTRACT_NAME,
            CONTRACT_TYPE,
            COMPANY_ID,
            COMPANY_NO,
            COMPANY_NAME,
            ITEM_ID,
            ITEM_NO,
            ITEM_NAME,
            DEDUCTION_LEVEL,
            DEDUCTION_VALUE,
            BUSINESSUNITID,
            BUSINESSUNITNO,
            BUSINESSUNITNAME,
            CREATED_BY, 
            CREATED_DATE
        )
    VALUES('?','?','?','?','?','?',
            ?,?,?,?,
            '?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?','?', getDate());
        ]]>
        </query>
    </entity>
    
    <entity id="wi.updateView">
        <query> 
            <![CDATA[
        UPDATE WORKFLOW_INBOX 
        SET VIEW_NAME = '?',
            VIEW_TYPE = '?',
            BUSINESS_PROCESS = '?',
            WORKFLOW_ID = '?',
            WORKFLOW_NAME = '?',
            WORKFLOW_DESCRIPTION = '?',
            CREATION_FROM_DATE = ?,
            CREATION_TO_DATE = ?,
            APPROVED_DATE_FROM = ?,
            APPROVED_DATE_TO = ?,
            WF_CREATED_BY = '?',
            APPROVED_BY = '?',
            CONTRACT_ID = '?',
            CONTRACT_NO = '?',
            CONTRACT_NAME = '?',
            CONTRACT_TYPE = '?',
            COMPANY_ID = '?',
            COMPANY_NO = '?',
            COMPANY_NAME = '?',
            ITEM_ID = '?',
            ITEM_NO = '?',
            ITEM_NAME = '?',
            DEDUCTION_LEVEL = '?',
            DEDUCTION_VALUE = '?',
            BUSINESSUNITID = '?',
            BUSINESSUNITNO = '?',
            BUSINESSUNITNAME= '?'
        WHERE
            WORKFLOW_INBOX_SID = '?';
        ]]>
        </query>
    </entity>
    
    <entity id="wi.viewSearch">
        <query> 
            <![CDATA[
        SELECT
            VIEW_NAME,
            VIEW_TYPE,
            BUSINESS_PROCESS,
            WORKFLOW_ID,
            WORKFLOW_NAME,
            WORKFLOW_DESCRIPTION,
            CREATION_FROM_DATE,
            CREATION_TO_DATE,
            APPROVED_DATE_FROM,
            APPROVED_DATE_TO,
            WF_CREATED_BY,
            APPROVED_BY,
            CONTRACT_ID,
            CONTRACT_NO,
            CONTRACT_NAME,
            CONTRACT_TYPE,
            COMPANY_ID,
            COMPANY_NO,
            COMPANY_NAME,
            ITEM_ID,
            ITEM_NO,
            ITEM_NAME,
            DEDUCTION_LEVEL,
            DEDUCTION_VALUE,
            WORKFLOW_INBOX_SID,
            GL_COMPANY_MASTER_SID,
            BUSINESS_UNIT,
            WORKFLOW_STATUS,
            BRAND_ID,
            BRAND_NAME,
            GL_DATE,
            DEDUCTION_NO,
            DEDUCTION_NAME,
            ADJUSTMENT_TYPE,
            CREATED_DATE,
            CREATED_BY,
            MODIFIED_DATE,
            MODIFIED_BY,
            BUSINESSUNITID,
            BUSINESSUNITNO,
            BUSINESSUNITNAME
            
        FROM
            WORKFLOW_INBOX 
        WHERE VIEW_TYPE = '?' and VIEW_NAME LIKE '?' 
        ? ? OFFSET ? ROWS FETCH NEXT ? ROWS ONLY ;
        ]]>
        </query>
    </entity>
    
    <entity id="wi.viewCount">
        <query> 
            <![CDATA[
            SELECT COUNT(WORKFLOW_ID) FROM WORKFLOW_INBOX WHERE VIEW_TYPE like '?' and VIEW_NAME LIKE '?'
            ?
            
        ]]>
        </query>
    </entity>
    
    <entity id="wi.historyPopup">
        <query> 
            <![CDATA[
            select glComp.COMPANY_NO as glCompNo, glComp.COMPANY_NAME as glCompName, bu.COMPANY_NO as buNo, bu.COMPANY_NAME asbuName from WORKFLOW_MASTER wm
                    join PROJECTION_MASTER pm on wm.PROJECTION_MASTER_SID =  pm.PROJECTION_MASTER_SID
                    join COMPANY_MASTER glComp on glComp.COMPANY_MASTER_SID = pm.COMPANY_MASTER_SID
                    join ARM_ADJUSTMENT_MASTER arm on arm.PROJECTION_MASTER_SID = wm.PROJECTION_MASTER_SID
                    join COMPANY_MASTER bu on bu.COMPANY_MASTER_SID = arm.BU_COMPANY_MASTER_SID
            
        ]]>
        </query>
    </entity>
     
    <entity id="history-popup-others">
        <query> 
            <![CDATA[
                SELECT
                    GLCOMP.COMPANY_ID,
                    GLCOMP.COMPANY_NAME,
                    BU.COMPANY_ID,
                    BU.COMPANY_NAME
                FROM
                    WORKFLOW_MASTER WM
                JOIN PROJECTION_MASTER PM ON
                    WM.PROJECTION_MASTER_SID = PM.PROJECTION_MASTER_SID
                JOIN COMPANY_MASTER GLCOMP ON
                    GLCOMP.COMPANY_MASTER_SID = PM.COMPANY_MASTER_SID
                JOIN COMPANY_MASTER BU ON
                    BU.COMPANY_MASTER_SID = PM.BUSINESS_UNIT
                WHERE
                    WORKFLOW_MASTER_SID = [?WORKFLOW_MASTER_SID];            
        ]]>
        </query>
    </entity>
    
     
    <entity id="duplicateViewCheck">
        <query> 
            <![CDATA[
                 IF EXISTS(
    SELECT
        *
    FROM
        dbo.WORKFLOW_INBOX
    WHERE
        VIEW_NAME = '?'
) SELECT
    1
    ELSE SELECT
        0
            ]]>    
        </query> 
        </entity>
          <entity id="LoadAdjustmentType">
        <query> 
     <![CDATA[
     SELECT ADJ.ARM_ADJUSTMENT_CONFIG_SID,HT.DESCRIPTION,ADJ.TRANSACTION_NAME FROM ARM_ADJUSTMENT_CONFIG ADJ
     JOIN HELPER_TABLE HT ON HT.HELPER_TABLE_SID = ADJ.METHODOLGY
     ]]>    
        </query>
    </entity>
    <entity id="wi.deleteView">
        <query>
	<![CDATA[
          DELETE from WORKFLOW_INBOX where WORKFLOW_INBOX_SID = ?
        ]]>
        </query>
    </entity>
    <entity id="tabPermission">
        <query>
            <![CDATA[				
                select distinct spm.PROPERTY_NAME,bmm.ACCESS_MODULE from USERGROUP_BUSINESSROLE as ubm,BUSINESSROLE_MODULE as bmm, 
                MODULE_PROPERTIES as spm where 
                ubm.BUSINESSROLE_MASTER_SID=bmm.BUSINESSROLE_MASTER_SID and bmm.SUBMODULE_PROPERTY_ID=spm.MODULE_PROPERTY_SID and 
                (spm.PROPERTY_NAME is not null or spm.PROPERTY_NAME != '') 
                and spm.CATEGORY_NAME='Tab'
            ]]>
        </query>
    </entity>
    <entity id="fieldPermissionForTransaction">
        <query>
	    <![CDATA[				
                select distinct spm.PROPERTY_NAME,bmm.ADD_FLAG,bmm.EDIT_FLAG,bmm.VIEW_FLAG,spm.TAB_NAME from USERGROUP_BUSINESSROLE as ubm, 
		BUSINESSROLE_MODULE as bmm, 
                MODULE_PROPERTIES as spm where 
                ubm.BUSINESSROLE_MASTER_SID=bmm.BUSINESSROLE_MASTER_SID and bmm.SUBMODULE_PROPERTY_ID=spm.MODULE_PROPERTY_SID and 
                (spm.PROPERTY_NAME is not null or spm.PROPERTY_NAME != '') 
                and spm.CATEGORY_NAME NOT IN ('Button','Tab')
            ]]>
        </query>
    </entity>
    <entity id="fieldPermission">
        <query>
            <![CDATA[				
                select distinct spm.PROPERTY_NAME,bmm.ADD_FLAG,bmm.EDIT_FLAG,bmm.VIEW_FLAG from USERGROUP_BUSINESSROLE as ubm, 
                BUSINESSROLE_MODULE as bmm, 
                MODULE_PROPERTIES as spm where 
                ubm.BUSINESSROLE_MASTER_SID=bmm.BUSINESSROLE_MASTER_SID and bmm.SUBMODULE_PROPERTY_ID=spm.MODULE_PROPERTY_SID and 
                (spm.PROPERTY_NAME is not null or spm.PROPERTY_NAME != '') 
                and spm.CATEGORY_NAME NOT IN ('Button','Tab')
            ]]>
        </query>
    </entity>
    <entity id="functionPermission">
        <query>
            <![CDATA[		
		select distinct spm.PROPERTY_NAME,bmm.ACCESS_MODULE from USERGROUP_BUSINESSROLE as ubm, 
		BUSINESSROLE_MODULE as bmm, 
                MODULE_PROPERTIES as spm where 
                ubm.BUSINESSROLE_MASTER_SID=bmm.BUSINESSROLE_MASTER_SID and bmm.SUBMODULE_PROPERTY_ID=spm.MODULE_PROPERTY_SID and 
                (spm.PROPERTY_NAME is not null or spm.PROPERTY_NAME != '') 
                and spm.CATEGORY_NAME='Button'
            ]]>
        </query>
    </entity>
    <entity id="findModuleAccessDetails">
        <query>
		<![CDATA[	 
	            SELECT BMM.BUSINESSROLE_MODULE_SID,MSM.MODULE_NAME,MSM.SUBMODULE_NAME,SPM.DISPLAY_NAME,BMM.ACCESS_MODULE,SPM.MODULE_PROPERTY_SID,BM.BUSINESSROLE_MASTER_SID,SPM.CATEGORY_NAME,SPM.TAB_NAME   
                    FROM 
                    MODULE_SUBMODULE_MASTER MSM
                    ,BUSINESSROLE_MODULE BMM
                    ,MODULE_PROPERTIES SPM
                    ,BUSINESSROLE_MASTER BM
                    WHERE MSM.MODULE_SUBMODULE_SID = SPM.MODULE_SUBMODULE_SID
                    AND SPM.MODULE_PROPERTY_SID = BMM.SUBMODULE_PROPERTY_ID
                    AND BM.BUSINESSROLE_MASTER_SID=BMM.BUSINESSROLE_MASTER_SID
                    AND (SPM.CATEGORY_NAME='Tab' OR SPM.CATEGORY_NAME='Button')
		]]>
        </query>
    </entity>
    <entity id="findsubmodulePropertyDetails">
        <query>
		<![CDATA[
                    SELECT SPM.DISPLAY_NAME,SPM.MODULE_PROPERTY_SID,SPM.MODULE_NAME,SPM.CATEGORY_NAME,SPM.TAB_NAME
                    FROM 
                    MODULE_SUBMODULE_MASTER MSM
                    ,MODULE_PROPERTIES SPM
                    WHERE MSM.MODULE_SUBMODULE_SID = SPM.MODULE_SUBMODULE_SID
                    AND (SPM.CATEGORY_NAME='Tab' OR SPM.CATEGORY_NAME='Button') 
		]]>
        </query>
    </entity>
    <entity id="findFieldAccessDetails">
        <query>
            <![CDATA[	
                    SELECT BMM.BUSINESSROLE_MODULE_SID,MSM.MODULE_NAME,MSM.SUBMODULE_NAME,SPM.DISPLAY_NAME,BMM.ADD_FLAG,BMM.EDIT_FLAG,BMM.VIEW_FLAG,SPM.MODULE_PROPERTY_SID,BM.BUSINESSROLE_MASTER_SID,SPM.TAB_NAME,SPM.CATEGORY_NAME 
                    FROM 
                    MODULE_SUBMODULE_MASTER MSM
                    ,BUSINESSROLE_MODULE BMM
                    ,MODULE_PROPERTIES SPM
                    ,BUSINESSROLE_MASTER BM
                    WHERE MSM.MODULE_SUBMODULE_SID = SPM.MODULE_SUBMODULE_SID
                    AND SPM.MODULE_PROPERTY_SID = BMM.SUBMODULE_PROPERTY_ID
                    AND BM.BUSINESSROLE_MASTER_SID=BMM.BUSINESSROLE_MASTER_SID
                    and spm.CATEGORY_NAME not in ('Button','Tab')
            ]]>
        </query>
    </entity>
    <entity id="findsubmoduleFieldDetails">
        <query>
            <![CDATA[
                    SELECT SPM.DISPLAY_NAME,SPM.MODULE_PROPERTY_SID,SPM.MODULE_NAME,SPM.NULL_FLAG,SPM.TAB_NAME,SPM.CATEGORY_NAME
                    FROM 
                    MODULE_SUBMODULE_MASTER MSM
                    ,MODULE_PROPERTIES SPM
                    WHERE MSM.MODULE_SUBMODULE_SID = SPM.MODULE_SUBMODULE_SID
                    and spm.CATEGORY_NAME not in ('Button','Tab')
            ]]>
        </query>
    </entity>
</sql>