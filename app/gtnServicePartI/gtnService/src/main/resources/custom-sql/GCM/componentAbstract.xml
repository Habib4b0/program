<?xml version="1.0"?>
<custom-sql>
    <sql id="RS count">
		<![CDATA[
          SELECT COUNT(*) FROM ( SELECT DISTINCT IM.ITEM_NO                        AS ITEM_NO,
                IM.ITEM_NAME                      AS ITEM_NAME,
                BR.BRAND_NAME                     AS BRAND,
                ST.DESCRIPTION                    AS STATUS,
                RS_DETAILS.iteM_REBATE_START_DATE AS ITEMSTART,
                RS_DETAILS.ITEM_REBATE_END_DATE   AS ITEM_END,
                ''                                AS FORMULA_TYPE,
                FORMULA.FORMULA_NO                AS FORMULA_ID,
                FORMULA.FORMULA_DESC              AS FORMULA_NAME,
                RL.REBATE_PLAN_ID                 AS REBATE_PID,
                RL.REBATE_PLAN_NAME               AS REBATE_PNAME,
                RS_DETAILS.REBATE_AMOUNT          AS RE_AMNT,
                RS_DETAILS.BUNDLE_NO              BUNDLE_NO,
                RS_DETAILS.RS_CONTRACT_ATTACHED_DATE AS ATT_DATE,
                IM.ITEM_MASTER_SID,
                RS_CONT.RS_CONTRACT_SID
FROM   RS_CONTRACT RS_CONT
       JOIN RS_CONTRACT_DETAILS RS_DETAILS
         ON RS_CONT.RS_CONTRACT_SID = RS_DETAILS.RS_CONTRACT_SID
            AND RS_DETAILS.RS_CONTRACT_SID LIKE '?'
            AND ( RS_CONT.RS_TYPE LIKE '?'
                   OR RS_CONT.RS_TYPE IS NULL )
            AND ( RS_CONT.REBATE_PROGRAM_TYPE LIKE '?'
                   OR RS_CONT.REBATE_PROGRAM_TYPE IS NULL )
            AND ( RS_CONT.RS_CATEGORY LIKE '?'
                   OR RS_CONT.RS_CATEGORY IS NULL )
            AND ( RS_CONT.PAYMENT_FREQUENCY LIKE '?'
                   OR RS_CONT.PAYMENT_FREQUENCY IS NULL )
            AND ( RS_CONT.REBATE_PLAN_LEVEL LIKE '?'
                   OR RS_CONT.REBATE_PLAN_LEVEL IS NULL )
      LEFT JOIN ITEM_MASTER IM
         ON IM.ITEM_MASTER_SID = RS_DETAILS.ITEM_MASTER_SID
      LEFT JOIN BRAND_MASTER BR
         ON BR.BRAND_MASTER_SID = IM.BRAND_MASTER_SID
      LEFT JOIN HELPER_TABLE ST
         ON ST.HELPER_TABLE_SID = IM.ITEM_STATUS
      LEFT JOIN FORMULA_DETAILS_MASTER FORMULA
         ON FORMULA.FORMULA_ID = RS_DETAILS.FORMULA_ID 
       LEFT JOIN REBATE_PLAN_MASTER RL
              ON RL.REBATE_PLAN_MASTER_SID = RS_DETAILS.REBATE_PLAN_MASTER_SID
              ? ) A

		]]>
    </sql>  
    <sql id="RS query">
		<![CDATA[
             SELECT DISTINCT IM.ITEM_NO                        AS ITEM_NO,
                IM.ITEM_NAME                      AS ITEM_NAME,
                BR.BRAND_NAME                     AS BRAND,
                ST.DESCRIPTION                    AS STATUS,
                RS_DETAILS.iteM_REBATE_START_DATE AS ITEMSTART,
                RS_DETAILS.ITEM_REBATE_END_DATE   AS ITEM_END,
                ''                                AS FORMULA_TYPE,
                FORMULA.FORMULA_NO                AS FORMULA_ID,
                FORMULA.FORMULA_DESC              AS FORMULA_NAME,
                RL.REBATE_PLAN_ID                 AS REBATE_PID,
                RL.REBATE_PLAN_NAME               AS REBATE_PNAME,
                RS_DETAILS.REBATE_AMOUNT          AS RE_AMNT,
                RS_DETAILS.BUNDLE_NO              BUNDLE_NO,
                RS_DETAILS.RS_CONTRACT_ATTACHED_DATE AS ATT_DATE,
                IM.ITEM_MASTER_SID,
                RS_CONT.RS_CONTRACT_SID
FROM   RS_CONTRACT RS_CONT
       JOIN RS_CONTRACT_DETAILS RS_DETAILS
         ON RS_CONT.RS_CONTRACT_SID = RS_DETAILS.RS_CONTRACT_SID
            AND RS_DETAILS.RS_CONTRACT_SID LIKE '?'
            AND ( RS_CONT.RS_TYPE LIKE '?'
                   OR RS_CONT.RS_TYPE IS NULL )
            AND ( RS_CONT.REBATE_PROGRAM_TYPE LIKE '?'
                   OR RS_CONT.REBATE_PROGRAM_TYPE IS NULL )
            AND ( RS_CONT.RS_CATEGORY LIKE '?'
                   OR RS_CONT.RS_CATEGORY IS NULL )
            AND ( RS_CONT.PAYMENT_FREQUENCY LIKE '?'
                   OR RS_CONT.PAYMENT_FREQUENCY IS NULL )
            AND ( RS_CONT.REBATE_PLAN_LEVEL LIKE '?'
                   OR RS_CONT.REBATE_PLAN_LEVEL IS NULL )
      LEFT JOIN ITEM_MASTER IM
         ON IM.ITEM_MASTER_SID = RS_DETAILS.ITEM_MASTER_SID
      LEFT JOIN BRAND_MASTER BR
         ON BR.BRAND_MASTER_SID = IM.BRAND_MASTER_SID
      LEFT JOIN HELPER_TABLE ST
         ON ST.HELPER_TABLE_SID = IM.ITEM_STATUS
      LEFT JOIN FORMULA_DETAILS_MASTER FORMULA
         ON FORMULA.FORMULA_ID = RS_DETAILS.FORMULA_ID 
       LEFT JOIN REBATE_PLAN_MASTER RL
              ON RL.REBATE_PLAN_MASTER_SID = RS_DETAILS.REBATE_PLAN_MASTER_SID
              ?
ORDER  BY IM.ITEM_MASTER_SID 
 OFFSET ? ROWS FETCH NEXT ? ROWS ONLY
		]]>
    </sql>
    <sql id="RS text">
		<![CDATA[
SELECT DISTINCT RS_CONT.RS_ID,
                RS_CONT.RS_NO,
                RS_CONT.RS_NAME,
                ST.DESCRIPTION,
                TYPE.DESCRIPTION as RS_TYPE,
                RS_START_DATE,
                RS_END_DATE,
                REBATE_FRE.DESCRIPTION AS REBATE_FRE,
                REBATE_PT.DESCRIPTION  AS PROGR_TYPE,
                REBATE_ca.DESCRIPTION  AS RS_CAT,
                REBATE_fr.DESCRIPTION  AS PAY_FRE,
                REBATE_PL.DESCRIPTION  AS REBATE_PLEVEL
FROM   RS_CONTRACT RS_CONT
       JOIN HELPER_TABLE TYPE
         ON TYPE.HELPER_TABLE_SID = RS_CONT.RS_TYPE
       
        JOIN HELPER_TABLE REBATE_FRE
              ON REBATE_FRE.HELPER_TABLE_SID = RS_CONT.REBATE_FREQUENCY
        JOIN HELPER_TABLE REBATE_PT
              ON REBATE_PT.HELPER_TABLE_SID = RS_CONT.REBATE_PROGRAM_TYPE
      LEFT JOIN HELPER_TABLE ST
              ON ST.HELPER_TABLE_SID = RS_CONT.RS_STATUS
       LEFT JOIN HELPER_TABLE REBATE_ca
              ON REBATE_ca.HELPER_TABLE_SID = RS_CONT.RS_CATEGORY
       LEFT JOIN HELPER_TABLE REBATE_fr
              ON REBATE_fr.HELPER_TABLE_SID = RS_CONT.PAYMENT_FREQUENCY
       LEFT JOIN HELPER_TABLE REBATE_PL
              ON REBATE_PL.HELPER_TABLE_SID = RS_CONT.REBATE_PLAN_LEVEL
WHERE  RS_CONT.RS_CONTRACT_SID LIKE '?' 
 
		]]>
    </sql>  
    <sql id="PS count">
		<![CDATA[
            SELECT COUNT( DISTINCT IM.ITEM_MASTER_SID)
FROM   PS_CONTRACT PS_C
       JOIN PS_CONTRACT_DETAILS PS_D
         ON PS_D.PS_CONTRACT_SID = PS_C.PS_CONTRACT_SID
            AND PS_C.PS_CONTRACT_SID LIKE '?'
       JOIN IFP_CONTRACT IFP
         ON IFP.IFP_CONTRACT_SID = PS_C.IFP_CONTRACT_SID
       JOIN ITEM_MASTER IM
         ON IM.ITEM_MASTER_SID = PS_D.ITEM_MASTER_SID
       LEFT JOIN BRAND_MASTER BM
              ON BM.BRAND_MASTER_SID = IM.BRAND_MASTER_SID
       LEFT JOIN HELPER_TABLE ST
              ON ST.HELPER_TABLE_SID = IM.ITEM_STATUS
       JOIN ITEM_PRICING_QUALIFIER IPQ
         ON IPQ.ITEM_PRICING_QUALIFIER_SID = PS_D.ITEM_PRICING_QUALIFIER_SID ?




		]]>
    </sql>  
    <sql id="PS query">
		<![CDATA[
               SELECT DISTINCT IM.ITEM_NO                       AS ITEM_NO,
                IM.ITEM_NAME                     AS ITEM_NAME,
                BM.BRAND_NAME                    AS BRAND,
                ST.DESCRIPTION                   AS STATUS,
                PS_D.CONTRACT_PRICE_START_DATE               AS START_DAT,
                PS_D.CONTRACT_PRICE_END_DATE                 AS ITEM_END,
                IPQ.PRICING_QUALIFIER            AS PRICE_TYPE,
                ''                               AS PRICE_PLAN_NO,
                ''                               AS PRICE_PLAN_NAME,
                ST.DESCRIPTION                   AS PRICE_PROTECTION_STATUS,
                PS_D.PRICE_PROTECTION_START_DATE AS PR_ST_DT,
                PS_D.PRICE_PROTECTION_END_DATE   AS PR_EN_DT,
                ''                               AS PR_PR_TYPE,
                PTI.DESCRIPTION                  AS INTERVAL,
                PTF.DESCRIPTION                  AS FRE,
                PTT.DESCRIPTION                  AS PRICE_TO_TYPE,
                ''                               AS MAXINC,
                PS_D.PRICE_TOLERANCE             AS PRC_TOL,
                ''                               AS RESET_ELIG,
                ''                               AS RESET_TYPE,
                Getdate()                        AS RESET_DATE,
                ''                               AS RESET_INTER,
                ''                               AS RESET_FR,
                  PS_C.PS_CONTRACT_ATTACHED_DATE AS AT_DATE,
                IM.ITEM_MASTER_SID
FROM   PS_CONTRACT PS_C
       JOIN PS_CONTRACT_DETAILS PS_D
         ON PS_D.PS_CONTRACT_SID = PS_C.PS_CONTRACT_SID
            AND PS_C.PS_CONTRACT_SID LIKE '?'
       JOIN IFP_CONTRACT IFP
         ON IFP.IFP_CONTRACT_SID = PS_C.IFP_CONTRACT_SID
           JOIN ITEM_MASTER IM
         ON IM.ITEM_MASTER_SID = PS_D.ITEM_MASTER_SID
      left  JOIN BRAND_MASTER BM
         ON BM.BRAND_MASTER_SID = IM.BRAND_MASTER_SID
       left JOIN HELPER_TABLE ST
         ON ST.HELPER_TABLE_SID = IM.ITEM_STATUS
      LEFT JOIN ITEM_PRICING_QUALIFIER IPQ
         ON IPQ.ITEM_PRICING_QUALIFIER_SID = PS_D.ITEM_PRICING_QUALIFIER_SID
         LEFT JOIN HELPER_TABLE PTI
              ON PTI.HELPER_TABLE_SID = PS_D.PRICE_TOLERANCE_INTERVAL
       LEFT JOIN HELPER_TABLE PTF
              ON PTF.HELPER_TABLE_SID = PS_D.PRICE_TOLERANCE_FREQUENCY
       LEFT JOIN HELPER_TABLE PTT
              ON PTT.HELPER_TABLE_SID = PS_D.PRICE_TOLERANCE_TYPE  ? 
ORDER BY IM.ITEM_MASTER_SID OFFSET ? ROWS FETCH NEXT ? ROWS ONLY
		]]>
    </sql>
    <sql id="PS text">
		<![CDATA[
              SELECT PS.PS_ID,PS.PS_NO,
       PS_C.PS_NAME,
       ST.DESCRIPTION,
       PS_C.PS_TYPE,
       PS_C.PS_START_DATE,
       PS_C.PS_END_DATE
FROM   PS_CONTRACT PS_C
       JOIN PS_MODEL PS
         ON PS.PS_MODEL_SID = PS_C.PS_MODEL_SID
       JOIN HELPER_TABLE ST
         ON ST.HELPER_TABLE_SID = PS_C.PS_STATUS
WHERE  PS_C.PS_CONTRACT_SID LIKE '?'

		]]>
    </sql>
    <sql id="IFP count">
		<![CDATA[
             SELECT Count(*)
FROM   (SELECT DISTINCT IM.ITEM_NO       AS NO,
               IM.ITEM_NAME         AS NAME,
               BR.BRAND_NAME      AS BRAND,
               ST.DESCRIPTION     AS STAT,
               IM.ITEM_START_DATE AS STARDATE,
               IM.ITEM_END_DATE   AS ENDDATE,
               IFP_D.IFP_CONTRACT_ATTACHED_DATE  AS ATTACHED
        FROM   IFP_CONTRACT IFP_C
               JOIN IFP_CONTRACT_DETAILS IFP_D
                 ON IFP_D.IFP_CONTRACT_SID = IFP_C.IFP_CONTRACT_SID
                    AND IFP_C.IFP_CONTRACT_SID LIKE '?'
                    JOIN CFP_CONTRACT CFP
         ON CFP.CFP_CONTRACT_SID = IFP_C.CFP_CONTRACT_SID
               JOIN ITEM_MASTER IM
                 ON IM.ITEM_MASTER_SID = IFP_D.ITEM_MASTER_SID
               JOIN BRAND_MASTER BR
                 ON BR.BRAND_MASTER_SID = IM.BRAND_MASTER_SID
               JOIN HELPER_TABLE ST
                 ON ST.HELPER_TABLE_SID = IM.ITEM_STATUS
                 ?
        ) IFP 


		]]>
    </sql>  
    <sql id="IFP query">
		<![CDATA[
                SELECT DISTINCT IM.ITEM_NO       AS NO,
       IM.ITEM_NAME        AS NAME,
       BR.BRAND_NAME      AS BRAND,
       ST.DESCRIPTION     AS STAT,
       IM.ITEM_START_DATE AS STARDATE,
       IM.ITEM_END_DATE   AS ENDDATE,
        IFP_D.IFP_CONTRACT_ATTACHED_DATE  AS ATTACHED,
       IM.ITEM_MASTER_SID
FROM   IFP_CONTRACT IFP_C
       JOIN IFP_CONTRACT_DETAILS IFP_D
         ON IFP_D.IFP_CONTRACT_SID = IFP_C.IFP_CONTRACT_SID
            AND IFP_C.IFP_CONTRACT_SID LIKE '?'
            JOIN CFP_CONTRACT CFP
         ON CFP.CFP_CONTRACT_SID = IFP_C.CFP_CONTRACT_SID
       JOIN ITEM_MASTER IM
         ON IM.ITEM_MASTER_SID = IFP_D.ITEM_MASTER_SID
       JOIN BRAND_MASTER BR
         ON BR.BRAND_MASTER_SID = IM.BRAND_MASTER_SID
       JOIN HELPER_TABLE ST
         ON ST.HELPER_TABLE_SID = IM.ITEM_STATUS
          ? 

ORDER BY IM.ITEM_MASTER_SID OFFSET ? ROWS FETCH NEXT ? ROWS ONLY
		]]>
    </sql>
    <sql id="IFP text">
		<![CDATA[
              SELECT IFP.IFP_ID,IFP.IFP_NO,
       IFP.IFP_NAME,
       HT.DESCRIPTION,
       IFP_C.IFP_TYPE,
       IFP_C.IFP_START_DATE,
       IFP_C.IFP_END_DATE
FROM   IFP_CONTRACT IFP_C
       JOIN IFP_MODEL IFP
         ON IFP.IFP_MODEL_SID = IFP_C.IFP_MODEL_SID
       JOIN HELPER_TABLE HT
         ON HT.HELPER_TABLE_SID = IFP_C.IFP_STATUS
WHERE  IFP_C.IFP_CONTRACT_SID LIKE '?' 


		]]>
    </sql>
    <sql id="CFP count">
		<![CDATA[
                 SELECT Count(*)
FROM   (

SELECT DISTINCT CM.COMPANY_NO            AS NO,
                CM.COMPANY_NAME         AS NAME,
                      CST.DESCRIPTION      AS COMPANY_STATUS,
                CFP_D.COMPANY_START_DATE,
                CFP_D.COMPANY_END_DATE,
                ST.DESCRIPTION        AS STAT,
                TRAD.DESCRIPTION     AS TRADE,
                CFP_D.CFP_CONTRACT_ATTACHED_DATE
FROM   CFP_CONTRACT CFP_C
       JOIN CFP_CONTRACT_DETAILS CFP_D
         ON CFP_C.CFP_CONTRACT_SID = CFP_C.CFP_CONTRACT_SID
            AND CFP_D.CFP_CONTRACT_SID LIKE '?'
       LEFT JOIN COMPANY_MASTER CM
         ON CM.COMPANY_MASTER_SID = CFP_D.COMPANY_MASTER_SID
      LEFT JOIN HELPER_TABLE ST
         ON ST.HELPER_TABLE_SID = CFP_D.CFP_CONTRACT_ATTACHED_STATUS
      LEFT JOIN HELPER_TABLE CST
         ON CST.HELPER_TABLE_SID = CM.COMPANY_STATUS
        LEFT JOIN HELPER_TABLE TRAD
         ON TRAD.HELPER_TABLE_SID = CFP_D.TRADE_CLASS 
    ? ) CFP 
		]]>
    </sql>  
    <sql id="CFP query">
		<![CDATA[
           SELECT DISTINCT CM.COMPANY_NO            AS NO,
                CM.COMPANY_NAME         AS NAME,
                      CST.DESCRIPTION      AS COMPANY_STATUS,
                CFP_D.COMPANY_START_DATE,
                CFP_D.COMPANY_END_DATE,
                ST.DESCRIPTION        AS STAT,
                TRAD.DESCRIPTION     AS TRADE,
                CFP_D.CFP_CONTRACT_ATTACHED_DATE
FROM   CFP_CONTRACT CFP_C
       JOIN CFP_CONTRACT_DETAILS CFP_D
         ON CFP_C.CFP_CONTRACT_SID = CFP_C.CFP_CONTRACT_SID
            AND CFP_D.CFP_CONTRACT_SID LIKE '?'
       LEFT JOIN COMPANY_MASTER CM
         ON CM.COMPANY_MASTER_SID = CFP_D.COMPANY_MASTER_SID
      LEFT JOIN HELPER_TABLE ST
         ON ST.HELPER_TABLE_SID = CFP_D.CFP_CONTRACT_ATTACHED_STATUS
      LEFT JOIN HELPER_TABLE CST
         ON CST.HELPER_TABLE_SID = CM.COMPANY_STATUS
        LEFT JOIN HELPER_TABLE TRAD
         ON TRAD.HELPER_TABLE_SID = CFP_D.TRADE_CLASS 
         ?
ORDER BY CM.COMPANY_NO OFFSET ? ROWS FETCH NEXT ? ROWS ONLY
		]]>
    </sql>
    <sql id="CFP text">
		<![CDATA[
             SELECT CFP.CFP_ID,
       CFP.CFP_NO,
       CFP.CFP_NAME,
       HT.DESCRIPTION,
       TYP.DESCRIPTION AS TY,
       CFP_C.CFP_START_DATE,
       CFP_C.CFP_END_DATE
FROM   CFP_CONTRACT CFP_C
       JOIN CFP_MODEL CFP
         ON CFP.CFP_MODEL_SID = CFP_C.CFP_MODEL_SID
      LEFT JOIN HELPER_TABLE HT
         ON HT.HELPER_TABLE_SID = CFP_C.CFP_STATUS
       LEFT JOIN HELPER_TABLE TYP
         ON TYP.HELPER_TABLE_SID = CFP_C.CFP_TYPE
WHERE  CFP_C.CFP_CONTRACT_SID LIKE '?'  


		]]>
    </sql>
</custom-sql>